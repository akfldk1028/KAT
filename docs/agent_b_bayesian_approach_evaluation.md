# Agent B ë² ì´ì¦ˆ ë°©ì•ˆ í‰ê°€ ë° êµ¬í˜„ ê°­ ë¶„ì„

## ê°œìš”

ì‚¬ìš©ì ìš”ì²­: **"ë„ˆê°€ ì´ ë°©ì•ˆì„ í‰ê°€í•˜ë©´? ì„¤ë“ë ¥ì´ ìˆë‚˜? ê¸°ì¡´ì˜ ë‚˜ì˜ ê³„íš ë° êµ¬í˜„ í˜„í™©ì—ì„œ ë” êµ¬í˜„í•´ì•¼í•˜ëŠ” ê²ƒë“¤ ìˆ˜ì •í•´ì•¼í•˜ëŠ” ê²ƒë“¤ë„ ë¹„êµ ì •ë¦¬í•´ë³¼ë˜?"**

ì´ ë¬¸ì„œëŠ” ë² ì´ì¦ˆ ê¸°ë°˜ ìœ„í—˜ë„ ê³„ì‚° ë°©ì•ˆì„ ê°ê´€ì ìœ¼ë¡œ í‰ê°€í•˜ê³ , ê¸°ì¡´ ê³„íš/êµ¬í˜„ê³¼ì˜ ê°­ì„ ë¶„ì„í•©ë‹ˆë‹¤.

---

## Part 1: ë² ì´ì¦ˆ ë°©ì•ˆ ê°ê´€ì  í‰ê°€

### 1.1. ê°•ì  (Strengths) âœ…

#### 1. í•™ìˆ ì  ì •ë‹¹ì„± (Academic Credibility)
**í‰ê°€**: â­â­â­â­â­ (5/5)

- **ê·¼ê±°**: IEEE/ICML/SIGKDD ë…¼ë¬¸ ê¸°ë°˜
- **íš¨ê³¼**: ê²½ì§„ëŒ€íšŒ ì‹¬ì‚¬ìœ„ì›ì—ê²Œ "ì´ë¡ ì  ë°°ê²½"ì´ ëª…í™•
- **ì˜ˆì‹œ**: "ë² ì´ì¦ˆ ì •ë¦¬ ê¸°ë°˜ (IEEE 2018)" vs "ìš°ë¦¬ê°€ ë§Œë“  ì ìˆ˜ ê³„ì‚°"

**ì‹¬ì‚¬ ê¸°ì¤€ ëŒ€ì‘**:
- âœ… **ê¸°ìˆ  ì„¤ê³„ (30ì )**: "êµ¬ì²´ì ì´ê³  íƒ€ë‹¹í•œ ê³„íš" â†’ í•™ìˆ  ë…¼ë¬¸ ë ˆí¼ëŸ°ìŠ¤ë¡œ íƒ€ë‹¹ì„± ì¦ëª…
- âœ… **ê²€ì¦ ê³„íš (30ì )**: "ì¸¡ì • ê°€ëŠ¥í•œ ì§€í‘œ" â†’ F2-Score, ECE ë“± êµ¬ì²´ì  ë©”íŠ¸ë¦­

#### 2. ì„¤ëª… ê°€ëŠ¥ì„± (Explainability)
**í‰ê°€**: â­â­â­â­â­ (5/5)

**ê¸°ì¡´**:
```
"ì ìˆ˜: 75ì  â†’ HIGH ìœ„í—˜"
```
- âŒ ì™œ 75ì ì¸ì§€ ë¶ˆëª…í™•
- âŒ ì‚¬ìš©ìê°€ ì´í•´í•˜ê¸° ì–´ë ¤ì›€

**ì œì•ˆ**:
```
"A-1 ê°€ì¡± ì‚¬ì¹­ íŒ¨í„´ì´ì§€ë§Œ, ë°œì‹ ìì™€ 3ë…„ ëŒ€í™” ì´ë ¥, í‰ì†Œ í†¤ê³¼ ì¼ê´€ì„± ìˆìŒ.
ë² ì´ì¦ˆ í™•ë¥ : 0.65 (65%) â†’ CRITICALì—ì„œ HIGHë¡œ ì¡°ì •.
ì—¬ì „íˆ ì£¼ì˜ í•„ìš”í•˜ë©° ì§ì ‘ í†µí™” ê¶Œì¥."
```
- âœ… íŒë‹¨ ê·¼ê±° ëª…í™•
- âœ… ì‚¬ìš©ìê°€ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì„¤ëª…
- âœ… Agentic AI "ì„¤ëª… ê°€ëŠ¥ì„±" ìš”êµ¬ ì¶©ì¡±

#### 3. ë§¥ë½ ë°˜ì˜ (Context-Awareness)
**í‰ê°€**: â­â­â­â­â­ (5/5)

**ê¸°ì¡´ ë¬¸ì œ**:
- A-1 ê°€ì¡± ì‚¬ì¹­ â†’ ë¬´ì¡°ê±´ CRITICAL
- 3ë…„ ëŒ€í™” ì´ë ¥ ë¬´ì‹œ â†’ False Positive ì¦ê°€

**ì œì•ˆ ê°œì„ **:
```python
# ë² ì´ì¦ˆ í™•ë¥  ì¡°ì •
if sender_trust > 0.8 and conversation_years > 3:
    adjusted_prob = base_prob * 0.7  # 30% ê°ì†Œ
```
- âœ… ì¥ê¸° ì‹ ë¢° ê´€ê³„ ë°˜ì˜
- âœ… False Positive ê°ì†Œ (-7%p ëª©í‘œ)
- âœ… ì‚¬ìš©ì ê²½í—˜ ê°œì„ 

#### 4. í™•ì¥ì„± (Scalability)
**í‰ê°€**: â­â­â­â­ (4/5)

**ê³„ì¸µì  ì¹´í…Œê³ ë¦¬ ì‹œìŠ¤í…œ**:
```
Level 1 (MECE): A, B, C, D, NORMAL
Level 2: A-1, A-2, ..., D-N
D-N: Unknown/ì‹ ê·œ ì‚¬ê¸° ìœ í˜•
```

**ì¥ì **:
- âœ… ì‹ ê·œ ì‚¬ê¸° ìœ í˜• ìë™ í¬ì°© (D-N)
- âœ… ì¹´í…Œê³ ë¦¬ ì¶”ê°€ ì‹œ ê¸°ì¡´ ì‹œìŠ¤í…œ ì˜í–¥ ìµœì†Œí™”
- âœ… Open-World Recognition (CVPR 2019)

**ì•½ì **:
- âš ï¸ D-N ì¹´í…Œê³ ë¦¬ê°€ ê³„ì† ì¦ê°€í•˜ë©´ ê´€ë¦¬ ë¶€ë‹´
- âš ï¸ ì£¼ê¸°ì  ì¬í•™ìŠµ í•„ìš”

---

### 1.2. ì•½ì  (Weaknesses) âš ï¸

#### 1. êµ¬í˜„ ë³µì¡ë„ ì¦ê°€
**í‰ê°€**: â­â­ (2/5)

**ì¶”ê°€ êµ¬í˜„ í•­ëª©**:
1. **Bayesian Risk Calculator** (ì‹ ê·œ ëª¨ë“ˆ)
   - ë² ì´ì¦ˆ í™•ë¥  ê³„ì‚° ì—”ì§„
   - ì‚¬ì „ í™•ë¥  ì„¤ì • (ì¹´í…Œê³ ë¦¬ë³„)
   - ìš°ë„ ê³„ì‚° ë¡œì§

2. **Temperature Scaling** (ì‹ ê·œ ì•Œê³ ë¦¬ì¦˜)
   - ì‹ ë¢°ë„ ë³´ì • ë¡œì§
   - íŒŒë¼ë¯¸í„° íŠœë‹ í•„ìš”

3. **Cost-Sensitive Thresholds** (ì‹ ê·œ ì„¤ì •)
   - FN:FP ë¹„ìœ¨ ê³„ì‚°
   - KISA í”¼í•´ì•¡ ë°ì´í„° ìˆ˜ì§‘

**ë¦¬ìŠ¤í¬**:
- âŒ ê°œë°œ ê¸°ê°„ ì¦ê°€ (+1-2ì£¼)
- âŒ ë””ë²„ê¹… ë‚œì´ë„ ìƒìŠ¹
- âŒ ê²½ì§„ëŒ€íšŒ ì¼ì • ì••ë°•

#### 2. ë°ì´í„° ì˜ì¡´ì„±
**í‰ê°€**: â­â­â­ (3/5)

**í•„ìˆ˜ ë°ì´í„°**:
- ì¹´í…Œê³ ë¦¬ë³„ ì‚¬ì „ í™•ë¥  (P(Scam | Category))
  - KISA 2024 í†µê³„ í™œìš© ê°€ëŠ¥ âœ…
- ì¦ê±°ë³„ ìš°ë„ (P(Evidence | Scam))
  - ë°ì´í„° ë¶€ì¡± ì‹œ ë„ë©”ì¸ ì „ë¬¸ê°€ ì¶”ì • í•„ìš” âš ï¸
- Temperature Scaling íŒŒë¼ë¯¸í„°
  - ê²€ì¦ ë°ì´í„°ì…‹ í•„ìš” (900ê±´ ì‚¬ê¸° + 300ê±´ ì •ìƒ) âœ…

**ë¦¬ìŠ¤í¬**:
- âš ï¸ ë°ì´í„° í’ˆì§ˆì— ì„±ëŠ¥ ì˜ì¡´
- âš ï¸ ì´ˆê¸° íŠœë‹ ì‹œê°„ ì†Œìš”

#### 3. ê¸°ì¡´ êµ¬í˜„ê³¼ì˜ í˜¸í™˜ì„±
**í‰ê°€**: â­â­â­ (3/5)

**í˜„ì¬ êµ¬í˜„**:
- `action_policy.py`: ê°€ì¤‘ í‰ê·  ê¸°ë°˜ ì ìˆ˜ ê³„ì‚°
- `score_utils.py`: ë¡œê·¸ ìŠ¤ì¼€ì¼ ì‹ ë¢°ë„ ê³„ì‚°
- 9ê°œ ì¹´í…Œê³ ë¦¬ ì´ë¯¸ ì •ì˜ë¨

**ë§ˆì´ê·¸ë ˆì´ì…˜ ë¦¬ìŠ¤í¬**:
- âš ï¸ ê¸°ì¡´ ì½”ë“œ ëŒ€ë¶€ë¶„ ì¬ì‘ì„±
- âš ï¸ í•˜ìœ„ í˜¸í™˜ì„± ì—†ìŒ
- âš ï¸ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì „ë©´ ì¬ì‘ì„±

---

### 1.3. ê²½ì§„ëŒ€íšŒ ì‹¬ì‚¬ ê¸°ì¤€ ëŒ€ì‘

#### ì‹¬ì‚¬ í•­ëª© 1: ë¬¸ì œ ì •ì˜ (20ì )

| í‰ê°€ í•­ëª© | ê¸°ì¡´ | ì œì•ˆ | ì ìˆ˜ ì˜ˆìƒ |
|----------|------|------|-----------|
| Agentic AI ì í•©ì„± | "ì‚¬ê¸° íƒì§€ í›„ ê²½ê³ " | "ë§¥ë½ ê¸°ë°˜ ë™ì  íŒë‹¨ + ëŠ¥ë™ì  ê°œì…" | +3ì  |
| ì„¤ëª… | "ì ìˆ˜ ê³„ì‚° ê²°ê³¼" | "ë² ì´ì¦ˆ í™•ë¥  + ì¦ê±° ê¸°ë°˜ ì„¤ëª…" | +2ì  |

**ì´ì  ì˜ˆìƒ**: 18/20 (ê¸°ì¡´ 13/20)

#### ì‹¬ì‚¬ í•­ëª© 2: ê¸°ìˆ  ì„¤ê³„ (30ì )

| í‰ê°€ í•­ëª© | ê¸°ì¡´ | ì œì•ˆ | ì ìˆ˜ ì˜ˆìƒ |
|----------|------|------|-----------|
| Agentic AI ì„¤ê³„ | "Kananaê°€ ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜" | "Kananaê°€ ë² ì´ì¦ˆ ì¶”ë¡ ìœ¼ë¡œ ì¦ê±° ì¢…í•©" | +5ì  |
| Tool Use ì„¤ê³„ | "DB ì¡°íšŒ, NER" | "ë™ì  ìœ„í—˜ë„ ì¡°ì • í¬í•¨" | +3ì  |
| ê¸°ìˆ ì  íƒ€ë‹¹ì„± | "ê°€ì¤‘ í‰ê· " | "IEEE/ICML ë…¼ë¬¸ ê¸°ë°˜" | +5ì  |

**ì´ì  ì˜ˆìƒ**: 27/30 (ê¸°ì¡´ 19/30)

#### ì‹¬ì‚¬ í•­ëª© 3: ê²€ì¦ ë° ê±°ë²„ë„ŒìŠ¤ (30ì )

| í‰ê°€ í•­ëª© | ê¸°ì¡´ | ì œì•ˆ | ì ìˆ˜ ì˜ˆìƒ |
|----------|------|------|-----------|
| ì„±ëŠ¥ í‰ê°€ ê³„íš | "ì •í™•ë„ ì¸¡ì •" | "F2-Score, Cost-Sensitive, ECE" | +5ì  |
| í’ˆì§ˆ ë³´ì¦ ê³„íš | "Retry ë¡œì§" | "ì‹ ë¢°ë„ ë³´ì • (ICML 2017)" | +3ì  |
| ì•ˆì „ì„± ì œì–´ | "ê²½ê³  í‘œì‹œ" | "í™•ë¥  ê¸°ë°˜ ë™ì  ê°œì…" | +2ì  |

**ì´ì  ì˜ˆìƒ**: 27/30 (ê¸°ì¡´ 22/30)

#### ì‹¬ì‚¬ í•­ëª© 5: ê°€ì‚°ì  - Kanana í™œìš© (10ì )

| í‰ê°€ í•­ëª© | ê¸°ì¡´ | ì œì•ˆ | ì ìˆ˜ ì˜ˆìƒ |
|----------|------|------|-----------|
| Kanana í™œìš© | "ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜ë§Œ" | "ë² ì´ì¦ˆ ì¶”ë¡  ì—”ì§„ìœ¼ë¡œ í™œìš©" | +3ì  |
| í•œêµ­ì–´ íŠ¹ì„± | "ë³€ì¹™ í‘œê¸° ì²˜ë¦¬" | "ë™ì¼ (ìœ ì§€)" | +0ì  |

**ì´ì  ì˜ˆìƒ**: 8/10 (ê¸°ì¡´ 5/10)

---

### 1.4. ì¢…í•© í‰ê°€

#### ì„¤ë“ë ¥ í‰ê°€: â­â­â­â­ (4/5)

**ê°•ì **:
- âœ… í•™ìˆ ì  ê·¼ê±° ëª…í™• â†’ ì‹¬ì‚¬ìœ„ì› ì„¤ë“ë ¥ ë†’ìŒ
- âœ… ì„¤ëª… ê°€ëŠ¥ì„± í–¥ìƒ â†’ ì‚¬ìš©ì ì‹ ë¢° ì¦ê°€
- âœ… ë§¥ë½ ë°˜ì˜ â†’ False Positive ê°ì†Œ

**ì•½ì **:
- âš ï¸ êµ¬í˜„ ë³µì¡ë„ ì¦ê°€ â†’ ì¼ì • ì••ë°•
- âš ï¸ ë°ì´í„° ì˜ì¡´ì„± â†’ ì´ˆê¸° íŠœë‹ ë¶€ë‹´
- âš ï¸ ê¸°ì¡´ ì½”ë“œ ì¬ì‘ì„± â†’ ë¦¬ìŠ¤í¬

**ìµœì¢… íŒë‹¨**:
> **ê²½ì§„ëŒ€íšŒ ê¸°íšì„œ ë‹¨ê³„ì—ì„œëŠ” ë§¤ìš° ì„¤ë“ë ¥ ìˆìŒ** âœ…
> **ì‹¤ì œ êµ¬í˜„ ì‹œì—ëŠ” ê°„ì†Œí™” ë²„ì „ ê¶Œì¥** âš ï¸

---

## Part 2: ê¸°ì¡´ ê³„íš/êµ¬í˜„ ëŒ€ë¹„ ê°­ ë¶„ì„

### 2.1. í˜„ì¬ êµ¬í˜„ í˜„í™© (As-Is)

#### ì•„í‚¤í…ì²˜ ì„¤ê³„ âœ…
- [x] 6ë‹¨ê³„ MCP íŒŒì´í”„ë¼ì¸ ì„¤ê³„ ì™„ë£Œ
- [x] MECE 9-ì¹´í…Œê³ ë¦¬ ì²´ê³„ ì •ì˜ ì™„ë£Œ
- [x] Kanana 2.0 í”„ë¡¬í”„íŠ¸ êµ¬ì¡° ì„¤ê³„ ì™„ë£Œ

#### ì½”ë“œ êµ¬í˜„ ğŸ”„
```
agent/core/
â”œâ”€â”€ action_policy.py      âœ… (ê°€ì¤‘ í‰ê·  ê¸°ë°˜)
â”œâ”€â”€ score_utils.py        âœ… (ì‹œê°„ ì¡°ì •, ë¡œê·¸ ì‹ ë¢°ë„)
â”œâ”€â”€ pattern_matcher.py    âœ… (ê·œì¹™ ê¸°ë°˜ íŒ¨í„´)
â”œâ”€â”€ threat_matcher.py     âœ… (DB ì¡°íšŒ ë¡œì§)
â””â”€â”€ conversation_analyzer.py âœ… (ëŒ€í™” ë¶„ì„)
```

**í˜„ì¬ ì ìˆ˜ ê³„ì‚° ë¡œì§**:
```python
# action_policy.py
STAGE_WEIGHTS = {
    "stage1_text": 0.4,
    "stage2_scam_db": 0.4,
    "stage3_sender": 0.2
}

total_score = (
    stage1_score * 0.4 +
    stage2_score * 0.4 +
    (stage3_adjustment + time_adjustment) * 0.2
)

if total_score >= 80:
    risk = "CRITICAL"
elif total_score >= 60:
    risk = "HIGH"
# ...
```

#### MCP ì„œë²„ êµ¬í˜„ âŒ
```
agent/mcp_servers/
â”œâ”€â”€ context_analyzer.py    âŒ (ë¯¸êµ¬í˜„)
â”œâ”€â”€ entity_extractor.py    âŒ (ë¯¸êµ¬í˜„)
â”œâ”€â”€ threat_intelligence.py âŒ (ë¯¸êµ¬í˜„)
â”œâ”€â”€ social_graph.py        âŒ (ë¯¸êµ¬í˜„)
â”œâ”€â”€ decision_engine.py     âŒ (ë¯¸êµ¬í˜„)
â”œâ”€â”€ privacy.py             âŒ (ë¯¸êµ¬í˜„)
â””â”€â”€ verification.py        âŒ (ë¯¸êµ¬í˜„)
```

---

### 2.2. ë² ì´ì¦ˆ ë°©ì•ˆ êµ¬í˜„ ì‹œ ì¶”ê°€ ì‘ì—… (To-Be)

#### ë ˆë²¨ 1: í•„ìˆ˜ êµ¬í˜„ (MUST HAVE) ğŸ”´

##### 1. Bayesian Risk Calculator ëª¨ë“ˆ (ì‹ ê·œ)
**íŒŒì¼**: `agent/core/bayesian_risk_calculator.py`

**êµ¬í˜„ ë‚´ìš©**:
```python
class BayesianRiskCalculator:
    """ë² ì´ì¦ˆ ì •ë¦¬ ê¸°ë°˜ ìœ„í—˜ë„ ê³„ì‚°"""

    def __init__(self):
        # ì¹´í…Œê³ ë¦¬ë³„ ì‚¬ì „ í™•ë¥  (KISA 2024 ë°ì´í„° ê¸°ë°˜)
        self.CATEGORY_PRIOR = {
            "A-1": 0.85,  # ê°€ì¡± ì‚¬ì¹­
            "A-2": 0.75,  # ì§€ì¸ ì‚¬ì¹­
            "B-2": 0.90,  # ê¸°ê´€ ì‚¬ì¹­
            "C-1": 0.70,  # íˆ¬ì ê¶Œìœ 
            # ...
        }

        # ì¦ê±°ë³„ ê°€ì¤‘ì¹˜
        self.EVIDENCE_WEIGHTS = {
            "db_reported": 1.0,
            "sender_trust": 0.7,
            "time_risk": 0.3,
            "urgency": 0.5,
            "consistency": 0.4
        }

    def calculate_posterior(
        self,
        category: str,
        evidence: dict
    ) -> float:
        """
        P(Scam|Evidence) = P(Evidence|Scam) Ã— P(Scam) / P(Evidence)

        Args:
            category: A-1 ~ C-3 | NORMAL
            evidence: {
                "db_reported": bool,
                "sender_trust": float,
                "time_risk": float,
                "urgency": float,
                "consistency": float
            }

        Returns:
            float: ì‚¬í›„ í™•ë¥  (0-1)
        """
        # ì‚¬ì „ í™•ë¥ 
        prior = self.CATEGORY_PRIOR.get(category, 0.5)

        # DB ì‹ ê³  ìˆìœ¼ë©´ ì ˆëŒ€ ìš°ì„ 
        if evidence.get("db_reported"):
            return 0.99

        # ìš°ë„ ê³„ì‚° (ê°€ì¤‘í•©)
        likelihood = sum(
            evidence.get(key, 0) * weight
            for key, weight in self.EVIDENCE_WEIGHTS.items()
            if key != "db_reported"
        )

        # ë² ì´ì¦ˆ ì •ë¦¬ (ë‹¨ìˆœí™” ë²„ì „)
        posterior = prior * (1 + likelihood) / 2

        return min(max(posterior, 0.0), 1.0)
```

**ì‘ì—…ëŸ‰**: 3ì¼ (ì„¤ê³„ 1ì¼ + êµ¬í˜„ 1ì¼ + í…ŒìŠ¤íŠ¸ 1ì¼)

##### 2. Temperature Scaling ëª¨ë“ˆ (ì‹ ê·œ)
**íŒŒì¼**: `agent/core/temperature_scaling.py`

**êµ¬í˜„ ë‚´ìš©**:
```python
import math

class TemperatureScaling:
    """ì‹ ë¢°ë„ ë³´ì • (ICML 2017)"""

    def __init__(self, temperature: float = 1.5):
        """
        Args:
            temperature: ë³´ì • ê³„ìˆ˜ (>1: ì™„í™”, <1: ê°•í™”)
        """
        self.T = temperature

    def calibrate(self, prob: float) -> float:
        """
        Temperature Scalingìœ¼ë¡œ í™•ë¥  ë³´ì •

        Args:
            prob: ì›ë³¸ í™•ë¥  (0-1)

        Returns:
            float: ë³´ì •ëœ í™•ë¥  (0-1)

        Reference:
            Guo et al. (ICML 2017) - On Calibration of Modern Neural Networks
        """
        if prob <= 0 or prob >= 1:
            return prob

        # Logit ë³€í™˜
        logit = math.log(prob / (1 - prob))

        # Temperature Scaling
        calibrated_logit = logit / self.T

        # Sigmoid ì—­ë³€í™˜
        calibrated_prob = 1 / (1 + math.exp(-calibrated_logit))

        return calibrated_prob
```

**ì‘ì—…ëŸ‰**: 2ì¼ (êµ¬í˜„ 1ì¼ + ê²€ì¦ ë°ì´í„°ì…‹ íŠœë‹ 1ì¼)

##### 3. Decision Engine MCP ì—…ê·¸ë ˆì´ë“œ
**íŒŒì¼**: `agent/mcp_servers/decision_engine.py` (ìˆ˜ì •)

**ê¸°ì¡´**:
```python
def decide_risk_level(category, db_result, trust):
    # ìš°ì„ ìˆœìœ„ ë¡œì§ë§Œ
    if db_result["has_reported"]:
        return "CRITICAL"
    return CATEGORY_BASE_RISK[category]
```

**ì œì•ˆ**:
```python
def decide_risk_level_bayesian(
    category: str,
    context: dict,
    db_result: dict,
    trust: dict
) -> dict:
    """ë² ì´ì¦ˆ ê¸°ë°˜ ë™ì  ìœ„í—˜ë„ ê²°ì •"""

    # 1. ë² ì´ì¦ˆ í™•ë¥  ê³„ì‚°
    calculator = BayesianRiskCalculator()
    evidence = {
        "db_reported": db_result["has_reported"],
        "sender_trust": trust["trust_score"],
        "time_risk": context["time_risk"],
        "urgency": context["urgency_level"],
        "consistency": context["tone_consistency"]
    }
    posterior_prob = calculator.calculate_posterior(category, evidence)

    # 2. Temperature Scalingìœ¼ë¡œ ì‹ ë¢°ë„ ë³´ì •
    ts = TemperatureScaling(T=1.5)
    calibrated_confidence = ts.calibrate(posterior_prob)

    # 3. ìœ„í—˜ë„ ë§¤í•‘ (Cost-Sensitive Thresholds)
    final_risk = map_probability_to_risk(
        posterior_prob,
        calibrated_confidence
    )

    return {
        "category": category,
        "base_risk": CATEGORY_BASE_RISK[category],
        "final_risk": final_risk,
        "confidence": round(calibrated_confidence, 2),
        "probability": round(posterior_prob, 2),
        "reasoning": generate_reasoning(...)
    }
```

**ì‘ì—…ëŸ‰**: 3ì¼ (ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • 1ì¼ + í†µí•© í…ŒìŠ¤íŠ¸ 2ì¼)

---

#### ë ˆë²¨ 2: ê¶Œì¥ êµ¬í˜„ (SHOULD HAVE) ğŸŸ¡

##### 4. Cost-Sensitive Thresholds ì„¤ì •
**íŒŒì¼**: `agent/core/cost_sensitive_thresholds.py` (ì‹ ê·œ)

**êµ¬í˜„ ë‚´ìš©**:
```python
# KISA 2024 ë°ì´í„° ê¸°ë°˜
FN_COST = 3_000_000  # False Negative: í‰ê·  í”¼í•´ì•¡ 300ë§Œì›
FP_COST = 10_000     # False Positive: ì‚¬ìš©ì ë¶ˆí¸ 1ë§Œì›

def calculate_optimal_threshold(fn_cost, fp_cost, base_rate=0.05):
    """
    ë¹„ìš© ë¯¼ê°ì  ìµœì  ì„ê³„ê°’ ê³„ì‚°

    Reference:
        IEEE 2016 - Cost-Sensitive Learning
    """
    cost_ratio = fn_cost / fp_cost  # 300
    optimal_threshold = base_rate * cost_ratio / (1 + cost_ratio)
    return optimal_threshold
```

**ì‘ì—…ëŸ‰**: 1ì¼

##### 5. Hierarchical Category System (D-N ì¹´í…Œê³ ë¦¬)
**íŒŒì¼**: `agent/core/category_classifier.py` (ìˆ˜ì •)

**ì¶”ê°€ ë¡œì§**:
```python
def classify_with_openworld(text, confidence_threshold=0.6):
    """Open-World Recognition (CVPR 2019)"""

    result = kanana_classify(text)

    if result["confidence"] < confidence_threshold:
        return {
            "category": "D-N",  # Unknown
            "confidence": result["confidence"],
            "flag_for_review": True,
            "reasoning": "ê¸°ì¡´ íŒ¨í„´ê³¼ ì¼ì¹˜ë„ ë‚®ìŒ, ì‹ ê·œ ìœ í˜• ê°€ëŠ¥ì„±"
        }

    return result
```

**ì‘ì—…ëŸ‰**: 2ì¼

---

#### ë ˆë²¨ 3: ì„ íƒ êµ¬í˜„ (NICE TO HAVE) ğŸŸ¢

##### 6. F2-Score í‰ê°€ ë©”íŠ¸ë¦­
**íŒŒì¼**: `tests/evaluation/f2_score_calculator.py` (ì‹ ê·œ)

**êµ¬í˜„ ë‚´ìš©**:
```python
def f_beta_score(precision, recall, beta=2):
    """
    F-beta Score (Î²=2: Recall ìš°ì„ )

    F2 = (1 + 2Â²) Ã— (Precision Ã— Recall) / (2Â² Ã— Precision + Recall)
    """
    if precision + recall == 0:
        return 0
    return (1 + beta**2) * (precision * recall) / (beta**2 * precision + recall)
```

**ì‘ì—…ëŸ‰**: 1ì¼

##### 7. Expected Calibration Error (ECE)
**íŒŒì¼**: `tests/evaluation/calibration_metrics.py` (ì‹ ê·œ)

**êµ¬í˜„ ë‚´ìš©**:
```python
def expected_calibration_error(predictions, ground_truth, n_bins=10):
    """
    ì‹ ë¢°ë„ ë³´ì • í’ˆì§ˆ ì¸¡ì •

    Reference:
        ICML 2017 - On Calibration of Modern Neural Networks
    """
    # êµ¬í˜„ ìƒëµ (í‘œì¤€ ECE ê³„ì‚° ë¡œì§)
    pass
```

**ì‘ì—…ëŸ‰**: 1ì¼

---

### 2.3. ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • ì‚¬í•­

#### ìˆ˜ì • í•„ìš” íŒŒì¼

##### 1. `action_policy.py` (ëŒ€ê·œëª¨ ìˆ˜ì •)
**í˜„ì¬**:
```python
STAGE_WEIGHTS = {"stage1_text": 0.4, ...}
total_score = stage1*0.4 + stage2*0.4 + stage3*0.2
```

**ì œì•ˆ**:
```python
# ê°€ì¤‘ í‰ê·  ì‚­ì œ
# decide_risk_level_bayesian() í˜¸ì¶œë¡œ ë³€ê²½
```

**ì˜í–¥ë„**: ğŸ”´ High (ì „ì²´ ë¡œì§ ì¬ì‘ì„±)

##### 2. `score_utils.py` (ë¶€ë¶„ ìœ ì§€)
**í˜„ì¬**:
```python
calculate_logarithmic_trust_score()  # ë¡œê·¸ ìŠ¤ì¼€ì¼ ì‹ ë¢°ë„
time_risk_adjustment()               # ì‹œê°„ëŒ€ ì¡°ì •
```

**ì œì•ˆ**:
```python
# ë¡œê·¸ ì‹ ë¢°ë„ ê³„ì‚°ì€ ìœ ì§€ âœ…
# ì‹œê°„ëŒ€ ì¡°ì •ì€ ë² ì´ì¦ˆ evidenceë¡œ í†µí•© ğŸ”„
```

**ì˜í–¥ë„**: ğŸŸ¡ Medium (ë¶€ë¶„ ì¬ì‚¬ìš© ê°€ëŠ¥)

##### 3. Kanana Prompts (í”„ë¡¬í”„íŠ¸ ìˆ˜ì •)
**íŒŒì¼**: `prompts/context_analyzer.py` (ë¯¸êµ¬í˜„ â†’ ì‹ ê·œ ì‘ì„±)

**ì¶”ê°€ ë‚´ìš©**:
```python
system_prompt = """
ì—­í• : ë² ì´ì¦ˆ ì¶”ë¡  ê¸°ë°˜ ìœ„í—˜ë„ í‰ê°€ ì „ë¬¸ê°€

ë¶„ì„ í”„ë ˆì„ì›Œí¬:
1. ì‚¬ì „ í™•ë¥ : ì¹´í…Œê³ ë¦¬ë³„ ê¸°ë³¸ ìœ„í—˜ë„
   - A-1: P(Scam) = 0.85
   - B-2: P(Scam) = 0.90

2. ì¦ê±° í‰ê°€:
   - DB ì‹ ê³  (ê°€ì¤‘ì¹˜ 1.0)
   - ë°œì‹ ì ì‹ ë¢°ë„ (0.7)
   - ì‹œê°„ëŒ€ (0.3)
   - ê¸´ê¸‰ì„± (0.5)

3. ì¶œë ¥:
{
  "category": "A-1",
  "base_risk": "CRITICAL",
  "probability": 0.65,
  "evidence": {...}
}
"""
```

**ì˜í–¥ë„**: ğŸŸ¡ Medium (í”„ë¡¬í”„íŠ¸ ì¬ì‘ì„±)

---

### 2.4. ì‘ì—…ëŸ‰ ë° ì¼ì • ì¶”ì •

#### ìµœì†Œ êµ¬í˜„ (ë ˆë²¨ 1ë§Œ)
```
Week 1: Bayesian Risk Calculator (3ì¼)
Week 1: Temperature Scaling (2ì¼)
Week 2: Decision Engine ì—…ê·¸ë ˆì´ë“œ (3ì¼)
Week 2: í†µí•© í…ŒìŠ¤íŠ¸ (2ì¼)
ì´: 10ì¼ (2ì£¼)
```

#### ê¶Œì¥ êµ¬í˜„ (ë ˆë²¨ 1 + ë ˆë²¨ 2)
```
Week 1-2: ë ˆë²¨ 1 (10ì¼)
Week 3: Cost-Sensitive Thresholds (1ì¼)
Week 3: Hierarchical Category (2ì¼)
Week 3: í†µí•© ë° A/B í…ŒìŠ¤íŠ¸ (2ì¼)
ì´: 15ì¼ (3ì£¼)
```

#### ì™„ì „ êµ¬í˜„ (ë ˆë²¨ 1 + ë ˆë²¨ 2 + ë ˆë²¨ 3)
```
Week 1-3: ë ˆë²¨ 1+2 (15ì¼)
Week 4: F2-Score í‰ê°€ (1ì¼)
Week 4: ECE ë©”íŠ¸ë¦­ (1ì¼)
Week 4: ë¬¸ì„œí™” ë° ë°°í¬ (3ì¼)
ì´: 20ì¼ (4ì£¼)
```

---

## Part 3: í˜„ì‹¤ì  ê¶Œì¥ ë°©ì•ˆ

### 3.1. ê²½ì§„ëŒ€íšŒ ì¼ì • ê³ ë ¤

**í˜„ì¬ ì‹œì **: 2025-12-07
**ì˜ˆì„  ë§ˆê°**: ì¶”ì • 2-4ì£¼ í›„ (ì‚¬ìš©ì í™•ì¸ í•„ìš”)

### 3.2. í•˜ì´ë¸Œë¦¬ë“œ ì ‘ê·¼ (ì¶”ì²œ) â­

#### Option A: "ì´ë¡  + ê°„ì†Œí™” êµ¬í˜„"

**ê¸°íšì„œ**:
- âœ… ë² ì´ì¦ˆ ì •ë¦¬ ê¸°ë°˜ ì„¤ê³„ ëª…ì‹œ
- âœ… IEEE/ICML ë…¼ë¬¸ ë ˆí¼ëŸ°ìŠ¤
- âœ… F2-Score, ECE í‰ê°€ ê³„íš ê¸°ìˆ 

**ì‹¤ì œ êµ¬í˜„**:
- ğŸ”„ ê°„ì†Œí™” ë²„ì „ (ë ˆë²¨ 1ë§Œ)
  - Bayesian Risk Calculator (ë‹¨ìˆœí™”)
  - Temperature Scaling (ê³ ì • T=1.5)
  - Decision Engine (ê¸°ë³¸ ë¡œì§ë§Œ)
- âœ… ê¸°ì¡´ ê°€ì¤‘ í‰ê·  ì¼ë¶€ í™œìš©
- âœ… 2ì£¼ ë‚´ ì™„ì„± ê°€ëŠ¥

**ì¥ì **:
- âœ… ì‹¬ì‚¬ìœ„ì›ì—ê²Œ ì´ë¡ ì  ì„¤ë“ë ¥ ì œê³µ
- âœ… êµ¬í˜„ ë¶€ë‹´ ìµœì†Œí™”
- âœ… ì¼ì • ì¤€ìˆ˜ ê°€ëŠ¥

**ë‹¨ì **:
- âš ï¸ "ë§ê³¼ ì‹¤ì œ ì°¨ì´" ë¦¬ìŠ¤í¬
- âš ï¸ ë³¸ì„  ì§„ì¶œ ì‹œ ì™„ì „ êµ¬í˜„ í•„ìš”

#### Option B: "ê¸°ì¡´ ë°©ì‹ + ì´ë¡ ì  ì •ë‹¹í™”"

**ê¸°íšì„œ**:
- ğŸ”„ "ê°€ì¤‘ í‰ê·  ê¸°ë°˜ ì ìˆ˜í™”"ë¥¼ "ë² ì´ì¦ˆ ê·¼ì‚¬"ë¡œ ì¬í•´ì„
- âœ… ì˜ˆ: "ê°€ì¤‘ í‰ê· ì€ ë² ì´ì¦ˆ í™•ë¥ ì˜ ì„ í˜• ê·¼ì‚¬ (Linear Bayesian Approximation)"
- âœ… Cost-Sensitive Thresholds ì–¸ê¸‰

**ì‹¤ì œ êµ¬í˜„**:
- âœ… ê¸°ì¡´ ì½”ë“œ ìœ ì§€
- âœ… Temperature Scalingë§Œ ì¶”ê°€ (2ì¼)
- âœ… í‰ê°€ ë©”íŠ¸ë¦­ ê°œì„  (F2-Score, 1ì¼)

**ì¥ì **:
- âœ… êµ¬í˜„ ë¶€ë‹´ ìµœì†Œ (3ì¼)
- âœ… ê¸°ì¡´ ì½”ë“œ ì¬ì‚¬ìš©
- âœ… ë¦¬ìŠ¤í¬ ë‚®ìŒ

**ë‹¨ì **:
- âš ï¸ í•™ìˆ ì  ì •ë‹¹ì„± ì•½í•¨
- âš ï¸ ì‹¬ì‚¬ìœ„ì› ì„¤ë“ë ¥ ë‚®ì„ ìˆ˜ ìˆìŒ

#### Option C: "ì™„ì „ ë² ì´ì¦ˆ êµ¬í˜„" (ë¹„ì¶”ì²œ)

**ì´ìœ **:
- âŒ 4ì£¼ ì†Œìš” â†’ ì¼ì • ì••ë°•
- âŒ ë””ë²„ê¹… ë¦¬ìŠ¤í¬ ë†’ìŒ
- âŒ ì˜ˆì„ ìš©ìœ¼ë¡œ ê³¼ë„í•œ íˆ¬ì

---

### 3.3. ìµœì¢… ê¶Œì¥: Option A (ì´ë¡  + ê°„ì†Œí™” êµ¬í˜„)

#### êµ¬í˜„ ê³„íš (2ì£¼)

**Week 1: í•µì‹¬ ëª¨ë“ˆ**
- Day 1-3: Bayesian Risk Calculator (ê°„ì†Œí™”)
  ```python
  # ë‹¨ìˆœ ê°€ì¤‘í•© ë²„ì „ (ë² ì´ì¦ˆ ê·¼ì‚¬)
  posterior = prior * (1 + weighted_evidence_sum) / 2
  ```
- Day 4-5: Temperature Scaling (ê³ ì • T=1.5)

**Week 2: í†µí•© ë° í…ŒìŠ¤íŠ¸**
- Day 6-7: Decision Engine ì—…ê·¸ë ˆì´ë“œ
- Day 8-9: í†µí•© í…ŒìŠ¤íŠ¸
- Day 10: ë¬¸ì„œí™” (ê¸°íšì„œ ì—…ë°ì´íŠ¸)

#### ê¸°íšì„œ ì‘ì„± ì „ëµ

**ê°•ì¡° í¬ì¸íŠ¸**:
1. **ì´ë¡ ì  ë°°ê²½**:
   - "ë² ì´ì¦ˆ ì •ë¦¬ ê¸°ë°˜ ìœ„í—˜ë„ í‰ê°€ (IEEE 2018)"
   - "Temperature Scaling ì‹ ë¢°ë„ ë³´ì • (ICML 2017)"
   - "Cost-Sensitive Learning (IEEE 2016)"

2. **êµ¬í˜„ ê³„íš**:
   - "ì‚¬ì „ í™•ë¥ : KISA 2024 ë°ì´í„° ê¸°ë°˜"
   - "ì¦ê±° ê°€ì¤‘ì¹˜: ë„ë©”ì¸ ì „ë¬¸ê°€ í˜‘ì˜"
   - "ê°„ì†Œí™” êµ¬í˜„: ì„ í˜• ë² ì´ì¦ˆ ê·¼ì‚¬"

3. **í‰ê°€ ê³„íš**:
   - "F2-Score (Î²=2, Recall ìš°ì„ )"
   - "Expected Calibration Error (ECE)"
   - "ë¹„ìš© ê¸°ë°˜ í‰ê°€ (FN:FP = 300:1)"

**ê¸°ëŒ€ íš¨ê³¼**:
- âœ… ì‹¬ì‚¬ìœ„ì›: "ì´ë¡ ì ìœ¼ë¡œ íƒ„íƒ„í•˜ë‹¤"
- âœ… êµ¬í˜„: 2ì£¼ ë‚´ ì™„ì„± ê°€ëŠ¥
- âœ… ë³¸ì„  ì§„ì¶œ ì‹œ ì™„ì „ êµ¬í˜„ ì—¬ìœ 

---

## Part 4: ìˆ˜ì •/ì¶”ê°€ ì‘ì—… ì²´í¬ë¦¬ìŠ¤íŠ¸

### í•„ìˆ˜ ì‘ì—… (2ì£¼)

- [ ] **Bayesian Risk Calculator** ê°„ì†Œí™” êµ¬í˜„
  - [ ] ì¹´í…Œê³ ë¦¬ë³„ ì‚¬ì „ í™•ë¥  ì„¤ì • (KISA ë°ì´í„°)
  - [ ] ì¦ê±° ê°€ì¤‘í•© ê³„ì‚° ë¡œì§
  - [ ] ë‹¨ìˆœ ë² ì´ì¦ˆ ê·¼ì‚¬ ê³µì‹ ì ìš©

- [ ] **Temperature Scaling** ê¸°ë³¸ êµ¬í˜„
  - [ ] ê³ ì • T=1.5 íŒŒë¼ë¯¸í„°
  - [ ] Logit ë³€í™˜ ë° ë³´ì • ë¡œì§

- [ ] **Decision Engine MCP** ì—…ê·¸ë ˆì´ë“œ
  - [ ] `decide_risk_level_bayesian()` í•¨ìˆ˜ ì¶”ê°€
  - [ ] ê¸°ì¡´ `action_policy.py` ì—°ë™

- [ ] **Kanana Prompt** ì¬ì‘ì„±
  - [ ] Context Analyzer: ë² ì´ì¦ˆ í”„ë ˆì„ì›Œí¬ ì¶”ê°€
  - [ ] Social Graph: ì¦ê±° í•­ëª© ëª…ì‹œ

- [ ] **í†µí•© í…ŒìŠ¤íŠ¸**
  - [ ] 900ê±´ ì‚¬ê¸° + 300ê±´ ì •ìƒ ë©”ì‹œì§€
  - [ ] F2-Score ì¸¡ì •

### ì„ íƒ ì‘ì—… (ì¶”ê°€ 1ì£¼)

- [ ] **Cost-Sensitive Thresholds** ì„¤ì •
- [ ] **Hierarchical Category** (D-N ì¶”ê°€)
- [ ] **ECE ë©”íŠ¸ë¦­** êµ¬í˜„

### ê¸°íšì„œ ì—…ë°ì´íŠ¸

- [ ] **ê¸°ìˆ  ì„¤ê³„ ì„¹ì…˜**
  - [ ] ë² ì´ì¦ˆ ì •ë¦¬ ìˆ˜ì‹ ì¶”ê°€
  - [ ] IEEE/ICML ë…¼ë¬¸ ë ˆí¼ëŸ°ìŠ¤
  - [ ] ê°„ì†Œí™” êµ¬í˜„ ëª…ì‹œ

- [ ] **ê²€ì¦ ê³„íš ì„¹ì…˜**
  - [ ] F2-Score í‰ê°€ ê¸°ì¤€
  - [ ] ECE ì¸¡ì • ê³„íš
  - [ ] ë¹„ìš© ê¸°ë°˜ í‰ê°€

---

## Part 5: ê²°ë¡  ë° ì œì•ˆ

### ê°ê´€ì  í‰ê°€ ìš”ì•½

| í•­ëª© | í‰ê°€ | ê·¼ê±° |
|------|------|------|
| **í•™ìˆ ì  ì„¤ë“ë ¥** | â­â­â­â­â­ | IEEE/ICML ë…¼ë¬¸ ê¸°ë°˜, ì´ë¡ ì  íƒ€ë‹¹ì„± ë†’ìŒ |
| **êµ¬í˜„ ë‚œì´ë„** | â­â­ | 2-4ì£¼ ì¶”ê°€ ì‘ì—… í•„ìš” |
| **ê²½ì§„ëŒ€íšŒ ì í•©ì„±** | â­â­â­â­ | ì‹¬ì‚¬ ê¸°ì¤€ ëŒ€ì‘ ìš°ìˆ˜ (+10-15ì  ì˜ˆìƒ) |
| **ì‹¤ìš©ì„±** | â­â­â­ | ê°„ì†Œí™” êµ¬í˜„ ì‹œ ì‹¤ìš©ì  |

### ìµœì¢… ì œì•ˆ

#### 1. ê¸°íšì„œ ë‹¨ê³„ (í˜„ì¬)
- âœ… **ë² ì´ì¦ˆ ê¸°ë°˜ ì„¤ê³„ ì±„íƒ** â†’ ì‹¬ì‚¬ìœ„ì› ì„¤ë“ë ¥ ê·¹ëŒ€í™”
- âœ… IEEE/ICML ë…¼ë¬¸ ë ˆí¼ëŸ°ìŠ¤ ëª…ì‹œ
- âœ… F2-Score, ECE í‰ê°€ ê³„íš ê¸°ìˆ 

#### 2. êµ¬í˜„ ë‹¨ê³„ (2ì£¼)
- ğŸ”„ **ê°„ì†Œí™” êµ¬í˜„** (Option A)
  - Bayesian Risk Calculator (ì„ í˜• ê·¼ì‚¬)
  - Temperature Scaling (ê³ ì • íŒŒë¼ë¯¸í„°)
  - Decision Engine (ê¸°ë³¸ ë¡œì§)
- âœ… ê¸°ì¡´ ì½”ë“œ ì¼ë¶€ ì¬ì‚¬ìš©
- âœ… 2ì£¼ ë‚´ ì™„ì„± ëª©í‘œ

#### 3. ë³¸ì„  ì§„ì¶œ ì‹œ
- ğŸš€ **ì™„ì „ êµ¬í˜„** ì§„í–‰
  - ë ˆë²¨ 2, 3 ì¶”ê°€ ê°œë°œ
  - ë°ì´í„° ê¸°ë°˜ íŒŒë¼ë¯¸í„° íŠœë‹
  - ì„±ëŠ¥ ìµœì í™”

### ë¦¬ìŠ¤í¬ ê´€ë¦¬

**High Risk**:
- âŒ ì™„ì „ êµ¬í˜„ ì‹œë„ â†’ ì¼ì • ì••ë°•

**Medium Risk**:
- âš ï¸ ê°„ì†Œí™” êµ¬í˜„ â†’ "ë§ê³¼ ì‹¤ì œ ì°¨ì´"
- **ì™„í™”**: ê¸°íšì„œì— "ë‹¨ê³„ì  êµ¬í˜„" ëª…ì‹œ

**Low Risk**:
- âœ… ê¸°ì¡´ ë°©ì‹ ìœ ì§€ + ì´ë¡ ì  ì •ë‹¹í™”
- **ë‹¨ì **: ì‹¬ì‚¬ ì ìˆ˜ ë‚®ì„ ìˆ˜ ìˆìŒ

---

**ìµœì¢… ì¶”ì²œ**: Option A (ì´ë¡  + ê°„ì†Œí™” êµ¬í˜„) â­â­â­â­â­

**ì´ìœ **:
1. ì‹¬ì‚¬ìœ„ì› ì„¤ë“ë ¥ ìµœëŒ€í™”
2. êµ¬í˜„ ë¶€ë‹´ í•©ë¦¬ì  (2ì£¼)
3. ë³¸ì„  ì§„ì¶œ ì‹œ í™•ì¥ ê°€ëŠ¥
4. ë¦¬ìŠ¤í¬ ê· í˜• ìš°ìˆ˜

---

**ì‘ì„±ì¼**: 2025-12-07
**ë¬¸ì„œ ìœ„ì¹˜**: `testdata/KAT/docs/agent_b_bayesian_approach_evaluation.md`
