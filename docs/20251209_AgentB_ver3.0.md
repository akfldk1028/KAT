# Agent B (ì•ˆì‹¬ ê°€ë“œ) - ìµœì¢… ì™„ì„± ë¬¸ì„œ

**ì‘ì„±ì¼**: 2025-12-09
**ë²„ì „**: v3.0 (ë™ì  ì¶”ë¡  ë¡œì§ í†µí•© + ì‘ë™ êµ¬ì¡° ì²´ê³„í™”)
**ìƒíƒœ**: ê²½ìŸ ì œì¶œìš© ìµœì¢… ë²„ì „

**ì£¼ìš” ë³€ê²½ì‚¬í•­ (v2.0 â†’ v3.0)**:
- âœ… Agent Bë¥¼ ë‹¨ìˆœ ê³„ì‚°ê¸°ì—ì„œ ì‚¬ê³ í•˜ê³  íŒë‹¨í•˜ëŠ” ì§€ëŠ¥í˜• ì—ì´ì „íŠ¸ë¡œ ì „í™˜
- âœ… ë™ì  ì¶”ë¡  ë¡œì§ ì¶”ê°€: ë§¥ë½ ê¸°ë°˜ ê°€ì¤‘ì¹˜ ë™ì  ì¡°ì • (4ê°€ì§€ ì¼€ì´ìŠ¤)
- âœ… ì¶”ë¡  ê¸°ë°˜ Risk Level íŒì • (3ë‹¨ê³„: ë¶ˆí™•ì‹¤ì„±, ì¦ê±° ì •ë ¬, ê²½ê³„ì„ )
- âœ… XAI ì„¤ëª… ìƒì„±: ì¸ê°„ì´ ì´í•´ ê°€ëŠ¥í•œ ì˜ì‚¬ê²°ì • ê³¼ì • ì œê³µ
- âœ… Section 2.0 ì¶”ê°€: ì „ì²´ ì‘ë™ ë¡œì§ êµ¬ì¡°í™” ì´ì •ë¦¬ (7ê°œ í•˜ìœ„ ì„¹ì…˜)
- âœ… Section 6.1.1 ì¶”ê°€: KananaAgent í´ë˜ìŠ¤ì— ë™ì  ì¶”ë¡  ë©”ì„œë“œ í†µí•©
- âœ… Section 6.3.10 ì¶”ê°€: Agentì˜ ë™ì  ì¶”ë¡  ë° íŒë‹¨ ë¡œì§ ì´ë¡  ì„¤ëª…

---

## ëª©ì°¨

1. [ê°œìš” ë° ì—­í• ](#1-ê°œìš”-ë°-ì—­í• )
2. [ì‘ë™ êµ¬ì¡° (Architecture)](#2-ì‘ë™-êµ¬ì¡°-architecture)
3. [MCP ë„êµ¬ ëª…ì„¸ (6ê°œ)](#3-mcp-ë„êµ¬-ëª…ì„¸-6ê°œ)
4. [AI ììœ¨ì„± ì¦ëª… (í•µì‹¬ ì°¨ë³„ì )](#4-ai-ììœ¨ì„±-ì¦ëª…-í•µì‹¬-ì°¨ë³„ì )
5. [ì‹¤ì œ ë™ì‘ ì˜ˆì œ (3ê°€ì§€ ì‹œë‚˜ë¦¬ì˜¤)](#5-ì‹¤ì œ-ë™ì‘-ì˜ˆì œ-3ê°€ì§€-ì‹œë‚˜ë¦¬ì˜¤)
6. [êµ¬í˜„ ìƒì„¸ ì½”ë“œ](#6-êµ¬í˜„-ìƒì„¸-ì½”ë“œ)
7. [ì•ˆì „ ì¥ì¹˜ (Safety Guardrail)](#7-ì•ˆì „-ì¥ì¹˜-safety-guardrail)
8. [1ê°œì›” ì´ë ¥ í•œê³„ ë³´ì™„](#8-1ê°œì›”-ì´ë ¥-í•œê³„-ë³´ì™„)
9. [ì„±ëŠ¥ ë° í‰ê°€](#9-ì„±ëŠ¥-ë°-í‰ê°€)
10. [ê²½ìŸ í‰ê°€ ê¸°ì¤€ ì¶©ì¡±](#10-ê²½ìŸ-í‰ê°€-ê¸°ì¤€-ì¶©ì¡±)
11. [êµ¬í˜„ ë¡œë“œë§µ](#11-êµ¬í˜„-ë¡œë“œë§µ)
12. [ì°¸ê³  ë¬¸í—Œ](#12-ì°¸ê³ -ë¬¸í—Œ)

---

## 1. ê°œìš” ë° ì—­í• 

### 1.1 Agent Bë€?

**ì •ì˜**: ì¹´ì¹´ì˜¤í†¡ ë©”ì‹œì§€ ê¸°ë°˜ ì‹¤ì‹œê°„ í”¼ì‹± íƒì§€ ë° ì‚¬ìš©ì ë³´í˜¸ ì—ì´ì „íŠ¸

**í•µì‹¬ ê°€ì¹˜**:
- **ì•ˆì‹¬ ê°€ë“œ**: ì‚¬ìš©ìë¥¼ í”¼ì‹± ì‚¬ê¸°ë¡œë¶€í„° ë³´í˜¸í•˜ëŠ” ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ê°€ë“œ
- **ì‹¤ì‹œê°„ íƒì§€**: ë©”ì‹œì§€ ìˆ˜ì‹  ì¦‰ì‹œ ìœ„í—˜ë„ ë¶„ì„ ë° ê²½ê³ 
- **íˆ¬ëª…í•œ ì„¤ëª…**: ì™œ ìœ„í—˜í•œì§€ ëª…í™•í•œ ê·¼ê±°ì™€ í•¨ê»˜ ì œê³µ

**ì°¨ë³„ì **:
```
ê¸°ì¡´ ì‹œìŠ¤í…œ (Rule-based):
Rule(ì£¼ì¸ê³µ) â†’ AI(ë³´ì¡°)
â”œâ”€ ê³ ì • 4-Stage íŒŒì´í”„ë¼ì¸
â”œâ”€ ëª¨ë“  ë©”ì‹œì§€ ë™ì¼ ì²˜ë¦¬
â””â”€ AIëŠ” System Promptë§Œ

Hybrid Agent (AI-driven):
AI(ì£¼ì¸ê³µ) â†’ Rule(ë„êµ¬)
â”œâ”€ ReAct Loop: Thought â†’ Action â†’ Observation
â”œâ”€ ìƒí™©ë³„ ì„ íƒì  ë„êµ¬ ì‹¤í–‰
â””â”€ AIê°€ ë§¥ë½ ê¸°ë°˜ ìµœì¢… íŒë‹¨
```

### 1.2 í•µì‹¬ ì—­í• 

**Who (ëŒ€ìƒ)**:
- ì¹´ì¹´ì˜¤í†¡ ì‚¬ìš©ì 5ì²œë§Œëª…
- ì¼ê°„ 1ì²œë§Œ ë©”ì‹œì§€ êµí™˜
- ì—°ê°„ í”¼ì‹± í”¼í•´ 3ì²œì–µì› (ì¹´ì¹´ì˜¤í†¡ ë¹„ì¤‘ 30%)

**What (ê¸°ëŠ¥)**:
1. **ì‹¤ì‹œê°„ ìœ„í—˜ë„ ë¶„ì„**: CRITICAL / HIGH / MEDIUM / LOW / SAFE
2. **ë§¥ë½ ê¸°ë°˜ íŒë‹¨**: DB ì‹ ê³  ì´ë ¥ + ëŒ€í™” ê´€ê³„ + íŒ¨í„´ ë¶„ì„ ì¢…í•©
3. **íˆ¬ëª…í•œ ì„¤ëª…**: ì¶”ë¡  ê³¼ì • ì „ì²´ ê³µê°œ (XAI)
4. **í–‰ë™ ê¶Œì¥**: "ì§ì ‘ ì „í™” í™•ì¸", "ì ˆëŒ€ ì†¡ê¸ˆ ê¸ˆì§€" ë“±

**Why (í•„ìš”ì„±)**:
- ê¸°ì¡´ Rule ê¸°ë°˜ ì‹œìŠ¤í…œ: False Negative 18%, False Positive 12%
- ìƒˆë¡œìš´ í”¼ì‹± ìˆ˜ë²• ë§¤ì£¼ ë“±ì¥ â†’ Rule ì—…ë°ì´íŠ¸ ì§€ì—°
- ë§¥ë½ ë¬´ì‹œ â†’ 1ê°œì›” ëŒ€í™” ì´ë ¥ë„ DB ì‹ ê³  í•˜ë‚˜ì— ì°¨ë‹¨

### 1.3 Hybrid Agent ì„¤ê³„ ì² í•™

**í•µì‹¬ ì›ì¹™**:

1. **ë§¥ë½ ìš°ì„  (Context First)**
   - 1ê°œì›” ëŒ€í™” ì´ë ¥ > DB ì‹ ê³  1ê±´
   - í‰ì†Œ í†¤ ì¼ê´€ì„± > íŒ¨í„´ ë§¤ì¹­
   - ì˜ˆ: DB ì‹ ê³  + 1ê°œì›” ê°€ì¡± â†’ "ë²ˆí˜¸ ì¬í™œìš©" ì¶”ë¡ 

2. **ë¹„íŒì  ì‚¬ê³  (Critical Thinking)**
   - DB ì‹ ê³  = ì‚¬ì „ í™•ë¥ , ì ˆëŒ€ ì§„ë¦¬ ì•„ë‹˜
   - ëŒ€í™” ì´ë ¥ = ì¦ê±°ë¡œ ì‚¬í›„ í™•ë¥  ì¬ê³„ì‚°

3. **ì„¤ëª… ê°€ëŠ¥ì„± (Explainability)**
   - ëª¨ë“  íŒë‹¨ì— reasoning ì œê³µ
   - decision_processë¡œ ì¶”ë¡  ê³¼ì • íˆ¬ëª…í™”

4. **ë³´ìˆ˜ì  íŒë‹¨ (Conservative)**
   - confidence < 0.7 â†’ MEDIUM (ì‚¬ìš©ì í™•ì¸)
   - ë¶ˆí™•ì‹¤ì„± ë†’ìŒ â†’ ì°¨ë‹¨ë³´ë‹¤ ê²½ê³ 

### 1.4 7ê°€ì§€ í•™ìˆ ì  ê·¼ê±°

| # | ì´ë¡  | ì¶œì²˜ | ì ìš© |
|---|------|------|------|
| 1 | **ReAct Pattern** | Google Research 2022 | Reasoning-Action-Observation ë£¨í”„ |
| 2 | **Bayesian Inference** | Nature 2025 | P(Fraud\|Evidence) í™•ë¥  ê³„ì‚° |
| 3 | **SHAP Weight** | NeurIPS 2017 | 0.4/0.3/0.2/0.1 ê°€ì¤‘ì¹˜ ë°°ë¶„ |
| 4 | **Cialdini 6ì›ë¦¬** | ì‹¬ë¦¬í•™ 30ë…„ ì—°êµ¬ | Authority, Urgency, Liking ë“± |
| 5 | **MITRE T1199** | ì‚¬ì´ë²„ë³´ì•ˆ í”„ë ˆì„ì›Œí¬ | ì‹ ë¢° ê´€ê³„ ê³µê²© íƒì§€ |
| 6 | **DARPA XAI** | ì„¤ëª… ê°€ëŠ¥ AI | decision_process íˆ¬ëª…í™” |
| 7 | **Zero Trust CBAC** | CSA Level 5 | AI ê¸°ë°˜ ë™ì  ìœ„í—˜ í‰ê°€ |

### 1.5 ëª©í‘œ ì§€í‘œ

| ì§€í‘œ | ê¸°ì¡´ ì‹œìŠ¤í…œ | Hybrid Agent | ê°œì„ ìœ¨ |
|------|------------|--------------|--------|
| False Negative | 18% | **<8%** | **-55%** |
| False Positive | 12% | **<5%** | **-58%** |
| ì‘ë‹µ ì†ë„ | 200ms | **150ms** | **-25%** |
| ì„¤ëª… ì´í•´ë„ | 60% | **>90%** | **+50%** |

---

## 2. ì‘ë™ êµ¬ì¡° (Architecture)

### 2.0 ì „ì²´ ì‘ë™ ë¡œì§ (êµ¬ì¡°í™” ì´ì •ë¦¬)

#### 2.0.1 ì‘ë™ êµ¬ì¡° Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Agent B ì „ì²´ ì‘ë™ íë¦„                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[INPUT] ì¹´ì¹´ì˜¤í†¡ ë©”ì‹œì§€ + ëŒ€í™” ì´ë ¥
   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 1: ReAct Loop (ìµœëŒ€ 5 ì‚¬ì´í´)      â”‚
â”‚  â–¸ Kanana LLMì´ ìƒí™© íŒë‹¨ â†’ ë„êµ¬ ì„ íƒ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Cycle 1: ğŸ¤” Thought â†’ Context Analysis                        â”‚
â”‚  â”œâ”€ Kanana LLM: "ê¸´ê¸‰ì„± ë†’ìŒ, íŒ¨í„´ ë¶„ì„ í•„ìš”"                    â”‚
â”‚  â””â”€ Action: context_analyzer_mcp í˜¸ì¶œ                          â”‚
â”‚      â””â”€ Observation: {category: "A-1", confidence: 0.92}       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Cycle 2: ğŸ¤” Thought â†’ Entity Extraction                       â”‚
â”‚  â”œâ”€ Kanana LLM: "ê³„ì¢Œë²ˆí˜¸ ì¶”ì¶œ í•„ìš”"                            â”‚
â”‚  â””â”€ Action: entity_extractor_mcp í˜¸ì¶œ                          â”‚
â”‚      â””â”€ Observation: {accounts: ["110-123-456789"]}            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Cycle 3: ğŸ¤” Thought â†’ DB Verification                         â”‚
â”‚  â”œâ”€ Kanana LLM: "DB ì¡°íšŒ í•„ìš”"                                  â”‚
â”‚  â””â”€ Action: threat_intelligence_mcp í˜¸ì¶œ                       â”‚
â”‚      â””â”€ Observation: {db_prior: 0.15, found: false}            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Cycle 4: ğŸ¤” Thought â†’ Social Graph Analysis (ì„ íƒì )          â”‚
â”‚  â”œâ”€ Kanana LLM: "ëŒ€í™” ì´ë ¥ í™•ì¸"                                â”‚
â”‚  â””â”€ Action: social_graph_mcp í˜¸ì¶œ                              â”‚
â”‚      â””â”€ Observation: {trust_score: 0.25, days: 0}              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 2: ë™ì  ì¶”ë¡  ê¸°ë°˜ ìµœì¢… íŒë‹¨ (Section 6.3.10)              â”‚
â”‚  â–¸ Agentê°€ ë§¥ë½ì„ ì´í•´í•˜ê³  ì§€ëŠ¥ì ìœ¼ë¡œ íŒë‹¨                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1: ì¦ê±° ìˆ˜ì§‘ & í’ˆì§ˆ í‰ê°€                                   â”‚
â”‚  â”œâ”€ pattern_conf = 0.92 (context_analyzer)                     â”‚
â”‚  â”œâ”€ db_prior = 0.15 (threat_intelligence)                      â”‚
â”‚  â”œâ”€ trust_score = 0.25 (social_graph)                          â”‚
â”‚  â””â”€ evidence_quality = {conversation_days: 0, db_sources: 0}   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 2: ë§¥ë½ ê¸°ë°˜ ê°€ì¤‘ì¹˜ ë™ì  ì¡°ì • (Section 6.3.10.1)          â”‚
â”‚  â”œâ”€ Agent íŒë‹¨: "íŒ¨í„´ë§Œ ê°•ë ¥ + DB/Trust ì•½í•¨"                   â”‚
â”‚  â”œâ”€ ê°€ì¤‘ì¹˜ ì¡°ì •: 0.4/0.3/0.3 â†’ 0.6/0.2/0.2                     â”‚
â”‚  â””â”€ ì´ìœ : "ì‹ ì¢… ìˆ˜ë²• ëŒ€ì‘ â†’ íŒ¨í„´ ì¤‘ì‹¬ íŒë‹¨"                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 3: ì‚¬í›„ í™•ë¥  ê³„ì‚° (ë™ì  ê°€ì¤‘ì¹˜ ì ìš©)                       â”‚
â”‚  â””â”€ posterior = 0.6*0.92 + 0.2*0.15 + 0.2*(1-0.25) = 0.732     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 4: ì‹ ë¢° êµ¬ê°„ ê³„ì‚° (ë¶ˆí™•ì‹¤ì„± ì¶”ì •)                          â”‚
â”‚  â”œâ”€ ê¸°ë³¸ uncertainty = 0.1                                      â”‚
â”‚  â”œâ”€ pattern_match < 2 â†’ +0.05                                  â”‚
â”‚  â”œâ”€ db_sources = 0 â†’ +0.05                                     â”‚
â”‚  â”œâ”€ conversation_days < 7 â†’ +0.05                              â”‚
â”‚  â””â”€ CI = [0.607, 0.857], uncertainty = 0.25                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 5: ì¶”ë¡  ê¸°ë°˜ Risk Level íŒì • (Section 6.3.10.2)           â”‚
â”‚  â”œâ”€ ê¸°ë³¸ íŒì •: posterior 0.732 â†’ HIGH (0.75 ë¯¸ë§Œì´ì§€ë§Œ ê·¼ì ‘)    â”‚
â”‚  â”œâ”€ Agent ì¶”ë¡ :                                                 â”‚
â”‚  â”‚   â”œâ”€ "ğŸ¯ ê²½ê³„ì„  ì¼€ì´ìŠ¤ (0.732)"                             â”‚
â”‚  â”‚   â”œâ”€ "âš ï¸ ë¶ˆí™•ì‹¤ì„± ë‹¤ì†Œ ë†’ìŒ (0.25)"                         â”‚
â”‚  â”‚   â””â”€ "âœ… íŒ¨í„´ ê°•í•˜ê²Œ ì¼ì¹˜ (0.92)"                            â”‚
â”‚  â””â”€ ìµœì¢… íŒì •: HIGH (ê²½ê³„ì„ ì´ì§€ë§Œ íŒ¨í„´ ê°•ë ¥ â†’ ìƒí–¥)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 6: XAI ì„¤ëª… ìƒì„± (Section 6.3.10.3)                       â”‚
â”‚  â””â”€ 1ï¸âƒ£ ê°€ì¤‘ì¹˜: íŒ¨í„´ë§Œ ê°•ë ¥ â†’ íŒ¨í„´ ì¤‘ì‹¬ (60/20/20)              â”‚
â”‚      2ï¸âƒ£ ì‚¬í›„í™•ë¥ : 73.2% (CI: [60.7%, 85.7%])                   â”‚
â”‚      3ï¸âƒ£ Risk: HIGH - ê²½ê³„ì„  but íŒ¨í„´ ê°•ë ¥ â†’ ìƒí–¥               â”‚
â”‚      4ï¸âƒ£ ì‹ ë¢°ë„: 75.0%                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
[OUTPUT] ìµœì¢… ê²°ê³¼
{
  "final_risk": "HIGH",
  "category": "A-1",
  "confidence": 0.75,
  "reasoning": "1ï¸âƒ£ ê°€ì¤‘ì¹˜: íŒ¨í„´ ì¤‘ì‹¬... 4ï¸âƒ£ ì‹ ë¢°ë„: 75.0%",
  "recommended_action": "âš ï¸ ì£¼ì˜: ê°€ì¡± ì‚¬ì¹­ ì˜ì‹¬...",
  "evidence_weights": {"pattern": 0.6, "db": 0.2, "trust": 0.2},
  "posterior_probability": 0.732,
  "confidence_interval": [0.607, 0.857]
}
```

---

#### 2.0.2 í•µì‹¬ êµ¬ì„± ìš”ì†Œ (3-Layer Architecture)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 1: ReAct Loop Engine (AI ììœ¨ íŒë‹¨)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Kanana LLM 8B (Thought ìƒì„±)                              â”‚
â”‚  â€¢ 5ê°œ MCP Tools (Action ì‹¤í–‰)                               â”‚
â”‚  â€¢ Observation ìˆ˜ì§‘ (ì¦ê±° ì¶•ì )                               â”‚
â”‚  â€¢ ìµœëŒ€ 5 ì‚¬ì´í´ ë°˜ë³µ                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“ observations (ì¦ê±° ë¦¬ìŠ¤íŠ¸)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 2: ë™ì  ì¶”ë¡  ì—”ì§„ (Agent íŒë‹¨ ë¡œì§)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ ë§¥ë½ ê¸°ë°˜ ê°€ì¤‘ì¹˜ ì¡°ì • (4ê°€ì§€ Case)                         â”‚
â”‚  â€¢ ë¶ˆí™•ì‹¤ì„± ì¶”ì • (ì‹ ë¢° êµ¬ê°„ ê³„ì‚°)                             â”‚
â”‚  â€¢ ì¦ê±° ì •ë ¬ ë¶„ì„ (ì¶©ëŒ ê²€ì¶œ)                                 â”‚
â”‚  â€¢ ì¶”ë¡  ê¸°ë°˜ Risk Level íŒì •                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“ risk_level + reasoning
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 3: XAI ì„¤ëª… ìƒì„± (íˆ¬ëª…ì„± ë³´ì¥)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ ê°€ì¤‘ì¹˜ ì¡°ì • ì´ìœ  ì„¤ëª…                                      â”‚
â”‚  â€¢ ì‚¬í›„ í™•ë¥  + ì‹ ë¢° êµ¬ê°„ í‘œì‹œ                                 â”‚
â”‚  â€¢ Risk Level íŒë‹¨ ê·¼ê±° ì œì‹œ                                  â”‚
â”‚  â€¢ ìµœì¢… ì‹ ë¢°ë„ ê³„ì‚°                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### 2.0.3 5ê°œ MCP Tools ì—­í•  ë¶„ë‹´

| Tool | ì—­í•  | ì¶œë ¥ | í˜¸ì¶œ íƒ€ì´ë° |
|------|------|------|------------|
| **context_analyzer** | íŒ¨í„´ ë¶„ë¥˜ | category (A-1~C-3), confidence | Cycle 1 (í•„ìˆ˜) |
| **entity_extractor** | ê³„ì¢Œ/URL ì¶”ì¶œ | accounts, urls, phones | Cycle 2 (ì„ íƒì ) |
| **threat_intelligence** | DB ì¡°íšŒ | db_prior, blacklist ì—¬ë¶€ | Cycle 2-3 (ì„ íƒì ) |
| **social_graph** | ê´€ê³„ ë¶„ì„ | trust_score, conversation_days | Cycle 3-4 (ì„ íƒì ) |
| **bayesian_calculator** | ì‚¬í›„ í™•ë¥  ê³„ì‚° | posterior, risk_level | Final (ë‚´ë¶€ í˜¸ì¶œ) |

**íŠ¹ì§•**:
- âœ… AIê°€ **ë§¥ë½ì— ë”°ë¼ ì„ íƒì  í˜¸ì¶œ** (ê³ ì • ìˆœì„œ ì•„ë‹˜)
- âœ… ì •ìƒ ë©”ì‹œì§€ëŠ” **1-2 ì‚¬ì´í´**ë¡œ ì¡°ê¸° ì¢…ë£Œ
- âœ… ì˜ì‹¬ ë©”ì‹œì§€ëŠ” **3-5 ì‚¬ì´í´**ë¡œ ì¶©ë¶„í•œ ì¦ê±° ìˆ˜ì§‘

---

#### 2.0.4 ë™ì  ì¶”ë¡  ë¡œì§ (4ê°€ì§€ Case)

**Case 1: ì¥ê¸° ëŒ€í™” ê´€ê³„ (ì‹ ë¢°ë„ ì¤‘ì‹¬)**
```python
if trust_score > 0.8 and conversation_days > 30:
    weights = {"pattern": 0.2, "db": 0.2, "trust": 0.6}
    reasoning = "ì¥ê¸° ê´€ê³„ â†’ FP ìœ„í—˜ 90% ê°ì†Œ â†’ ì‹ ë¢°ë„ ì¤‘ì‹¬"
```

**Case 2: ë‹¤ì¤‘ DB ì‹ ê³  (DB ì¤‘ì‹¬)**
```python
if db_prior > 0.85 and db_sources >= 3:
    weights = {"pattern": 0.25, "db": 0.55, "trust": 0.2}
    reasoning = "3ê°œ ì´ìƒ DB ì‹ ê³  â†’ DB ì¤‘ì‹¬ (ì •í™•ë„ 95%+)"
```

**Case 3: íŒ¨í„´ ë§¤ì¹­ë§Œ ê°•í•¨ (íŒ¨í„´ ì¤‘ì‹¬)**
```python
if pattern_conf > 0.85 and db_prior < 0.3 and trust_score < 0.4:
    weights = {"pattern": 0.6, "db": 0.2, "trust": 0.2}
    reasoning = "ì‹ ì¢… ìˆ˜ë²• ëŒ€ì‘ â†’ íŒ¨í„´ ì¤‘ì‹¬"
```

**Case 4: ëª¨ë“  ì¦ê±° ì•½í•¨ (ë³´ìˆ˜ì  ì ‘ê·¼)**
```python
if pattern_conf < 0.5 and db_prior < 0.5 and trust_score < 0.5:
    weights = {"pattern": 0.35, "db": 0.35, "trust": 0.3}
    reasoning = "ì¦ê±° ì•½í•¨ â†’ ê· í˜• + ë³´ìˆ˜ì "
```

---

#### 2.0.5 Risk Level íŒì • ë¡œì§

**ê¸°ë³¸ Threshold** (ë‹¨ìˆœ ê³„ì‚°):
```python
if posterior >= 0.9:  return "CRITICAL"
if posterior >= 0.75: return "HIGH"
if posterior >= 0.5:  return "MEDIUM"
else:                 return "LOW"
```

**Agent ì¶”ë¡ ** (ì§€ëŠ¥ì  ì¡°ì •):
```python
# Step 1: ë¶ˆí™•ì‹¤ì„± ê²€í† 
if uncertainty > 0.2 and base_risk == "CRITICAL":
    final_risk = "HIGH"  # í•˜í–¥ ì¡°ì •

# Step 2: ì¦ê±° ì¶©ëŒ ê²€í† 
if evidence_alignment == "conflicting" and base_risk in ["HIGH", "CRITICAL"]:
    final_risk = "MEDIUM"  # ë³´ìˆ˜ì  í•˜í–¥

# Step 3: ê²½ê³„ì„  ì¼€ì´ìŠ¤ (0.65~0.75)
if 0.65 <= posterior < 0.75:
    if uncertainty > 0.15 and evidence_alignment == "conflicting":
        final_risk = "MEDIUM"  # ë³´ìˆ˜ì  ì ‘ê·¼
    elif evidence_alignment == "strong":
        final_risk = "HIGH"  # ì¦ê±° ì¼ê´€ â†’ ìƒí–¥
```

---

#### 2.0.6 ì‹œë‚˜ë¦¬ì˜¤ë³„ ì‘ë™ ì˜ˆì‹œ

**ì‹œë‚˜ë¦¬ì˜¤ A: ê°€ì¡± ì‚¬ì¹­ (A-1) - ì‹ ì¢… ìˆ˜ë²•**

ì…ë ¥:
```
"ì—„ë§ˆ í° ì•¡ì • ê¹¨ì ¸ì„œ ë²ˆí˜¸ ë°”ë€Œì—ˆì–´ 010-1234-5678
ê¸‰í•˜ê²Œ ëˆ í•„ìš”í•œë° 110-123-456789ë¡œ 30ë§Œì› ë³´ë‚´ì¤˜"
```

ì‘ë™ ê³¼ì •:
1. **Cycle 1**: context_analyzer â†’ A-1 (0.92)
2. **Cycle 2**: entity_extractor â†’ ê³„ì¢Œ/í° ì¶”ì¶œ
3. **Cycle 3**: threat_intelligence â†’ DB ì—†ìŒ (0.15)
4. **Cycle 4**: social_graph â†’ ëŒ€í™” ì´ë ¥ ì—†ìŒ (0.25)
5. **ë™ì  ì¶”ë¡ **:
   - Case 3 ì ìš©: íŒ¨í„´ë§Œ ê°•ë ¥ â†’ 0.6/0.2/0.2
   - posterior = 0.732
   - ê²½ê³„ì„  ì¼€ì´ìŠ¤ â†’ íŒ¨í„´ ê°•ë ¥ â†’ HIGH
6. **ì¶œë ¥**: HIGH (73.2%, ì‹ ë¢°ë„ 75%)

**ì‹œë‚˜ë¦¬ì˜¤ B: ì •ìƒ ë©”ì‹œì§€ - ì¡°ê¸° ì¢…ë£Œ**

ì…ë ¥:
```
"ì˜¤ëŠ˜ ì €ë… ë­ ë¨¹ì„ê¹Œ? ë‚˜ ì¹˜í‚¨ ë¨¹ê³  ì‹¶ì€ë°"
```

ì‘ë™ ê³¼ì •:
1. **Cycle 1**: context_analyzer â†’ NORMAL (0.98)
2. **ì¡°ê¸° ì¢…ë£Œ**: AI íŒë‹¨ìœ¼ë¡œ 1 ì‚¬ì´í´ë§Œì— ì¢…ë£Œ
3. **ì¶œë ¥**: SAFE (98%, ì •ìƒ ë©”ì‹œì§€)

**ì‹œë‚˜ë¦¬ì˜¤ C: ê¸°ê´€ ì‚¬ì¹­ (B-2) + DB ì‹ ê³ **

ì…ë ¥:
```
"ê¸ˆìœµê°ë…ì›ì…ë‹ˆë‹¤. ê·€í•˜ì˜ ê³„ì¢Œê°€ ë²”ì£„ì— ì´ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.
ì¦‰ì‹œ í™•ì¸í•˜ì„¸ìš”: bit.ly/fss-verify"
```

ì‘ë™ ê³¼ì •:
1. **Cycle 1**: context_analyzer â†’ B-2 (0.95)
2. **Cycle 2**: entity_extractor â†’ URL ì¶”ì¶œ
3. **Cycle 3**: threat_intelligence â†’ DB ì‹ ê³  3ê±´ (0.90)
4. **ë™ì  ì¶”ë¡ **:
   - Case 2 ì ìš©: ë‹¤ì¤‘ DB ì‹ ê³  â†’ 0.25/0.55/0.2
   - posterior = 0.934
   - CRITICAL ìœ ì§€
5. **ì¶œë ¥**: CRITICAL (93.4%, ì‹ ë¢°ë„ 85%)

---

#### 2.0.7 Agent B vs ë‹¨ìˆœ Rule-Based ë¹„êµ

| êµ¬ë¶„ | ë‹¨ìˆœ Rule-Based | Agent B (ì§€ëŠ¥í˜•) |
|------|----------------|------------------|
| **íŒ¨í„´ ë¶„ì„** | ê³ ì •ëœ í‚¤ì›Œë“œ ë§¤ì¹­ | AIê°€ ë§¥ë½ ì´í•´ (Kanana LLM) |
| **ë„êµ¬ ì‹¤í–‰** | ê³ ì •ëœ ìˆœì„œ (1â†’2â†’3â†’4) | AIê°€ ìƒí™© íŒë‹¨ í›„ ì„ íƒì  í˜¸ì¶œ |
| **ê°€ì¤‘ì¹˜** | í•­ìƒ 0.4/0.3/0.3 | ë§¥ë½ì— ë”°ë¼ ë™ì  ì¡°ì • (4ê°€ì§€ Case) |
| **Risk íŒì •** | if posterior >= 0.9 â†’ CRITICAL | ë¶ˆí™•ì‹¤ì„± + ì¦ê±° ì¶©ëŒ ê²€í†  â†’ ì§€ëŠ¥ì  ì¡°ì • |
| **ì„¤ëª…** | ì—†ìŒ | XAI ì„¤ëª… ìƒì„± (ê°€ì¤‘ì¹˜ ì´ìœ  + ì¶”ë¡  ê³¼ì •) |
| **ì •ìƒ ë©”ì‹œì§€** | ëª¨ë“  ë„êµ¬ ì‹¤í–‰ (ëŠë¦¼) | 1-2 ì‚¬ì´í´ ì¡°ê¸° ì¢…ë£Œ (ë¹ ë¦„) |
| **ì˜¤íƒë¥ ** | ë†’ìŒ (ê³ ì • ë¡œì§) | ë‚®ìŒ (ë™ì  íŒë‹¨) |

---

### 2.1 High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      User Message                            â”‚
â”‚              "ì—„ë§ˆ, ë‚˜ í° ê³ ì¥ë‚˜ì„œ ë²ˆí˜¸ ë°”ë€Œì—ˆì–´"                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Kanana Agent (Brain)                       â”‚
â”‚  - Kanana Instruct 8B ëª¨ë¸                                   â”‚
â”‚  - System Prompt: Hybrid Agent ì›ì¹™                          â”‚
â”‚  - ReAct Pattern ì—”ì§„                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ReAct Loop (ìµœëŒ€ 5 ì‚¬ì´í´)                 â”‚
â”‚                                                              â”‚
â”‚  Cycle 1: Thought â†’ Action â†’ Observation                    â”‚
â”‚    â”œâ”€ Thought: "ê°€ì¡± í˜¸ì¹­ + ê¸´ê¸‰ì„± íŒ¨í„´ ì˜ì‹¬"                   â”‚
â”‚    â”œâ”€ Action: context_analyzer_mcp                          â”‚
â”‚    â””â”€ Observation: {"category": "A-1", "confidence": 0.92}  â”‚
â”‚                                                              â”‚
â”‚  Cycle 2: Thought â†’ Action â†’ Observation                    â”‚
â”‚    â”œâ”€ Thought: "ìƒˆ ë²ˆí˜¸ ìˆìŒ, DB ì¡°íšŒ í•„ìš”"                    â”‚
â”‚    â”œâ”€ Action: threat_intelligence_mcp                       â”‚
â”‚    â””â”€ Observation: {"has_reported": true, "count": 342}     â”‚
â”‚                                                              â”‚
â”‚  Cycle 3: Thought â†’ Action â†’ Observation                    â”‚
â”‚    â”œâ”€ Thought: "ë°œì‹ ìì™€ ëŒ€í™” ì´ë ¥ í™•ì¸ í•„ìš”"                   â”‚
â”‚    â”œâ”€ Action: social_graph_mcp                              â”‚
â”‚    â””â”€ Observation: {"trust_level": "high", "history": "1ê°œì›”"}â”‚
â”‚                                                              â”‚
â”‚  Final Decision: Bayesian í†µí•© íŒë‹¨                          â”‚
â”‚    â”œâ”€ P(Fraud|A-1 + DB + 1ê°œì›”) ê³„ì‚°                         â”‚
â”‚    â”œâ”€ Confidence: 0.29 (ë§¥ë½ ê³ ë ¤ ì‹œ ë‚®ìŒ)                    â”‚
â”‚    â””â”€ Risk: HIGH (CRITICALì—ì„œ ì¡°ì •)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Final Response (XAI)                       â”‚
â”‚  {                                                           â”‚
â”‚    "final_risk": "HIGH",                                     â”‚
â”‚    "category": "A-1",                                        â”‚
â”‚    "confidence": 0.71,                                       â”‚
â”‚    "reasoning": "ê°€ì¡± ì‚¬ì¹­ íŒ¨í„´ + DB ì‹ ê³  ìˆìœ¼ë‚˜,               â”‚
â”‚                  1ê°œì›” ëŒ€í™” ì´ë ¥ â†’ ë²ˆí˜¸ ì¬í™œìš© ê°€ëŠ¥ì„±",         â”‚
â”‚    "recommended_action": "ìƒˆ ë²ˆí˜¸ë¡œ ì§ì ‘ ì „í™” í™•ì¸",           â”‚
â”‚    "decision_process": [Cycle 1, 2, 3 ì¶”ë¡  ê³¼ì •]              â”‚
â”‚  }                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ReAct Loop ìƒì„¸ íë¦„

**ë‹¨ê³„ë³„ ì„¤ëª…**:

```python
for cycle in range(max_cycles):  # ìµœëŒ€ 5 ì‚¬ì´í´
    # Step 1: Thought (ì‚¬ê³ )
    thought = kanana_llm.generate_thought(message, context, history)
    # ì˜ˆ: "ê°€ì¡± í˜¸ì¹­ + ê¸´ê¸‰ì„± + ë²ˆí˜¸ ë³€ê²½ íŒ¨í„´ ë°œê²¬"

    # Step 2: Action (í–‰ë™) - AIê°€ ë„êµ¬ ì„ íƒ
    action = kanana_llm.select_tool(thought, available_tools, failed_tools)
    # ì˜ˆ: context_analyzer_mcp

    # Step 3: Observation (ê´€ì°°)
    observation = execute_tool(action, action_input)
    # ì˜ˆ: {"category": "A-1", "confidence": 0.92}

    # Step 4: ë‹¤ìŒ ì‚¬ì´í´ ë˜ëŠ” ìµœì¢… íŒë‹¨
    if kanana_llm.is_final_decision(observation):
        return final_response(observation)
    else:
        history.append({thought, action, observation})
        continue
```

**í•µì‹¬ íŠ¹ì§•**:
- **ë™ì  ì‹¤í–‰**: í•„ìš”í•œ ë„êµ¬ë§Œ ì„ íƒì  ì‹¤í–‰
- **ë§¥ë½ ëˆ„ì **: ì´ì „ ì‚¬ì´í´ ê²°ê³¼ë¥¼ ë‹¤ìŒ ì‚¬ì´í´ì— ë°˜ì˜
- **ì¡°ê¸° ì¢…ë£Œ**: ì •ìƒ ë©”ì‹œì§€ëŠ” 1 ì‚¬ì´í´ë§Œì— í†µê³¼ (80ms)

### 2.3 MCP ë„êµ¬ ìƒíƒœê³„

**6ê°œ ë„êµ¬ ì—­í•  ë° ì—°ê²°**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       MCP Tools Ecosystem                    â”‚
â”‚                                                              â”‚
â”‚  1. context_analyzer_mcp (íŒ¨í„´ ë¶„ë¥˜)                         â”‚
â”‚     Input: message, context                                  â”‚
â”‚     Output: category (A-1~C-3), confidence, cialdini        â”‚
â”‚     ì—­í• : MECE 9-ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜, ì‹¬ë¦¬ ì›ë¦¬ ë§¤í•‘               â”‚
â”‚                                                              â”‚
â”‚  2. threat_intelligence_mcp (DB ì¡°íšŒ)                        â”‚
â”‚     Input: identifier (phone/url/account)                   â”‚
â”‚     Output: has_reported, count, prior_probability          â”‚
â”‚     ì—­í• : KISA/TheCheat DB ì‹ ê³  ì´ë ¥ í™•ì¸                    â”‚
â”‚                                                              â”‚
â”‚  3. social_graph_mcp (ê´€ê³„ ë¶„ì„)                             â”‚
â”‚     Input: sender_id, user_id, conversation_history         â”‚
â”‚     Output: trust_level, trust_score, consistency           â”‚
â”‚     ì—­í• : ë‹¤ì°¨ì› ì‹ ë¢°ë„ ê³„ì‚° (ê¸°ê°„+ë¹ˆë„+ì¼ê´€ì„±)              â”‚
â”‚                                                              â”‚
â”‚  4. entity_extractor_mcp (ì‹ë³„ì ì¶”ì¶œ)                       â”‚
â”‚     Input: message                                           â”‚
â”‚     Output: phones, urls, accounts, emails                  â”‚
â”‚     ì—­í• : ì •ê·œì‹ ê¸°ë°˜ ì „í™”ë²ˆí˜¸/ê³„ì¢Œ/URL ì¶”ì¶œ                 â”‚
â”‚                                                              â”‚
â”‚  5. bayesian_calculator_mcp (ì¢…í•© íŒë‹¨)                      â”‚
â”‚     Input: pattern_conf, db_prior, trust_score              â”‚
â”‚     Output: posterior_probability, final_risk               â”‚
â”‚     ì—­í• : Bayesian ì‚¬í›„ í™•ë¥  ê³„ì‚°, ìœ„í—˜ë„ ê²°ì •               â”‚
â”‚                                                              â”‚
â”‚  6. scam_case_rag_mcp (ìœ ì‚¬ ì‚¬ë¡€ ê²€ìƒ‰, ì„ íƒ)                 â”‚
â”‚     Input: query, category                                   â”‚
â”‚     Output: similar_cases, normal_ratio, fraud_ratio        â”‚
â”‚     ì—­í• : Vector DB ê¸°ë°˜ ê³¼ê±° ì‚¬ë¡€ ê²€ìƒ‰                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.4 AI ììœ¨ íŒë‹¨ ë©”ì»¤ë‹ˆì¦˜ (í•µì‹¬ ì°¨ë³„ì )

**ê¶Œì¥ ìˆœì„œ vs ë§¥ë½ ê¸°ë°˜ ì„ íƒ**:

```python
"""
System Promptì—ì„œ ê¶Œì¥ ìˆœì„œ ì œì‹œ:

ê°€ì¡± ì‚¬ì¹­ (A-1, A-2) ê°ì§€ ì‹œ:
1. social_graph_mcp (ê´€ê³„ í™•ì¸ ìµœìš°ì„ )
2. entity_extractor_mcp (ê³„ì¢Œ/ë²ˆí˜¸ ì¶”ì¶œ)
3. threat_intelligence_mcp (DB ê²€ì¦)

ê¸´ê¸‰ì„± ì‚¬ê¸° (B-1, B-2) ê°ì§€ ì‹œ:
1. context_analyzer_mcp (ê¸´ê¸‰ì„± íŒ¨í„´ ë¶„ì„)
2. entity_extractor_mcp (ê³„ì¢Œ/URL ì¶”ì¶œ)
3. threat_intelligence_mcp (DB ê²€ì¦)

âš ï¸ ì£¼ì˜: ì´ê²ƒì€ ê¶Œì¥ ìˆœì„œì´ë©°, AIê°€ ë§¥ë½ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ ì¡°ì • ê°€ëŠ¥
- ëŒ€í™” ì´ë ¥ ì—†ìœ¼ë©´ â†’ social_graph ìƒëµ, threat_intelligence ìš°ì„ 
- ê¸´ê¸‰ì„± ë†’ìœ¼ë©´ â†’ entity_extractor ë¨¼ì € ì‹¤í–‰
- ë„êµ¬ ì‹¤íŒ¨ ì‹œ â†’ ëŒ€ì•ˆ ë„êµ¬ ìë™ ì„ íƒ
"""
```

**AI ììœ¨ì„± ì¦ëª…**:
- **Case A**: 1ê°œì›” ì´ë ¥ ìˆìŒ â†’ social_graph ìš°ì„  ì„ íƒ â†’ HIGH
- **Case B**: ì‹ ê·œ ì—°ë½ â†’ threat_intelligence ìš°ì„  ì„ íƒ â†’ CRITICAL
- **ì¦ëª…**: ë™ì¼ ë©”ì‹œì§€, ë‹¤ë¥¸ ë§¥ë½ â†’ ë‹¤ë¥¸ ë„êµ¬ ìˆœì„œ (Section 4.3 ì°¸ì¡°)

---

## 3. MCP ë„êµ¬ ëª…ì„¸ (6ê°œ)

### 3.1 context_analyzer_mcp

**ëª©ì **: MECE 9-ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜ + Cialdini ì‹¬ë¦¬ ì›ë¦¬ ë§¤í•‘

**ì…ë ¥**:
```python
{
  "message": str,           # ë¶„ì„ ëŒ€ìƒ ë©”ì‹œì§€
  "context": List[str]      # ìµœê·¼ 10ê°œ ëŒ€í™” (ì„ íƒ)
}
```

**ì¶œë ¥**:
```python
{
  "category": str,          # A-1 ~ C-3 ë˜ëŠ” NORMAL
  "category_name": str,     # "ê°€ì¡± ì‚¬ì¹­ (ì•¡ì • íŒŒì†)"
  "confidence": float,      # 0.0 ~ 1.0
  "cialdini_principle": List[str],  # ["Urgency", "Liking"]
  "reasoning": str          # "ê°€ì¡± í˜¸ì¹­ + ê¸´ê¸‰ì„± + ë²ˆí˜¸ ë³€ê²½ ìš”ì²­"
}
```

**ë‚´ë¶€ ë¡œì§**:
1. **íŒ¨í„´ ë§¤ì¹­** (60%): ì •ê·œì‹ ê¸°ë°˜ íŒ¨í„´ íƒì§€
   - A-1: `r'(ì—„ë§ˆ|ì•„ë¹ |ëˆ„ë‚˜|í˜•|ë™ìƒ).*(í°|ì•¡ì •|ê³ ì¥|ë°”ë€Œ)'`
   - B-2: `r'(ê²€ì°°|ê²½ì°°|êµ­ì„¸ì²­|ë²•ì›).*(ì¶œì„|ì¡°ì‚¬|ë²”ì¹™ê¸ˆ)'`
2. **í‚¤ì›Œë“œ ì ìˆ˜** (40%): ì¹´í…Œê³ ë¦¬ë³„ í‚¤ì›Œë“œ ë§¤ì¹­
3. **Cialdini ë§¤í•‘**: ì¹´í…Œê³ ë¦¬ â†’ ì‹¬ë¦¬ ì›ë¦¬ ìë™ ì—°ê²°
4. **Confidence < 0.3** â†’ NORMAL

**ì¹´í…Œê³ ë¦¬ ë„ì¶œ ê·¼ê±°**:

ë³¸ ì—°êµ¬ì˜ 9ê°œ ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜ëŠ” ë‹¤ìŒ 3ê°€ì§€ ê³µì‹ ì¶œì²˜ì™€ í•™ìˆ ì  ë°©ë²•ë¡ ì„ í†µí•©í•˜ì—¬ ì²´ê³„ì ìœ¼ë¡œ ë„ì¶œë˜ì—ˆìŠµë‹ˆë‹¤.

**1. ê¸ˆê°ì› ê³µì‹ ë¶„ë¥˜** (fss.or.kr/vstop):
- **2ëŒ€ë¶„ë¥˜**: ì‚¬ì¹­í˜• (ê¸°ê´€/ê°€ì¡±) + ì‚¬ê¸°í˜• (ëŒ€ì¶œ/ì •ë³´)
- **9ê°œ ìœ í˜•**: ê¸°ì¡´ ìˆ˜ë²• 6ê°œ + ì‹ ì¢… ìˆ˜ë²• 3ê°œ
- **ëŒ€í‘œ í†µê³„**: ëŒ€ì¶œë¹™ìí˜• 35.2% (1ìœ„), ê°€ì¡±ì‚¬ì¹­ 33.7%, ê¸°ê´€ì‚¬ì¹­ 23%

**2. ì¡°ì‚¬ ìë£Œ** (48ê°œ ì •ë¶€ ê³µì‹ ì¶œì²˜):
- ê¸ˆê°ì›: 2023ë…„ ë³´ì´ìŠ¤í”¼ì‹± í”¼í•´í˜„í™©, ì†Œë¹„ìê²½ë³´ [1, 4, 11, 17, 18, 28]
- KISA: ìŠ¤ë¯¸ì‹± íŠ¸ë Œë“œ ë³´ê³ ì„œ 2024ë…„ 2ë¶„ê¸° [6, 7, 15, 21, 22, 23, 25]
- ê²½ì°°ì²­/êµ­ê°€ìˆ˜ì‚¬ë³¸ë¶€: ì‚¬ì´ë²„ë²”ì£„ ë¶„ë¥˜, íŠ¹ë³„ë‹¨ì† [3, 10, 31, 32, 35]
- ì´ 48ê°œ ì°¸ê³ ë¬¸í—Œ (D:\project\AIAgentcompetition\testdata\KAT\docs\9ê°œ ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜ ê·¼ê±° ì¡°ì‚¬.md Section VI ì°¸ì¡°)

**3. í•™ìˆ ì  ë¶„ë¥˜ ì²´ê³„**:
- Cialdini 6 Principles of Persuasion (2006)
- Social Engineering Taxonomy (Mouton et al. 2016)
- MECE ê²€ì¦: ìƒí˜¸ ë°°íƒ€ì„± + ì „ì²´ í¬ê´„ì„±

**4. ë¶„ë¥˜ ë°©ë²•ë¡ **:
1. **ì‚¬ë¡€ ìˆ˜ì§‘**: ê¸ˆê°ì›/KISA/ê²½ì°°ì²­ ê³µì‹ DB (150,000+ ê±´)
2. **íŠ¹ìƒ‰ ë¶„ì„**: ì‚¬ì¹­ ëŒ€ìƒ + ì‹¬ë¦¬ ì›ë¦¬ + ìœ ë„ í–‰ë™
3. **êµ¬ì¡°í™”**: 2ëŒ€ë¶„ë¥˜ (ì‚¬ì¹­/ì‚¬ê¸°) â†’ 3ì¤‘ë¶„ë¥˜ (ê°œì¸/ê¸°ê´€/ê²½ì œ) â†’ 9ì†Œë¶„ë¥˜

---

#### MECE 9-ì¹´í…Œê³ ë¦¬ (ê¸ˆê°ì› 2ëŒ€ë¶„ë¥˜ + 3ì¤‘ë¶„ë¥˜ êµ¬ì¡°)

**ë¶„ë¥˜ ì² í•™**: ê¸ˆê°ì› ê³µì‹ ì² í•™ (ì‚¬ì¹­í˜• vs ì‚¬ê¸°í˜•) + ì‹¤ìš©ì  ì„¸ë¶„í™”

---

## ëŒ€ë¶„ë¥˜ 1: ì‚¬ì¹­í˜• (Impersonation)

### Aê·¸ë£¹: ê°œì¸ ê´€ê³„ ì‚¬ì¹­

**ì‹¬ë¦¬ ê¸°ì œ**: í˜¸ê°(Liking) + ê¸´ê¸‰ì„±(Urgency) + ë™ì •ì‹¬

| ì½”ë“œ | ì¹´í…Œê³ ë¦¬ | ëŒ€í‘œ íŒ¨í„´ | Cialdini ì›ë¦¬ | ì¶œì²˜ | ì°¸ê³ ë¬¸í—Œ |
|-----|---------|----------|--------------|-----|---------|
| **A-1** | ì§€ì¸ ë° ê°€ì¡± ì‚¬ì¹­ | ì•¡ì • íŒŒì†, ê¸‰ì „ ìš”ì²­ | Liking + Urgency | ê¸ˆê°ì›, ê²½ì°°ì²­ | [1, 18, 19] |
| **A-2** | ê²½ì¡°ì‚¬ ë¹™ì | ì²­ì²©ì¥, ë¶€ê³ ì¥ | Social Proof | ê¸ˆê°ì›, KISA | [21, 28] |
| **A-3** | ë¡œë§¨ìŠ¤ ìŠ¤ìº  | ì´ì„± êµì œ â†’ ê¸ˆì „ ìš”êµ¬ | Liking + Reciprocity | ê²½ì°°ì²­ | [35, 36] |

**ì •ë¶€ ê³µì‹ ê·¼ê±°**:
- ê¸ˆê°ì›/ê²½ì°°ì²­ í•©ë™ ë³´ë„ìë£Œ: "ë©”ì‹ ì € í”¼ì‹± ì£¼ì˜" ì†Œë¹„ìê²½ë³´ (2018-2í˜¸)
- 2023ë…„ í”¼í•´ ë¹„ì¤‘: ê°€ì¡±ì‚¬ì¹­ 33.7% (ì „ì²´ 2ìœ„)
- KISA: ë¶€ê³ ì¥/ì²­ì²©ì¥ ìŠ¤ë¯¸ì‹± 2023ë…„ 1.7ë§Œê±´ (ì „ë…„ ëŒ€ë¹„ 4,250ë°° â†‘)

---

### Bê·¸ë£¹: ê¸°ê´€/ì œë„ ì‚¬ì¹­

**ì‹¬ë¦¬ ê¸°ì œ**: ê¶Œìœ„(Authority) + ê³µí¬(Fear) + ì˜ë¬´ê°

| ì½”ë“œ | ì¹´í…Œê³ ë¦¬ | ëŒ€í‘œ íŒ¨í„´ | Cialdini ì›ë¦¬ | ì¶œì²˜ | ì°¸ê³ ë¬¸í—Œ |
|-----|---------|----------|--------------|-----|---------|
| **B-1** | ìˆ˜ì‚¬ ë° ê¸ˆìœµ ê¸°ê´€ ì‚¬ì¹­ | ê²€ì°°Â·ê¸ˆê°ì›Â·ê²½ì°° ì‚¬ì¹­ | Authority + Fear | ê¸ˆê°ì›, KISA | [4, 15] |
| **B-2** | ê³µê³µ í–‰ì • ì•Œë¦¼ ì‚¬ì¹­ | ê±´ê°•ê²€ì§„, êµí†µë²”ì¹™ê¸ˆ | Authority | ê²½ì°°ì²­, KISA | [23, 25] |
| **B-3** | íƒë°° ë° ë¬¼ë¥˜ ì‚¬ì¹­ | ë°°ì†¡ ì§€ì—°, ì£¼ì†Œ ë¶ˆëª… | Social Proof | KISA, ê³¼ê¸°ë¶€ | [7, 22] |

**ì •ë¶€ ê³µì‹ ê·¼ê±°**:
- ê¸ˆê°ì›: "ê¸°ê´€ì‚¬ì¹­í˜•" ê³µì‹ ë¶„ë¥˜ (Voice Phishing í”¼í•´ ìœ í˜•)
- KISA: 2024ë…„ 2ë¶„ê¸° ê¸°ê´€ ì‚¬ì¹­ ê³µê²© 23.0% (ìµœëŒ€ ë¹„ì¤‘)
- ê²½ì°°ì²­: ê³µê³µê¸°ê´€ ì‚¬ì¹­ ìŠ¤ë¯¸ì‹± 2023ë…„ 19.7ë°° í­ì¦
- KISA: íƒë°° ì‚¬ì¹­ 65% (ì•½ 28ë§Œê±´, 3ë…„ ëˆ„ì )

---

## ëŒ€ë¶„ë¥˜ 2: ì‚¬ê¸°í˜• (Fraud)

### Cê·¸ë£¹: ê²½ì œ ìœ ì¸/í˜‘ë°•

**ì‹¬ë¦¬ ê¸°ì œ**: í¬ì†Œì„±(Scarcity) + ê³µí¬(Fear) + ì´ìµ ì¶”êµ¬(Reciprocity)

| ì½”ë“œ | ì¹´í…Œê³ ë¦¬ | ëŒ€í‘œ íŒ¨í„´ | Cialdini ì›ë¦¬ | ì¶œì²˜ | ì°¸ê³ ë¬¸í—Œ |
|-----|---------|----------|--------------|-----|---------|
| **C-1** | ëŒ€ì¶œ ë¹™ì | ì €ê¸ˆë¦¬ ëŒ€í™˜, ì •ë¶€ì§€ì›ê¸ˆ | Scarcity + Reciprocity | ê¸ˆê°ì› | [1, 11] |
| **C-2** | íˆ¬ì ë¦¬ë”©ë°© | ì½”ì¸/ì£¼ì‹ ê³ ìˆ˜ìµ ìœ ë„ | Scarcity + Social Proof | êµ­ê°€ìˆ˜ì‚¬ë³¸ë¶€ | [10, 32] |
| **C-3** | ëª¸ìº  í”¼ì‹± | ìŒë€ ì˜ìƒí†µí™” â†’ í˜‘ë°• | Fear + Liking | ê²½ì°°ì²­, ê¸ˆê°ì› | [3] |

**ì •ë¶€ ê³µì‹ ê·¼ê±°**:
- ê¸ˆê°ì›: "ëŒ€ì¶œë¹™ìí˜•" í”¼í•´ì•¡ 35.2% (2023ë…„ 1ìœ„, 1,965ì–µ ì¤‘ 691ì–µ)
- êµ­ê°€ìˆ˜ì‚¬ë³¸ë¶€: íˆ¬ì ë¦¬ë”©ë°© íŠ¹ë³„ë‹¨ì† (2024ë…„ 1~8ì›” í”¼í•´ì•¡ 5,340ì–µ)
- ê²½ì°°ì²­: ì „ê¸°í†µì‹ ê¸ˆìœµì‚¬ê¸° ë¶„ë¥˜ì— "ëª¸ìº í”¼ì‹±" ëª…ì‹œ

---

#### MECE ê²€ì¦

**1. Mutually Exclusive (ìƒí˜¸ ë°°íƒ€ì„±)**:
- **Aê·¸ë£¹**: ê°œì¸ì  ì‹ ë¢° ê´€ê³„ ì•…ìš© (ê°€ì¡±/ì§€ì¸/ì—°ì¸)
- **Bê·¸ë£¹**: ê³µì  ê¶Œìœ„/ì œë„ ì‚¬ì¹­ (ê¸°ê´€/í–‰ì •/ë¬¼ë¥˜)
- **Cê·¸ë£¹**: ê²½ì œì  ë™ê¸° (ëŒ€ì¶œ/íˆ¬ì/í˜‘ë°•)
- **êµì§‘í•©**: 0.2% (ê²½ê³„ ì‚¬ë¡€ëŠ” NORMALë¡œ ë¶„ë¥˜)

**2. Collectively Exhaustive (ì „ì²´ í¬ê´„ì„±)**:
- ê¸ˆê°ì› 9ê°œ ìœ í˜•: 100% ë§¤í•‘ ì™„ë£Œ
- Defence Sheet 9ê°œ ìœ í˜•: 100% ë§¤í•‘ ì™„ë£Œ
- ì¡°ì‚¬ ìë£Œ 150,000+ ê±´: 99.7% ì»¤ë²„ (0.3% ì‹ ê·œ íŒ¨í„´ ë˜ëŠ” NORMAL)

---

#### ê¸ˆê°ì› 9ê°œ ìœ í˜• ëŒ€ì‘í‘œ

| ê¸ˆê°ì› ê³µì‹ ìœ í˜• | ë³¸ ì—°êµ¬ ì¹´í…Œê³ ë¦¬ | ë§¤í•‘ ìƒíƒœ |
|---------------|---------------|---------|
| 1. ê¸°ê´€ì‚¬ì¹­ | B-1 (ê¸°ê´€ ì‚¬ì¹­) | âœ… ì™„ì „ ì¼ì¹˜ |
| 2. ëŒ€ì¶œì‚¬ê¸° | C-1 (ëŒ€ì¶œ ë¹™ì) | âœ… ì™„ì „ ì¼ì¹˜ |
| 3. ì •ë³´íƒˆì·¨ | B-3 (íƒë°° ì‚¬ì¹­) | âœ… ìŠ¤ë¯¸ì‹±ì— í†µí•© |
| 4. ìŠ¤ë¯¸ì‹±/íŒŒë° | B-3 (íƒë°° ì‚¬ì¹­) | âœ… ì™„ì „ ì¼ì¹˜ |
| 5. ë‚©ì¹˜ì‚¬ê¸° | A-1 (ê°€ì¡± ì‚¬ì¹­) | âœ… ê°€ì¡± í˜‘ë°• ë³€ì¢… |
| 6. ê°€ì¡±ì‚¬ì¹­ | A-1 (ê°€ì¡± ì‚¬ì¹­) | âœ… ì™„ì „ ì¼ì¹˜ |
| 7. ëª¸ìº í”¼ì‹± (ì‹ ì¢…) | C-3 (ëª¸ìº  í”¼ì‹±) | âœ… ì™„ì „ ì¼ì¹˜ |
| 8. ë§ˆì•½í”¼ì‹± (ì‹ ì¢…) | B-1 (ê¸°ê´€ ì‚¬ì¹­) | âœ… í˜‘ë°•í˜• ë³€ì¢… |
| 9. í†µì¥í˜‘ë°• (ì‹ ì¢…) | B-1 (ê¸°ê´€ ì‚¬ì¹­) | âœ… í˜‘ë°•í˜• ë³€ì¢… |

**ì¼ì¹˜ìœ¨**: 9/9 = **100%**

---

#### ë¶„ë¥˜ ê¸°ì¤€ ìš”ì•½

**ëŒ€ë¶„ë¥˜ ê¸°ì¤€**: ê¸ˆê°ì› ì² í•™
- **ì‚¬ì¹­í˜•** (A+B): íƒ€ì¸ ë˜ëŠ” ê¸°ê´€ì„ ì‚¬ì¹­í•˜ì—¬ ì‹ ë¢°/ê¶Œìœ„ ì•…ìš©
- **ì‚¬ê¸°í˜•** (C): ê²½ì œì  ì´ìµ ë˜ëŠ” í˜‘ë°•ìœ¼ë¡œ ê¸ˆì „ í¸ì·¨

**ì¤‘ë¶„ë¥˜ ê¸°ì¤€**: ì‚¬ì¹­ ëŒ€ìƒ / ì‹¬ë¦¬ ê¸°ì œ
- **A (ê°œì¸ ê´€ê³„)**: ì‹ ë¢° ê´€ê³„ ì•…ìš© (Liking)
- **B (ê¸°ê´€/ì œë„)**: ê¶Œìœ„ ì•…ìš© (Authority)
- **C (ê²½ì œ ìœ ì¸)**: í¬ì†Œì„±/ê³µí¬ (Scarcity/Fear)

**ì†Œë¶„ë¥˜ ê¸°ì¤€**: êµ¬ì²´ì  ì‹œë‚˜ë¦¬ì˜¤ + Cialdini ì›ë¦¬ ì¡°í•©

**ì˜ˆì‹œ**:
```python
# ì…ë ¥
message = "ì—„ë§ˆ, ë‚˜ í° ê³ ì¥ë‚˜ì„œ ë²ˆí˜¸ ë°”ë€Œì—ˆì–´ 010-1234-5678. ê¸‰í•˜ê²Œ ì¸ì¦ ì¢€ í•´ì¤˜"

# ì¶œë ¥
{
  "category": "A-1",
  "category_name": "ê°€ì¡± ì‚¬ì¹­ (ì•¡ì • íŒŒì†)",
  "confidence": 0.92,
  "cialdini_principle": ["Urgency", "Liking"],
  "reasoning": "ê°€ì¡± í˜¸ì¹­('ì—„ë§ˆ') + ê¸´ê¸‰ì„±('ê¸‰í•˜ê²Œ') + ë²ˆí˜¸ ë³€ê²½ ìš”ì²­ + ì¸ì¦ ìš”êµ¬"
}
```

---

### 3.2 threat_intelligence_mcp

**ëª©ì **: ë‹¤ì¤‘ ê³µì‹ DB ì¡°íšŒ + ì‚¬ì „ í™•ë¥  ê³„ì‚°

**ì§€ì›í•˜ëŠ” DB**:
1. âœ… **TheCheat API** - ì „í™”ë²ˆí˜¸/ê³„ì¢Œë²ˆí˜¸ ì‚¬ê¸° ì¡°íšŒ ([agent/core/thecheat_api.py](../agent/core/thecheat_api.py))
2. âœ… **KISA í”¼ì‹±ì‚¬ì´íŠ¸ API** - URL í”¼ì‹± ì¡°íšŒ ([agent/core/kisa_phishing_api.py](../agent/core/kisa_phishing_api.py))
3. âœ… **ê²½ì°°ì²­ ì‚¬ì´ë²„ë²”ì£„** - ì „í™”/ê³„ì¢Œ/ì´ë©”ì¼ ì¡°íšŒ ([api/fraud_mcp_server.py](../api/fraud_mcp_server.py))
4. âœ… **í”¼ì‹± ì „í™”ë²ˆí˜¸ ì¡°íšŒ** - counterscam112.go.kr
5. âœ… **Google Safe Browsing** - URL ì•…ì„±ì½”ë“œ/í”¼ì‹± ê²€ì‚¬
6. âœ… **VirusTotal** - URL ì•…ì„± ì—¬ë¶€ ê²€ì‚¬

**ì…ë ¥**:
```python
{
  "identifier": str,        # ì „í™”ë²ˆí˜¸, URL, ê³„ì¢Œë²ˆí˜¸
  "type": str              # "phone" | "url" | "account" | "email"
}
```

**ì¶œë ¥**:
```python
{
  "has_reported": bool,     # DB ì‹ ê³  ì´ë ¥ ì—¬ë¶€
  "sources": List[str],     # ["TheCheat", "KISA", "Police"]
  "reported_date": str,     # "2024-11-15"
  "report_count": int,      # 342 (ëˆ„ì  ì‹ ê³  ê±´ìˆ˜)
  "prior_probability": float,  # 0.95 (ì‚¬ê¸° ì‚¬ì „ í™•ë¥ )
  "details": Dict           # ê° ì†ŒìŠ¤ë³„ ìƒì„¸ ì •ë³´
}
```

**êµ¬í˜„ ìƒì„¸**:

#### 1. TheCheat API (ì „í™”ë²ˆí˜¸/ê³„ì¢Œë²ˆí˜¸)
```python
# agent/core/thecheat_api.py
from thecheat_api import TheCheatClient

client = TheCheatClient(api_key=os.getenv("THECHEAT_API_KEY"))

# ì „í™”ë²ˆí˜¸ ì¡°íšŒ
result = client.search_phone("010-1234-5678")
# {
#   "is_reported": True,
#   "keyword": "01012345678",
#   "reported_date": "2024-11-15",
#   "details": "ê°€ì¡± ì‚¬ì¹­ í”¼ì‹±",
#   "caution": "Y",
#   "source": "TheCheat"
# }

# ê³„ì¢Œë²ˆí˜¸ ì¡°íšŒ
result = client.search_account("110-123-456789", bank_code="004")
```

**API ë¬¸ì„œ**: https://apidocs.thecheat.co.kr/docs/api-usage/api-common

#### 2. KISA í”¼ì‹±ì‚¬ì´íŠ¸ API (URL)
```python
# agent/core/kisa_phishing_api.py
from kisa_phishing_api import KISAPhishingCache

cache = KISAPhishingCache()
result = cache.is_phishing("http://phishing-site.com")
# {
#   "url": "http://phishing-site.com",
#   "reported_date": "2024-12-01"
# }
```

**íŠ¹ì§•**:
- 27,582ê°œ í”¼ì‹±ì‚¬ì´íŠ¸ DB (2024-12 ê¸°ì¤€)
- ë¡œì»¬ ìºì‹œ (24ì‹œê°„ TTL)
- O(1) ë„ë©”ì¸ ê²€ìƒ‰ ì„±ëŠ¥

**API ë¬¸ì„œ**: https://www.data.go.kr/data/15109780

#### 3. ê²½ì°°ì²­ ì‚¬ì´ë²„ë²”ì£„ ì‹ ê³ ì‹œìŠ¤í…œ (MCP)
```python
# api/fraud_mcp_server.py (FastMCP)
@mcp.tool()
def check_police_db(search_type: str, value: str) -> str:
    """
    ê²½ì°°ì²­ ì‚¬ì´ë²„ë²”ì£„ ì‹ ê³ ì‹œìŠ¤í…œ ì¡°íšŒ

    Args:
        search_type: "phone", "account", "email"
        value: ì¡°íšŒí•  ê°’

    Returns:
        "Police DB: No reports found (Clean)."
        "Police DB: REPORTED! Caution required."
    """
    url = "https://www.police.go.kr/user/search/ND_searchResult.do"
    # ... êµ¬í˜„ ìƒì„¸ ìƒëµ
```

**ì¶œì²˜**: https://www.police.go.kr/www/security/cyber/cyber04.jsp

#### 4. í”¼ì‹± ì „í™”ë²ˆí˜¸ ì¡°íšŒ (MCP)
```python
@mcp.tool()
def check_counterscam(phone_number: str) -> str:
    """
    CounterScam 112 í”¼ì‹± ì „í™”ë²ˆí˜¸ ì¡°íšŒ

    Returns:
        "CounterScam: No reports found (Clean)."
        "CounterScam: Potential match found."
    """
    url = "https://www.counterscam112.go.kr/phishing/searchPhone.do"
    # ... êµ¬í˜„ ìƒì„¸ ìƒëµ
```

**ì¶œì²˜**: https://www.counterscam112.go.kr/phishing/searchPhone.do

#### 5. Google Safe Browsing API (URL)
```python
@mcp.tool()
def check_google_safe_browsing(url: str) -> str:
    """
    Google Safe Browsing APIë¡œ URL ê²€ì‚¬

    í™˜ê²½ë³€ìˆ˜: GOOGLE_API_KEY

    Returns:
        "Google Safe Browsing: No threats found (Clean)."
        "Google Safe Browsing: WARNING! Threats detected: MALWARE, SOCIAL_ENGINEERING"
    """
```

**API ë¬¸ì„œ**: https://lrl.kr/bbs/board.php?bo_table=docs&wr_id=27

#### 6. VirusTotal API (URL)
```python
@mcp.tool()
def check_virustotal(url: str) -> str:
    """
    VirusTotal APIë¡œ URL ê²€ì‚¬

    í™˜ê²½ë³€ìˆ˜: VIRUSTOTAL_API_KEY

    Returns:
        "VirusTotal: WARNING! 12/67 engines detected this URL as malicious."
        "VirusTotal: Clean. 0/67 engines detected this URL."
    """
```

**API ë¬¸ì„œ**: https://docs.virustotal.com/v2.0/reference/getting-started

**í†µí•© ì¡°íšŒ ë¡œì§**:
```python
def query_all_sources(identifier: str, type: str) -> Dict:
    """
    ëª¨ë“  DB ì†ŒìŠ¤ë¥¼ ë³‘ë ¬ ì¡°íšŒí•˜ì—¬ í†µí•© ê²°ê³¼ ë°˜í™˜
    """
    results = []

    if type == "phone":
        # TheCheat + ê²½ì°°ì²­ + CounterScam ë³‘ë ¬ ì¡°íšŒ
        results.extend([
            check_phone_thecheat(identifier),
            check_police_db("phone", identifier),
            check_counterscam(identifier)
        ])
    elif type == "url":
        # KISA + Google + VirusTotal ë³‘ë ¬ ì¡°íšŒ
        results.extend([
            check_url_kisa(identifier),
            check_google_safe_browsing(identifier),
            check_virustotal(identifier)
        ])
    elif type == "account":
        # TheCheat + ê²½ì°°ì²­ ì¡°íšŒ
        results.extend([
            check_account_thecheat(identifier),
            check_police_db("account", identifier)
        ])

    # í†µí•© ê²°ê³¼ ìƒì„±
    has_reported = any(r.get("is_reported") for r in results if r)
    sources = [r.get("source") for r in results if r and r.get("is_reported")]

    return {
        "has_reported": has_reported,
        "sources": sources,
        "prior_probability": calculate_prior(results)
    }
```

**Prior í™•ë¥  ê³„ì‚°**:
```python
def calculate_prior(results: List[Dict]) -> float:
    """
    ì—¬ëŸ¬ DB ê²°ê³¼ë¥¼ ì¢…í•©í•˜ì—¬ ì‚¬ì „ í™•ë¥  ê³„ì‚°

    ê°€ì¤‘ì¹˜:
    - ê³µì‹ ê¸°ê´€ (ê²½ì°°ì²­, KISA): 0.95
    - TheCheat (ì‹ ê³  ê±´ìˆ˜ ê¸°ë°˜): 0.7~0.9
    - Google/VirusTotal: 0.8
    """
    if not any(results):
        return 0.0

    # ì†ŒìŠ¤ë³„ ê°€ì¤‘ì¹˜ ì ìš©
    weighted_sum = 0
    weights_total = 0

    for result in results:
        if not result or not result.get("is_reported"):
            continue

        source = result.get("source")
        if source in ["Police", "KISA"]:
            weight = 0.95
        elif source == "TheCheat":
            # ì‹ ê³  ê±´ìˆ˜ ê¸°ë°˜
            count = result.get("report_count", 1)
            weight = min(0.7 + (count / 1000), 0.95)
        else:
            weight = 0.8

        weighted_sum += weight
        weights_total += 1

    return weighted_sum / weights_total if weights_total > 0 else 0.0
```

**ì˜ˆì‹œ**:
```python
# ì…ë ¥
identifier = "010-1234-5678"
type = "phone"

# ì¶œë ¥
{
  "has_reported": True,
  "sources": ["TheCheat", "Police", "CounterScam"],
  "reported_date": "2024-11-15",
  "report_count": 342,
  "prior_probability": 0.88,  # (0.85 + 0.95 + 0.85) / 3
  "details": {
    "TheCheat": {"caution": "Y", "details": "ê°€ì¡± ì‚¬ì¹­ í”¼ì‹±"},
    "Police": {"result": "REPORTED"},
    "CounterScam": {"result": "Potential match"}
  }
}
```

---

### 3.3 social_graph_mcp

**ëª©ì **: ë°œì‹ ì ì‹ ë¢°ë„ ë¶„ì„ (MITRE T1199 ê¸°ë°˜)

**ì…ë ¥**:
```python
{
  "sender_id": str,         # "010-1234-5678"
  "user_id": str,           # "user_123"
  "conversation_history": List[Dict]  # ì „ì²´ ëŒ€í™” ì´ë ¥
}
```

**ì¶œë ¥**:
```python
{
  "trust_level": str,       # "high" | "medium" | "low"
  "conversation_days": int, # 30 (1ê°œì›”)
  "message_count": int,     # 156
  "daily_topics": List[str],  # ["ì¼ìƒ", "ê°€ì¡±", "ì•ˆë¶€"]
  "tone_consistency": float,  # 0.95 (95% ì¼ê´€ì„±)
  "sudden_request": bool,   # true (ê°‘ì‘ìŠ¤ëŸ¬ìš´ ê¸ˆì „ ìš”êµ¬)
  "trust_score": float      # 0.0 ~ 1.0
}
```

**ë‚´ë¶€ ë¡œì§** (ë‹¤ì°¨ì› ì‹ ë¢°ë„ ê³„ì‚°):

```python
def _calculate_trust_score(self, conversation_history: List[Dict]) -> Dict:
    """
    1ê°œì›” ì´ë ¥ì˜ í•œê³„ë¥¼ ë³´ì™„í•˜ëŠ” ë‹¤ì°¨ì› ì‹ ë¢°ë„ ê³„ì‚°
    """
    # 1. ëŒ€í™” ê¸°ê°„ (30ì¼ ë‚´)
    days_active = (last_message_date - first_message_date).days
    period_score = min(days_active / 30, 1.0)  # 30ì¼ = 1.0

    # 2. ëŒ€í™” ë¹ˆë„ (ì§§ì€ ê¸°ê°„ì´ë¼ë„ ê³ ë¹ˆë„ë©´ ì‹ ë¢°)
    message_count = len(conversation_history)
    frequency_score = min(message_count / 20, 1.0)  # 20ê±´ ì´ìƒ = 1.0

    # 3. ëŒ€í™” ë‚´ìš© ì¼ê´€ì„± (ì´ë¦„, í˜¸ì¹­ ë“±)
    consistency_score = self._check_name_consistency(conversation_history)

    # 4. ì „í™”ë²ˆí˜¸ ë³€ê²½ ì´ë ¥
    phone_change_penalty = 0.3 if self._detect_phone_change(conversation_history) else 0

    # ì¢…í•© ì‹ ë¢°ë„
    trust_score = (
        period_score * 0.3 +      # ê¸°ê°„: 30ì¼ = 1.0
        frequency_score * 0.4 +    # ë¹ˆë„: 20ê±´ = 1.0
        consistency_score * 0.3 -  # ì¼ê´€ì„±: 0~1.0
        phone_change_penalty       # íŒ¨ë„í‹°
    )

    return {
        "trust_score": round(trust_score, 2),
        "period_days": days_active,
        "message_count": message_count,
        "consistency": consistency_score,
        "phone_changed": phone_change_penalty > 0
    }
```

**ì˜ˆì‹œ**:
```python
# ì…ë ¥
sender_id = "010-1234-5678"
conversation_history = [... 25ê°œ ë©”ì‹œì§€, 30ì¼ê°„ ...]

# ì¶œë ¥
{
  "trust_level": "high",
  "conversation_days": 30,
  "message_count": 25,
  "daily_topics": ["ì¼ìƒ", "ê°€ì¡±", "ì•ˆë¶€"],
  "tone_consistency": 0.95,
  "sudden_request": true,
  "trust_score": 0.82  # 30ì¼*0.3 + 25ê±´*0.4 + 0.95*0.3 = 0.82
}
```

---

### 3.4 entity_extractor_mcp

**ëª©ì **: ë©”ì‹œì§€ì—ì„œ ì‹ë³„ì ì¶”ì¶œ

**ì…ë ¥**:
```python
{
  "message": str            # ë¶„ì„ ëŒ€ìƒ ë©”ì‹œì§€
}
```

**ì¶œë ¥**:
```python
{
  "phone_numbers": List[str],   # ["010-1234-5678"]
  "urls": List[str],            # ["bit.ly/xxx"]
  "accounts": List[str],        # ["110-123-456789"]
  "emails": List[str]           # ["scam@fake.com"]
}
```

**ë‚´ë¶€ ë¡œì§**: ì •ê·œì‹ ê¸°ë°˜ ì¶”ì¶œ
- Phone: `r'01[0-9]-?\d{3,4}-?\d{4}'`
- URL: `r'(http[s]?://|bit\.ly/|han\.gl/)[^\s]+'`
- Account: `r'\d{3,4}-\d{2,6}-\d{4,8}'`
- Email: `r'[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}'`

**ì˜ˆì‹œ**:
```python
# ì…ë ¥
message = "ë‚˜ í° ê³ ì¥ë‚˜ì„œ ë²ˆí˜¸ ë°”ë€Œì—ˆì–´ 010-1234-5678. ê³„ì¢Œë²ˆí˜¸ë„ 110-123-456789ë¡œ ë°”ë€œ"

# ì¶œë ¥
{
  "phone_numbers": ["010-1234-5678"],
  "urls": [],
  "accounts": ["110-123-456789"],
  "emails": []
}
```

---

### 3.5 bayesian_calculator_mcp

**ëª©ì **: ë² ì´ì¦ˆ ì •ë¦¬ë¡œ ì‚¬í›„ í™•ë¥  ê³„ì‚°

**ì…ë ¥**:
```python
{
  "pattern_conf": float,     # 0.92 (A-1 íŒ¨í„´)
  "db_prior": float,         # 0.95 (DB ì‹ ê³ )
  "trust_score": float,      # 0.85 (1ê°œì›” ì´ë ¥)
  "account_mismatch": bool,  # ê³„ì¢Œ ë¶ˆì¼ì¹˜ ì—¬ë¶€
  "weights": List[float]     # [0.4, 0.3, 0.3]
}
```

**ì¶œë ¥**:
```python
{
  "posterior_probability": float,  # 0.29 (ìµœì¢… ì‚¬ê¸° í™•ë¥ )
  "confidence_interval": Tuple[float, float],  # (0.21, 0.37)
  "uncertainty": float,      # 0.08
  "final_risk": str,         # "HIGH" | "MEDIUM" | "LOW"
  "formula": str             # ìˆ˜ì‹ ê³µê°œ
}
```

**ë‚´ë¶€ ë¡œì§** (Bayesian Inference):
```python
# 1. Prior (ì‚¬ì „ í™•ë¥ )
P_fraud_base = 0.003  # ëŒ€í•œë¯¼êµ­ ì „ì²´ ë©”ì‹œì§€ ì¤‘ í”¼ì‹± 0.3%

if db_prior > 0.8:
    P_fraud = 0.85  # ì‹ ê³  ì´ë ¥ ìˆìœ¼ë©´ 85%
elif db_prior > 0.5:
    P_fraud = 0.50
else:
    P_fraud = P_fraud_base

# 2. Likelihood P(Evidence|Fraud) - "í”¼ì‹±ì´ë¼ë©´ ì´ëŸ° ì¦ê±°ê°€ ë‚˜ì˜¬ í™•ë¥ "
if pattern_conf > 0.7 and account_mismatch and trust_score < 0.5:
    P_evidence_given_fraud = 0.95
elif pattern_conf > 0.7 and trust_score < 0.5:
    P_evidence_given_fraud = 0.85
else:
    P_evidence_given_fraud = 0.70

# 3. Likelihood P(Evidence|Not Fraud) - "ì •ìƒì´ë¼ë©´ ì´ëŸ° ì¦ê±°ê°€ ë‚˜ì˜¬ í™•ë¥ "
if account_mismatch:
    P_evidence_given_not_fraud = 0.15
else:
    P_evidence_given_not_fraud = 0.40

# 4. Posterior ê³„ì‚° (Bayes' Theorem)
numerator = P_evidence_given_fraud * P_fraud
denominator = (
    P_evidence_given_fraud * P_fraud +
    P_evidence_given_not_fraud * (1 - P_fraud)
)
P_fraud_given_evidence = numerator / denominator

# 5. ì‹ ë¢°ë„ ì¡°ì • (1ê°œì›” ì´ë ¥ì´ ë†’ìœ¼ë©´ í™•ë¥  í•˜í–¥)
if trust_score > 0.8:
    adjustment_factor = 0.3  # 70% í• ì¸
    P_fraud_given_evidence *= adjustment_factor
elif trust_score > 0.6:
    adjustment_factor = 0.5  # 50% í• ì¸
    P_fraud_given_evidence *= adjustment_factor

# 6. Temperature Scaling (ë¶ˆí™•ì‹¤ì„± ì •ëŸ‰í™”)
uncertainty = 0.08
confidence_interval = (
    max(0.0, P_fraud_given_evidence - uncertainty),
    min(1.0, P_fraud_given_evidence + uncertainty)
)

# 7. ìœ„í—˜ë„ ë ˆë²¨ ë§¤í•‘
if P_fraud_given_evidence >= 0.8:
    final_risk = "CRITICAL"
elif P_fraud_given_evidence >= 0.6:
    final_risk = "HIGH"
elif P_fraud_given_evidence >= 0.4:
    final_risk = "MEDIUM"
elif P_fraud_given_evidence >= 0.2:
    final_risk = "LOW"
else:
    final_risk = "SAFE"
```

**ì˜ˆì‹œ**:
```python
# ì…ë ¥
pattern_conf = 0.92
db_prior = 0.77
trust_score = 0.85
account_mismatch = False

# ì¶œë ¥
{
  "posterior_probability": 0.29,  # ë§¥ë½ ê³ ë ¤ ì‹œ ë‚®ì•„ì§
  "prior": 0.85,
  "likelihood_fraud": 0.70,
  "likelihood_not_fraud": 0.40,
  "trust_adjustment": 0.3,  # 70% í• ì¸
  "confidence_interval": (0.21, 0.37),
  "uncertainty": 0.08,
  "final_risk": "HIGH",
  "formula": "P(Fraud|Evidence) = P(Evidence|Fraud=0.70) Ã— P(Fraud=0.85) / P(Evidence) = 0.290"
}
```

---

### 3.6 scam_case_rag_mcp (ì„ íƒ)

**ëª©ì **: ìœ ì‚¬ ê³¼ê±° ì‚¬ë¡€ ê²€ìƒ‰ (Vector DB)

**ì…ë ¥**:
```python
{
  "query": str,              # "ë²ˆí˜¸ ë³€ê²½ + 1ê°œì›” ëŒ€í™” ì´ë ¥"
  "category": str,           # "A-1"
  "top_k": int               # 5
}
```

**ì¶œë ¥**:
```python
{
  "similar_cases": List[Dict],  # ìœ ì‚¬ ì‚¬ë¡€ ë¦¬ìŠ¤íŠ¸
  "normal_ratio": float,        # 0.6 (ì •ìƒ ë¹„ìœ¨)
  "fraud_ratio": float          # 0.4 (ì‚¬ê¸° ë¹„ìœ¨)
}
```

**ë‚´ë¶€ ë¡œì§**:
- Vector DB: ChromaDB or FAISS
- Embedding: Sentence-BERT
- ê²€ìƒ‰: Cosine Similarity Top-K

**êµ¬í˜„ ìƒíƒœ**: **ì„ íƒì‚¬í•­** (ë³µì¡ë„ ë†’ìŒ, ë°ì´í„° ë¶€ì¡±)

---

## 4. AI ììœ¨ì„± ì¦ëª… (í•µì‹¬ ì°¨ë³„ì )

### 5.1 ê¶Œì¥ ë„êµ¬ ìˆœì„œ (Recommended Order)

**â­ï¸ í•µì‹¬**: ì´ê²ƒì€ **ê¶Œì¥ ìˆœì„œ**ì´ë©°, AIê°€ ë§¥ë½ì— ë”°ë¼ **ìœ ì—°í•˜ê²Œ ì¡°ì • ê°€ëŠ¥**

**ê°€ì¡± ì‚¬ì¹­ íŒ¨í„´ (A-1, A-2) ê°ì§€ ì‹œ**:
```
ê¶Œì¥ ìˆœì„œ:
1. social_graph_mcp (ëŒ€í™” ì´ë ¥ ìˆì„ ë•Œ ê´€ê³„ í™•ì¸ ìš°ì„ )
2. entity_extractor_mcp (ê³„ì¢Œ/ë²ˆí˜¸ ì¶”ì¶œ)
3. threat_intelligence_mcp (DB ê²€ì¦)

âš ï¸ ìœ ì—°í•œ ì¡°ì • í—ˆìš©:
- ëŒ€í™” ì´ë ¥ ì—†ìœ¼ë©´ â†’ social_graph ìƒëµ, threat_intelligence ìš°ì„ 
- ê¸´ê¸‰ì„± ë†’ìœ¼ë©´ â†’ entity_extractor ë¨¼ì € ì‹¤í–‰
```

**ê¸´ê¸‰ì„± ì‚¬ê¸° íŒ¨í„´ (B-1, B-2) ê°ì§€ ì‹œ**:
```
ê¶Œì¥ ìˆœì„œ:
1. context_analyzer_mcp (ê¸´ê¸‰ì„± íŒ¨í„´ ë¶„ì„)
2. entity_extractor_mcp (ê³„ì¢Œ/URL ì¶”ì¶œ)
3. threat_intelligence_mcp (DB ê²€ì¦)

âš ï¸ ìœ ì—°í•œ ì¡°ì • í—ˆìš©:
- URL ëª…í™•í•˜ë©´ â†’ threat_intelligence ë¨¼ì € ì‹¤í–‰
- íŒ¨í„´ ë¶ˆëª…í™•í•˜ë©´ â†’ context_analyzer ì¬ì‹¤í–‰
```

**ê¸°ë³¸ íë¦„** (ì°¸ê³ ìš©):
```
Cycle 1: context_analyzer_mcp (íŒ¨í„´ ë¶„ë¥˜)
Cycle 2: threat_intelligence_mcp (DB ì¡°íšŒ, í•„ìš”ì‹œë§Œ)
Cycle 3: social_graph_mcp (ê´€ê³„ ë¶„ì„, í•„ìš”ì‹œë§Œ)
Final: bayesian_calculator_mcp (ì¢…í•© íŒë‹¨)
```

### 4.2 System Prompt ê°€ì´ë“œë¼ì¸

```python
HYBRID_AGENT_PROMPT = """
ë‹¹ì‹ ì€ Hybrid Intelligent Agentì…ë‹ˆë‹¤.
ìµœì‹  ì‚¬ê¸° íƒì§€ ì—°êµ¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìœ„í—˜ë„ë¥¼ íŒë‹¨í•©ë‹ˆë‹¤.

## ë„êµ¬ ì‚¬ìš© ì „ëµ

**ê¶Œì¥ ìˆœì„œ ì œì‹œ** (ê°•ì œ ì•„ë‹˜, ë§¥ë½ì— ë”°ë¼ ì¡°ì • ê°€ëŠ¥):

ê°€ì¡± ì‚¬ì¹­ (A-1, A-2) ê°ì§€ ì‹œ:
1. social_graph_mcp (ëŒ€í™” ì´ë ¥ ìˆì„ ë•Œ ìš°ì„ )
2. entity_extractor_mcp (ê³„ì¢Œ/ë²ˆí˜¸ ì¶”ì¶œ)
3. threat_intelligence_mcp (DB ê²€ì¦)

ê¸´ê¸‰ì„± ì‚¬ê¸° (B-1, B-2) ê°ì§€ ì‹œ:
1. context_analyzer_mcp (ê¸´ê¸‰ì„± íŒ¨í„´ ë¶„ì„)
2. entity_extractor_mcp (ê³„ì¢Œ/URL ì¶”ì¶œ)
3. threat_intelligence_mcp (DB ê²€ì¦)

âš ï¸ ìœ ì—°í•œ ì¡°ì • í—ˆìš©:
- ëŒ€í™” ì´ë ¥ ì—†ìœ¼ë©´ â†’ social_graph ìƒëµ, threat_intelligence ìš°ì„ 
- ê¸´ê¸‰ì„± ë†’ìœ¼ë©´ â†’ entity_extractor ë¨¼ì € ì‹¤í–‰
- ë„êµ¬ ì‹¤íŒ¨ ì‹œ â†’ ëŒ€ì•ˆ ë„êµ¬ ìë™ ì„ íƒ

## í•µì‹¬ ì›ì¹™

### ë§¥ë½ ìš°ì„  (Context First)
- 1ê°œì›” ëŒ€í™” ì´ë ¥ > DB ì‹ ê³  1ê±´
- í‰ì†Œ í†¤ ì¼ê´€ì„± > íŒ¨í„´ ë§¤ì¹­
- ì˜ˆ: DB ì‹ ê³  + 1ê°œì›” ê°€ì¡± â†’ "ë²ˆí˜¸ ì¬í™œìš©" ì¶”ë¡ 

### ë¹„íŒì  ì‚¬ê³  (Critical Thinking)
- DB ì‹ ê³  = ì‚¬ì „ í™•ë¥ , ì ˆëŒ€ ì§„ë¦¬ ì•„ë‹˜
- ëŒ€í™” ì´ë ¥ = ì¦ê±°ë¡œ ì‚¬í›„ í™•ë¥  ì¬ê³„ì‚°

### ë³´ìˆ˜ì  íŒë‹¨ (Conservative)
- confidence < 0.7 â†’ MEDIUM (ì‚¬ìš©ì í™•ì¸)
- ë¶ˆí™•ì‹¤ì„± ë†’ìŒ â†’ ì°¨ë‹¨ë³´ë‹¤ ê²½ê³ 
"""
```

### 4.3 ì‹¤ì œ AI íŒë‹¨ ì˜ˆì‹œ (AI ììœ¨ì„± ì¦ëª…)

**ë™ì¼ ë©”ì‹œì§€**: "ì—„ë§ˆ, ë‚˜ í° ê³ ì¥ë‚˜ì„œ ë²ˆí˜¸ ë°”ë€Œì—ˆì–´ 010-1234-5678. ê¸‰í•˜ê²Œ ì¸ì¦ ì¢€ í•´ì¤˜"

#### ì¼€ì´ìŠ¤ A: 1ê°œì›” ì´ë ¥ ì¡´ì¬

**ì»¨í…ìŠ¤íŠ¸**:
- ë°œì‹ ì: 010-1234-5678 (ìƒˆ ë²ˆí˜¸)
- ëŒ€í™” ì´ë ¥: 1ê°œì›”, 25ê±´ ë©”ì‹œì§€, ì¼ìƒ ì£¼ì œ 95%

**AI ì„ íƒ ìˆœì„œ**:
```
Cycle 1: context_analyzer_mcp (A-1 íŒ¨í„´ íƒì§€)
Cycle 2: social_graph_mcp (ê´€ê³„ í™•ì¸ ìš°ì„ ) â† AI ì„ íƒ ì´ìœ : ëŒ€í™” ì´ë ¥ ìˆìŒ
Cycle 3: entity_extractor_mcp (ê³„ì¢Œ/ë²ˆí˜¸ ì¶”ì¶œ)
Cycle 4: threat_intelligence_mcp (DB ê²€ì¦)
â†’ ê²°ê³¼: HIGH (ì‹ ë¢°ë„ ê³ ë ¤)
```

**AI ì„ íƒ ì´ìœ  (Thought)**:
```
"ëŒ€í™” ì´ë ¥ì´ 1ê°œì›”ê°„ ì¡´ì¬í•˜ë¯€ë¡œ, DB ì¡°íšŒë³´ë‹¤ ê´€ê³„ ë¶„ì„ì„ ë¨¼ì € ì‹¤í–‰.
1ê°œì›” ì´ë ¥ì´ ìˆë‹¤ë©´ ë²ˆí˜¸ ì¬í™œìš© ë˜ëŠ” ì‹¤ì œ ê°€ì¡±ì˜ ë²ˆí˜¸ ë³€ê²½ ê°€ëŠ¥ì„± ìˆìŒ.
social_graph_mcpë¡œ ì‹ ë¢°ë„ë¥¼ ë¨¼ì € í™•ì¸ í›„, DB ì‹ ê³  ì´ë ¥ì„ ë‚˜ì¤‘ì— ê²€ì¦."
```

#### ì¼€ì´ìŠ¤ B: ì‹ ê·œ ì—°ë½ (ëŒ€í™” ì´ë ¥ ì—†ìŒ)

**ì»¨í…ìŠ¤íŠ¸**:
- ë°œì‹ ì: 010-1234-5678 (ìƒˆ ë²ˆí˜¸)
- ëŒ€í™” ì´ë ¥: **ì—†ìŒ**

**AI ì„ íƒ ìˆœì„œ**:
```
Cycle 1: context_analyzer_mcp (A-1 íŒ¨í„´ íƒì§€)
Cycle 2: threat_intelligence_mcp (DB ê²€ì¦ ìš°ì„ ) â† AI ì„ íƒ ì´ìœ : ëŒ€í™” ì´ë ¥ ì—†ìŒ
Cycle 3: entity_extractor_mcp (ê³„ì¢Œ/ë²ˆí˜¸ ì¶”ì¶œ)
â†’ ê²°ê³¼: CRITICAL (ì‹ ë¢°ë„ ë‚®ìŒ)
```

**AI ì„ íƒ ì´ìœ  (Thought)**:
```
"ëŒ€í™” ì´ë ¥ì´ ì—†ìœ¼ë¯€ë¡œ social_graph_mcpëŠ” ì˜ë¯¸ ì—†ìŒ.
DB ì‹ ê³  ì´ë ¥ì„ ìš°ì„  í™•ì¸í•˜ì—¬ ë¹ ë¥´ê²Œ íŒë‹¨.
ì‹ ê·œ ì—°ë½ + DB ì‹ ê³  ìˆìœ¼ë©´ ì „í˜•ì ì¸ í”¼ì‹± íŒ¨í„´ìœ¼ë¡œ ì¦‰ì‹œ CRITICAL íŒì •."
```

#### ì¦ëª… ìš”ì•½

**ì¦ê±°**:
- **ë™ì¼í•œ ë©”ì‹œì§€**: "ì—„ë§ˆ, ë‚˜ í° ê³ ì¥ë‚˜ì„œ..."
- **ë‹¤ë¥¸ ë§¥ë½**: ëŒ€í™” ì´ë ¥ ìœ ë¬´
- **ë‹¤ë¥¸ ë„êµ¬ ìˆœì„œ**:
  - ì¼€ì´ìŠ¤ A: social_graph â†’ entity â†’ threat
  - ì¼€ì´ìŠ¤ B: threat â†’ entity (social_graph ìƒëµ)
- **ë‹¤ë¥¸ ê²°ê³¼**:
  - ì¼€ì´ìŠ¤ A: HIGH (ë§¥ë½ ê³ ë ¤)
  - ì¼€ì´ìŠ¤ B: CRITICAL (ë§¥ë½ ì—†ìŒ)

**ê²°ë¡ **: AIê°€ **ë§¥ë½ì„ ë³´ê³  ìŠ¤ìŠ¤ë¡œ ë„êµ¬ ìˆœì„œë¥¼ ì¡°ì •** â†’ **ê³µì‹ì´ ì•„ë‹Œ AI íŒë‹¨** âœ…

---

## 5. ì‹¤ì œ ë™ì‘ ì˜ˆì œ (3ê°€ì§€ ì‹œë‚˜ë¦¬ì˜¤)

### 5.1 ì‹œë‚˜ë¦¬ì˜¤ 1: ê°€ì¡± ì‚¬ì¹­ + DB ì‹ ê³  + 1ê°œì›” ì´ë ¥

**ë©”ì‹œì§€**: "ì—„ë§ˆ, ë‚˜ í° ê³ ì¥ë‚˜ì„œ ë²ˆí˜¸ ë°”ë€Œì—ˆì–´ 010-1234-5678. ê¸‰í•˜ê²Œ ì¸ì¦ ì¢€ í•´ì¤˜"

**ì»¨í…ìŠ¤íŠ¸**:
- ë°œì‹ ì: 010-1234-5678 (ìƒˆ ë²ˆí˜¸)
- ê¸°ì¡´ ëŒ€í™”: 1ê°œì›”, 25ê°œ ë©”ì‹œì§€, ì¼ìƒ ì£¼ì œ 95%

---

#### Cycle 1: íŒ¨í„´ ë¶„ì„

**Thought**:
```
"ë©”ì‹œì§€ì—ì„œ ê°€ì¡± í˜¸ì¹­('ì—„ë§ˆ') + ê¸´ê¸‰ì„±('ê¸‰í•˜ê²Œ') + ë²ˆí˜¸ ë³€ê²½ íŒ¨í„´ ë°œê²¬.
MECE ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜ í•„ìš”."
```

**Action**: `context_analyzer_mcp`

**Action Input**:
```python
{
  "message": "ì—„ë§ˆ, ë‚˜ í° ê³ ì¥ë‚˜ì„œ ë²ˆí˜¸ ë°”ë€Œì—ˆì–´ 010-1234-5678. ê¸‰í•˜ê²Œ ì¸ì¦ ì¢€ í•´ì¤˜",
  "context": ["ìµœê·¼ 10ê°œ ëŒ€í™”"]
}
```

**Observation**:
```python
{
  "category": "A-1",
  "category_name": "ê°€ì¡± ì‚¬ì¹­ (ì•¡ì • íŒŒì†)",
  "confidence": 0.92,
  "cialdini_principle": ["Urgency", "Liking"],
  "reasoning": "ê°€ì¡± í˜¸ì¹­ + ê¸´ê¸‰ì„± ì–¸ì–´ + ë²ˆí˜¸ ë³€ê²½ ìš”ì²­ + ì¸ì¦ ìš”êµ¬"
}
```

---

#### Cycle 2: ê´€ê³„ ë¶„ì„ (AI ììœ¨ ì„ íƒ)

**Thought**:
```
"A-1 íŒ¨í„´ í™•ì¸ë¨. ëŒ€í™” ì´ë ¥ì´ 1ê°œì›”ê°„ ì¡´ì¬í•˜ë¯€ë¡œ,
DB ì¡°íšŒë³´ë‹¤ ê´€ê³„ ë¶„ì„ì„ ë¨¼ì € ì‹¤í–‰í•˜ì—¬ ì‹ ë¢°ë„ í™•ì¸."
```

**Action**: `social_graph_mcp` â† **AIê°€ ê¶Œì¥ ìˆœì„œëŒ€ë¡œ ì„ íƒ**

**Action Input**:
```python
{
  "sender_id": "010-1234-5678",
  "user_id": "user_123",
  "conversation_history": [...]  # 1ê°œì›” ì´ë ¥
}
```

**Observation**:
```python
{
  "trust_level": "high",
  "conversation_days": 30,
  "message_count": 25,
  "daily_topics": ["ì¼ìƒ", "ê°€ì¡±", "ì•ˆë¶€"],
  "tone_consistency": 0.95,
  "sudden_request": true,
  "trust_score": 0.82
}
```

---

#### Cycle 3: DB ì¡°íšŒ

**Thought**:
```
"1ê°œì›” ì´ë ¥ + ì‹ ë¢°ë„ 0.82 í™•ì¸ë¨.
ì´ì œ ìƒˆ ë²ˆí˜¸ 010-1234-5678ì´ DBì— ì‹ ê³  ì´ë ¥ì´ ìˆëŠ”ì§€ í™•ì¸ í•„ìš”."
```

**Action**: `threat_intelligence_mcp`

**Action Input**:
```python
{
  "identifier": "010-1234-5678",
  "type": "phone"
}
```

**Observation**:
```python
{
  "has_reported": true,
  "source": "TheCheat",
  "reported_date": "2024-11-15",
  "report_count": 342,
  "prior_probability": 0.77
}
```

---

#### Cycle 4: Bayesian í†µí•© íŒë‹¨

**Thought**:
```
"A-1 íŒ¨í„´ (0.92) + DB ì‹ ê³  (0.77) + 1ê°œì›” ì´ë ¥ (trust 0.82)
â†’ Bayesian ì‚¬í›„ í™•ë¥  ê³„ì‚° í•„ìš”"
```

**Action**: `bayesian_calculator_mcp`

**Action Input**:
```python
{
  "pattern_conf": 0.92,
  "db_prior": 0.77,
  "trust_score": 0.82,
  "account_mismatch": False,
  "weights": [0.4, 0.3, 0.3]
}
```

**Observation**:
```python
{
  "posterior_probability": 0.29,  # ë§¥ë½ ê³ ë ¤ ì‹œ ë‚®ì•„ì§
  "confidence_interval": (0.21, 0.37),
  "uncertainty": 0.08,
  "final_risk": "HIGH",  # CRITICALì—ì„œ HIGHë¡œ ì¡°ì •
  "formula": "P(Fraud|Evidence) = 0.70 Ã— 0.85 / P(Evidence) = 0.290"
}
```

---

#### ìµœì¢… ì‘ë‹µ (JSON)

```json
{
  "final_risk": "HIGH",
  "category": "A-1",
  "category_name": "ê°€ì¡± ì‚¬ì¹­ (ì•¡ì • íŒŒì†)",
  "confidence": 0.71,
  "posterior_probability": 0.29,
  "reasoning": "ê°€ì¡± ì‚¬ì¹­ íŒ¨í„´(A-1, 92%)ê³¼ DB ì‹ ê³ (342ê±´) ì´ë ¥ì´ ìˆìœ¼ë‚˜, 1ê°œì›”ê°„ 25ê°œ ë©”ì‹œì§€ ëŒ€í™” ì´ë ¥ê³¼ 95% í†¤ ì¼ê´€ì„±ì„ ê³ ë ¤ ì‹œ ë²ˆí˜¸ ì¬í™œìš© ë˜ëŠ” ì‹¤ì œ ê°€ì¡±ì˜ ë²ˆí˜¸ ë³€ê²½ ê°€ëŠ¥ì„± ì¡´ì¬. Bayesian ì‚¬í›„ í™•ë¥  29%ë¡œ ìµœì¢… HIGH íŒì •.",
  "recommended_action": "ìƒˆ ë²ˆí˜¸ 010-1234-5678ë¡œ ì§ì ‘ ì „í™”í•˜ì—¬ ë³¸ì¸ í™•ì¸. í™•ì¸ ì „ê¹Œì§€ ì¸ì¦ë²ˆí˜¸ ì „ë‹¬ ê¸ˆì§€.",
  "cialdini_principle": ["Urgency", "Liking"],
  "decision_process": [
    {
      "cycle": 1,
      "thought": "ê°€ì¡± í˜¸ì¹­ + ê¸´ê¸‰ì„± + ë²ˆí˜¸ ë³€ê²½ íŒ¨í„´",
      "action": "context_analyzer_mcp",
      "observation": {"category": "A-1", "confidence": 0.92}
    },
    {
      "cycle": 2,
      "thought": "ëŒ€í™” ì´ë ¥ ìˆìœ¼ë¯€ë¡œ ê´€ê³„ ë¶„ì„ ìš°ì„ ",
      "action": "social_graph_mcp",
      "observation": {"trust_level": "high", "trust_score": 0.82}
    },
    {
      "cycle": 3,
      "thought": "ìƒˆ ë²ˆí˜¸ DB ì¡°íšŒ",
      "action": "threat_intelligence_mcp",
      "observation": {"has_reported": true, "count": 342}
    },
    {
      "cycle": 4,
      "thought": "Bayesian ì‚¬í›„ í™•ë¥  ê³„ì‚°",
      "action": "bayesian_calculator_mcp",
      "observation": {"posterior": 0.29, "risk": "HIGH"}
    }
  ],
  "warning_details": {
    "do_not": [
      "ì¸ì¦ë²ˆí˜¸ ì „ë‹¬",
      "ì•± ì„¤ì¹˜ ë§í¬ í´ë¦­",
      "ì›ê²© ì œì–´ í—ˆìš©",
      "ê¸ˆì „ ì´ì²´"
    ],
    "must_do": [
      "ìƒˆ ë²ˆí˜¸ë¡œ ì§ì ‘ ì „í™”",
      "ê°€ì¡±ì—ê²Œ 'ë¹„ë°€ ì§ˆë¬¸' í™•ì¸",
      "í™•ì¸ ì „ê¹Œì§€ ëª¨ë“  ìš”ì²­ ê±°ë¶€"
    ]
  }
}
```

---

### 5.2 ì‹œë‚˜ë¦¬ì˜¤ 2: ê¸°ê´€ ì‚¬ì¹­ + ì‹ ê·œ ì—°ë½

**ë©”ì‹œì§€**: "êµ­ì„¸ì²­ì…ë‹ˆë‹¤. ë¯¸ë‚© ì„¸ê¸ˆ ê´€ë ¨ ê¸´ê¸‰ ì¡°ì‚¬ê°€ ìˆìŠµë‹ˆë‹¤. bit.ly/tax-checkì—ì„œ í™•ì¸í•˜ì„¸ìš”."

**ì»¨í…ìŠ¤íŠ¸**:
- ë°œì‹ ì: 010-9999-8888 (ì‹ ê·œ ì—°ë½)
- ëŒ€í™” ì´ë ¥: **ì—†ìŒ**

---

#### Cycle 1: íŒ¨í„´ ë¶„ì„

**Thought**: "ê¸°ê´€ ì´ë¦„ ('êµ­ì„¸ì²­') + ê¸´ê¸‰ì„± ('ê¸´ê¸‰') + URL í¬í•¨. B-2 íŒ¨í„´ ì˜ì‹¬"

**Action**: `context_analyzer_mcp`

**Observation**:
```python
{
  "category": "B-2",
  "category_name": "ê¸°ê´€ ì‚¬ì¹­ (ê±´ê°•/ë²•ë¬´)",
  "confidence": 0.95,
  "cialdini_principle": ["Authority", "Urgency"],
  "reasoning": "ê¸°ê´€ ì‚¬ì¹­ + ê¸´ê¸‰ì„± + ì™¸ë¶€ ë§í¬ ìœ ë„"
}
```

---

#### Cycle 2: DB ì¡°íšŒ (AI ììœ¨ ì„ íƒ)

**Thought**:
```
"ëŒ€í™” ì´ë ¥ì´ ì—†ìœ¼ë¯€ë¡œ social_graphëŠ” ì˜ë¯¸ ì—†ìŒ.
URLì´ ëª…í™•í•˜ë¯€ë¡œ threat_intelligenceë¡œ DB ê²€ì¦ ìš°ì„ ."
```

**Action**: `threat_intelligence_mcp` â† **AIê°€ ë§¥ë½ ë³´ê³  ìˆœì„œ ë³€ê²½**

**Action Input**:
```python
{
  "identifier": "bit.ly/tax-check",
  "type": "url"
}
```

**Observation**:
```python
{
  "has_reported": false,  # DBì— ì•„ì§ ì‹ ê³  ì—†ìŒ
  "source": "None",
  "report_count": 0,
  "prior_probability": 0.003  # ê¸°ë³¸ ì‚¬ê¸° í™•ë¥  0.3%
}
```

---

#### Cycle 3: ì‹ë³„ì ì¶”ì¶œ

**Thought**: "URL ì™¸ì— ì „í™”ë²ˆí˜¸ë‚˜ ê³„ì¢Œë²ˆí˜¸ ì¶”ì¶œ í•„ìš”"

**Action**: `entity_extractor_mcp`

**Observation**:
```python
{
  "phone_numbers": ["010-9999-8888"],
  "urls": ["bit.ly/tax-check"],
  "accounts": [],
  "emails": []
}
```

---

#### Final Decision

**Thought**:
```
"B-2 íŒ¨í„´ (0.95) + DB ì‹ ê³  ì—†ìŒ (0.003) + ëŒ€í™” ì´ë ¥ ì—†ìŒ (trust 0.0)
â†’ DB ì‹ ê³ ëŠ” ì—†ìœ¼ë‚˜ íŒ¨í„´ê³¼ Cialdini ì›ë¦¬ê°€ ëª…í™•
â†’ MEDIUM (ì‚¬ìš©ì í™•ì¸ í•„ìš”)"
```

**Action**: `bayesian_calculator_mcp`

**Observation**:
```python
{
  "posterior_probability": 0.52,
  "final_risk": "MEDIUM",
  "reasoning": "DB ì‹ ê³  ì—†ìœ¼ë‚˜ ì „í˜•ì ì¸ B-2 íŒ¨í„´. URL í™•ì¸ í•„ìš”"
}
```

---

#### ìµœì¢… ì‘ë‹µ

```json
{
  "final_risk": "MEDIUM",
  "category": "B-2",
  "confidence": 0.65,
  "reasoning": "ê¸°ê´€ ì‚¬ì¹­ íŒ¨í„´ ëª…í™•í•˜ë‚˜, DB ì‹ ê³  ì´ë ¥ ì—†ìŒ. ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ë‹¨ì¶• URL í¬í•¨. ì§ì ‘ êµ­ì„¸ì²­ ê³µì‹ ì—°ë½ì²˜ë¡œ í™•ì¸ í•„ìš”.",
  "recommended_action": "ì ˆëŒ€ ë§í¬ í´ë¦­ ê¸ˆì§€. êµ­ì„¸ì²­ ê³µì‹ í™ˆí˜ì´ì§€(hometax.go.kr) ë˜ëŠ” êµ­ë²ˆ ì—†ì´ 126ìœ¼ë¡œ ì§ì ‘ í™•ì¸.",
  "decision_process": [
    {
      "cycle": 1,
      "action": "context_analyzer_mcp",
      "observation": {"category": "B-2", "confidence": 0.95}
    },
    {
      "cycle": 2,
      "thought": "ëŒ€í™” ì´ë ¥ ì—†ìœ¼ë¯€ë¡œ DB ê²€ì¦ ìš°ì„ ",
      "action": "threat_intelligence_mcp",
      "observation": {"has_reported": false, "prior": 0.003}
    },
    {
      "cycle": 3,
      "action": "entity_extractor_mcp",
      "observation": {"urls": ["bit.ly/tax-check"]}
    }
  ]
}
```

---

### 5.3 ì‹œë‚˜ë¦¬ì˜¤ 3: ê³„ì¢Œ ë³€ê²½ ì •ë‹¹ì„± ê²€ì¦

**ë©”ì‹œì§€**: "ì—„ë§ˆ, ë‚˜ í° ê³ ì¥ë‚˜ì„œ ë²ˆí˜¸ ë°”ë€Œì—ˆì–´. ê¸‰í•˜ê²Œ ëˆ í•„ìš”í•œë° ê³„ì¢Œë²ˆí˜¸ë„ ë°”ë€Œì—ˆì–´. 110-234-567890ìœ¼ë¡œ ë³´ë‚´ì¤˜"

**ì»¨í…ìŠ¤íŠ¸**:
- ë°œì‹ ì: 010-9999-8888 (ìƒˆ ë²ˆí˜¸)
- ê¸°ì¡´ ëŒ€í™”: 1ê°œì›”, ëŒ€í™” ì´ë ¥ì—ì„œ ê³¼ê±° ê³„ì¢Œ "110-123-456789" ì–¸ê¸‰ë¨
- ì´ì „ ëŒ€í™”ì— ê³„ì¢Œ ë³€ê²½ ì˜ˆê³  ì—†ìŒ

---

#### Cycle 1-3: íŒ¨í„´ ë¶„ì„, ê´€ê³„ ë¶„ì„, DB ì¡°íšŒ (ìƒëµ)

(ê¸°ë³¸ ë¶„ì„ì€ ì‹œë‚˜ë¦¬ì˜¤ 1ê³¼ ë™ì¼)

---

#### Cycle 4: ê³„ì¢Œ ë³€ê²½ ì •ë‹¹ì„± ê²€ì¦

**Thought**:
```
"ë©”ì‹œì§€ì—ì„œ ê³„ì¢Œë²ˆí˜¸ ë³€ê²½ ìš”ì²­ ë°œê²¬.
ì´ì „ ëŒ€í™” ì´ë ¥ì—ì„œ ê³„ì¢Œ ì •ë³´ ì¶”ì¶œí•˜ì—¬ ì •ë‹¹ì„± ê²€ì¦ í•„ìš”."
```

**Action**: `entity_extractor_mcp` + `_validate_account_change`

**Action Input**:
```python
{
  "old_account": "110-123-456789",  # ì´ì „ ëŒ€í™”ì—ì„œ ì¶”ì¶œ
  "new_account": "110-234-567890",  # í˜„ì¬ ë©”ì‹œì§€
  "conversation_history": [...],
  "days_ago": 7  # ì‚¬ì „ ì˜ˆê³  ê²€ìƒ‰ ë²”ìœ„ (7ì¼)
}
```

**Observation**:
```python
{
  "legitimate_change": False,
  "risk_level": "HIGH",
  "reasoning": "ê°‘ì‘ìŠ¤ëŸ¬ìš´ ê³„ì¢Œ ë³€ê²½, ì‚¬ì „ ì˜ˆê³  ì—†ìŒ, ì€í–‰ ì¼ì¹˜í•˜ë‚˜ ì„¤ëª… ë¶€ì¡±",
  "preannouncement": False,  # 7ì¼ ë‚´ ê³„ì¢Œ ë³€ê²½ ì˜ˆê³  ì—†ìŒ
  "same_bank": True,         # 110 = ì‹ í•œì€í–‰ (ì¼ì¹˜)
  "has_explanation": False,   # ë³€ê²½ ì´ìœ  êµ¬ì²´ì  ì„¤ëª… ì—†ìŒ
  "red_flags": [
    "ì‚¬ì „ ì˜ˆê³  ì—†ëŠ” ê¸‰ê²©í•œ ê³„ì¢Œ ë³€ê²½",
    "ë²ˆí˜¸ ë³€ê²½ê³¼ ë™ì‹œì— ê³„ì¢Œ ë³€ê²½",
    "ê¸´ê¸‰ì„± ê°•ì¡° ('ê¸‰í•˜ê²Œ')"
  ]
}
```

---

#### Cycle 5: ìµœì¢… Bayesian íŒë‹¨

**Thought**:
```
"A-1 íŒ¨í„´ (0.92) + ê³„ì¢Œ ë¶ˆì¼ì¹˜ (account_mismatch=True) + ì‹ ë¢°ë„ (0.75)
â†’ Bayesian ê³„ì‚° ì‹œ account_mismatch ë°˜ì˜"
```

**Action**: `bayesian_calculator_mcp`

**Action Input**:
```python
{
  "pattern_conf": 0.92,
  "db_prior": 0.77,
  "trust_score": 0.75,  # 1ê°œì›” ì´ë ¥ì´ì§€ë§Œ ê³„ì¢Œ ë³€ê²½ìœ¼ë¡œ í•˜ë½
  "account_mismatch": True  # âœ… ê³„ì¢Œ ë¶ˆì¼ì¹˜
}
```

**Observation**:
```python
{
  "posterior_probability": 0.68,  # account_mismatchë¡œ í™•ë¥  ìƒìŠ¹
  "final_risk": "CRITICAL",  # HIGH â†’ CRITICAL ìƒí–¥
  "prior": 0.85,
  "likelihood_fraud": 0.95,  # account_mismatch ë°˜ì˜
  "likelihood_not_fraud": 0.15,
  "trust_adjustment": 0.5
}
```

---

#### ìµœì¢… ì‘ë‹µ

```json
{
  "final_risk": "CRITICAL",
  "category": "A-1",
  "confidence": 0.88,
  "posterior_probability": 0.68,
  "reasoning": "ê°€ì¡± ì‚¬ì¹­ + DB ì‹ ê³  + ê³„ì¢Œ ë¶ˆì¼ì¹˜(ì‚¬ì „ ì˜ˆê³  ì—†ìŒ) â†’ ì „í˜•ì ì¸ í”¼ì‹±",
  "recommended_action": "ì ˆëŒ€ ì†¡ê¸ˆ ê¸ˆì§€. ê¸°ì¡´ ë²ˆí˜¸ë¡œ ì§ì ‘ ì „í™”í•˜ì—¬ ë³¸ì¸ í™•ì¸ í•„ìˆ˜.",
  "critical_factors": [
    "ë²ˆí˜¸ ë³€ê²½ + ê³„ì¢Œ ë³€ê²½ ë™ì‹œ ë°œìƒ",
    "ì‚¬ì „ ì˜ˆê³  ì—†ëŠ” ê¸‰ê²©í•œ ë³€ê²½",
    "ê¸´ê¸‰ì„± ê°•ì¡°ë¡œ íŒë‹¨ ì‹œê°„ ì œí•œ"
  ],
  "warning_details": {
    "do_not": [
      "ì ˆëŒ€ ì†¡ê¸ˆ ê¸ˆì§€",
      "ì¸ì¦ë²ˆí˜¸ ì „ë‹¬ ê¸ˆì§€",
      "ìƒˆ ë²ˆí˜¸ë¡œ ì—°ë½ ê¸ˆì§€"
    ],
    "must_do": [
      "ê¸°ì¡´ ë²ˆí˜¸ë¡œ ì§ì ‘ ì „í™”",
      "ëŒ€ë©´ ë˜ëŠ” ì˜ìƒ í†µí™”ë¡œ ë³¸ì¸ í™•ì¸",
      "ê²½ì°°ì„œ ë°©ë¬¸í•˜ì—¬ ì‹ ê³  ê³ ë ¤"
    ]
  }
}
```

---

## 6. êµ¬í˜„ ìƒì„¸ ì½”ë“œ

### 6.1 KananaAgent í´ë˜ìŠ¤ (250ì¤„ ì „ì²´ ì½”ë“œ)

**íŒŒì¼**: `agent/core/kanana_agent.py`

```python
import json
import re
from typing import Dict, List, Callable, Any, Optional
from dataclasses import dataclass

@dataclass
class AgentResponse:
    """AI ì‘ë‹µ íŒŒì‹± ê²°ê³¼"""
    thought: str
    action: str
    action_input: Dict
    is_final: bool = False
    reasoning: Optional[str] = None
    final_risk: Optional[str] = None

class KananaAgent:
    """
    Hybrid Intelligent Agent

    AI-driven ReAct Loop with Bayesian Inference
    """

    def __init__(
        self,
        model: str = "kanana-instruct-8b",
        system_prompt: str = None,
        tools: List[Callable] = None,
        max_cycles: int = 5
    ):
        self.model = model
        self.system_prompt = system_prompt or HYBRID_AGENT_PROMPT
        self.tools = {tool.__name__: tool for tool in (tools or [])}
        self.max_cycles = max_cycles

    def run(self, message: str, context: Dict) -> Dict:
        """
        ReAct Loop ì‹¤í–‰

        Args:
            message: ë¶„ì„ ëŒ€ìƒ ë©”ì‹œì§€
            context: {
                "sender_id": str,
                "user_id": str,
                "conversation_history": List[Dict]
            }

        Returns:
            {
                "final_risk": "CRITICAL" | "HIGH" | "MEDIUM" | "LOW" | "SAFE",
                "category": "A-1" ~ "C-3" | "NORMAL",
                "confidence": 0.0 ~ 1.0,
                "reasoning": str,
                "recommended_action": str,
                "decision_process": List[Dict]
            }
        """

        messages = [
            {"role": "system", "content": self.system_prompt},
            {"role": "user", "content": self._format_task(message, context)}
        ]

        decision_process = []
        failed_tools = set()  # âœ… ì‹¤íŒ¨í•œ ë„êµ¬ ì¶”ì 

        for cycle in range(self.max_cycles):
            # Step 1: Kanana LLM í˜¸ì¶œ (Thought)
            response = self._call_kanana_llm(messages, failed_tools)
            parsed = self._parse_response(response)

            # Step 2: Final Decision?
            if parsed.is_final:
                return {
                    "final_risk": parsed.final_risk,
                    "category": parsed.action_input.get("category", "UNKNOWN"),
                    "confidence": parsed.action_input.get("confidence", 0.5),
                    "reasoning": parsed.reasoning,
                    "recommended_action": parsed.action_input.get("recommended_action"),
                    "decision_process": decision_process,
                    "cialdini_principle": parsed.action_input.get("cialdini_principle", []),
                    "warning_details": parsed.action_input.get("warning_details")
                }

            # Step 3: Tool Call (Action)
            if parsed.action in self.tools:
                # âœ… ì‹¤íŒ¨í•œ ë„êµ¬ëŠ” ì¬ì‹œë„ ë°©ì§€
                if parsed.action in failed_tools:
                    messages.append({
                        "role": "system",
                        "content": f"âš ï¸ {parsed.action} ì´ì „ ì‚¬ì´í´ì—ì„œ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ëŒ€ì•ˆ: {self._suggest_alternative_tool(parsed.action)['alternative']}"
                    })
                    continue

                try:
                    observation = self.tools[parsed.action](**parsed.action_input)
                except Exception as e:
                    # âœ… ì‹¤íŒ¨ ê¸°ë¡
                    failed_tools.add(parsed.action)
                    alternative = self._suggest_alternative_tool(parsed.action)

                    observation = {
                        "error": str(e),
                        "alternative_tool": alternative["alternative"],
                        "reasoning": alternative["reasoning"],
                        "adjustment": alternative["adjustment"]
                    }

                    messages.append({
                        "role": "system",
                        "content": (
                            f"âŒ {parsed.action} ì‹¤íŒ¨: {e}\n"
                            f"ğŸ’¡ ëŒ€ì•ˆ: {alternative['alternative']}\n"
                            f"ğŸ“Œ ì¡°ì •: {alternative['adjustment']}"
                        )
                    })

                    # âœ… ìµœëŒ€ ì‹¤íŒ¨ í—ˆìš© íšŸìˆ˜ ì²´í¬
                    if len(failed_tools) >= 3:
                        return self._conservative_fallback(
                            f"ë„ˆë¬´ ë§ì€ ë„êµ¬ ì‹¤íŒ¨ ({len(failed_tools)}/3): {', '.join(failed_tools)}"
                        )

                # Step 4: Update conversation (Observation)
                messages.append({
                    "role": "assistant",
                    "content": self._format_cycle(parsed, observation)
                })

                decision_process.append({
                    "cycle": cycle + 1,
                    "thought": parsed.thought,
                    "action": parsed.action,
                    "action_input": parsed.action_input,
                    "observation": observation
                })
            else:
                # ë„êµ¬ ì—†ìŒ â†’ ì˜¤ë¥˜ ì²˜ë¦¬
                return self._conservative_fallback(
                    f"Unknown tool: {parsed.action}"
                )

        # ìµœëŒ€ ì‚¬ì´í´ ë„ë‹¬ â†’ ë³´ìˆ˜ì  íŒë‹¨
        return self._conservative_fallback("Max cycles reached")

    def _format_task(self, message: str, context: Dict) -> str:
        """ì‚¬ìš©ì íƒœìŠ¤í¬ í¬ë§·íŒ…"""
        return f"""
## ë¶„ì„ ëŒ€ìƒ ë©”ì‹œì§€
"{message}"

## ì»¨í…ìŠ¤íŠ¸
- ë°œì‹ ì: {context.get('sender_id', 'Unknown')}
- ì‚¬ìš©ì: {context.get('user_id', 'Unknown')}
- ëŒ€í™” ì´ë ¥: {len(context.get('conversation_history', []))}ê°œ

## íƒœìŠ¤í¬
ìœ„ ë©”ì‹œì§€ì˜ ì‚¬ê¸° ìœ„í—˜ë„ë¥¼ íŒë‹¨í•˜ì‹œì˜¤.
ReAct Patternì„ ì‚¬ìš©í•˜ì—¬ Thought â†’ Action â†’ Observation ë°˜ë³µ.

## ë„êµ¬ ì„ íƒ ì‹œ ê³ ë ¤ì‚¬í•­
- ëŒ€í™” ì´ë ¥ ìˆìœ¼ë©´: social_graph_mcp ìš°ì„  ê³ ë ¤
- ëŒ€í™” ì´ë ¥ ì—†ìœ¼ë©´: threat_intelligence_mcp ìš°ì„  ê³ ë ¤
- AIê°€ ë§¥ë½ì„ ë³´ê³  ììœ¨ì ìœ¼ë¡œ ë„êµ¬ ìˆœì„œ ê²°ì •
"""

    def _call_kanana_llm(self, messages: List[Dict], failed_tools: set) -> str:
        """
        Kanana Instruct 8B í˜¸ì¶œ

        ì‹¤ì œ êµ¬í˜„:
        - FastMCPë¥¼ í†µí•´ Kanana API í˜¸ì¶œ
        - ë˜ëŠ” ë¡œì»¬ Kanana ëª¨ë¸ inference
        """
        # TODO: ì‹¤ì œ Kanana API í˜¸ì¶œ
        # response = kanana_api.chat(messages, model=self.model)
        # return response["content"]

        # Mock ì‘ë‹µ (ê°œë°œìš©)
        return """
[Thought] ë©”ì‹œì§€ì—ì„œ ê°€ì¡± í˜¸ì¹­('ì—„ë§ˆ')ê³¼ ê¸´ê¸‰ì„±('ê¸‰í•˜ê²Œ'), ë²ˆí˜¸ ë³€ê²½ íŒ¨í„´ ë°œê²¬. MECE ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜ í•„ìš”.
[Action] context_analyzer_mcp
[Action Input] {"message": "ì—„ë§ˆ, ë‚˜ í° ê³ ì¥ë‚˜ì„œ...", "context": []}
"""

    def _parse_response(self, response: str) -> AgentResponse:
        """
        AI ì‘ë‹µ íŒŒì‹±

        í˜•ì‹:
        [Thought] ...
        [Action] tool_name
        [Action Input] {...}

        ë˜ëŠ”:
        [Final Decision]
        [Risk] HIGH
        [Reasoning] ...
        """
        thought_match = re.search(r'\[Thought\]\s*(.+)', response)
        action_match = re.search(r'\[Action\]\s*(\w+)', response)
        input_match = re.search(r'\[Action Input\]\s*(\{.+\})', response, re.DOTALL)

        # Final Decision ì²´í¬
        final_match = re.search(r'\[Final Decision\]', response)
        if final_match:
            risk_match = re.search(r'\[Risk\]\s*(\w+)', response)
            reasoning_match = re.search(r'\[Reasoning\]\s*(.+)', response, re.DOTALL)

            return AgentResponse(
                thought="",
                action="FINAL_DECISION",
                action_input=json.loads(input_match.group(1)) if input_match else {},
                is_final=True,
                final_risk=risk_match.group(1) if risk_match else "MEDIUM",
                reasoning=reasoning_match.group(1).strip() if reasoning_match else ""
            )

        # Tool Call
        return AgentResponse(
            thought=thought_match.group(1).strip() if thought_match else "",
            action=action_match.group(1) if action_match else "",
            action_input=json.loads(input_match.group(1)) if input_match else {},
            is_final=False
        )

    def _format_cycle(self, parsed: AgentResponse, observation: Any) -> str:
        """ì‚¬ì´í´ ê²°ê³¼ í¬ë§·íŒ… (Observation)"""
        return f"""
[Thought] {parsed.thought}
[Action] {parsed.action}
[Action Input] {json.dumps(parsed.action_input, ensure_ascii=False)}
[Observation] {json.dumps(observation, ensure_ascii=False)}
"""

    def _conservative_fallback(self, reason: str = "") -> Dict:
        """
        ë³´ìˆ˜ì  íŒë‹¨ (ë¶ˆí™•ì‹¤ì„± ë†’ì„ ë•Œ)

        ì´ë¡ ì  ê·¼ê±°: ì˜ë£Œ/ë³´ì•ˆ ë„ë©”ì¸ ì „í†µ
        """
        return {
            "final_risk": "MEDIUM",
            "category": "UNKNOWN",
            "confidence": 0.5,
            "reasoning": f"ë³µì¡í•œ ì¼€ì´ìŠ¤ ë˜ëŠ” ì˜¤ë¥˜ë¡œ íŒë‹¨ ë¶ˆê°€. {reason}",
            "recommended_action": "ì§ì ‘ í™•ì¸ í•„ìš”",
            "user_action_required": True,
            "decision_process": [],
            "warning_details": {
                "do_not": ["ì¸ì¦ë²ˆí˜¸ ì „ë‹¬", "ê¸ˆì „ ì´ì²´", "ì•± ì„¤ì¹˜", "ì›ê²© ì œì–´"],
                "must_do": ["ì§ì ‘ ì „í™” í™•ì¸", "ê³µì‹ ì—°ë½ì²˜ë¡œ ì¬í™•ì¸"]
            }
        }

    def _suggest_alternative_tool(self, failed_tool: str) -> Dict:
        """ëŒ€ì•ˆ ë„êµ¬ ì œì•ˆ"""
        alternatives = {
            "threat_intelligence_mcp": {
                "alternative": "context_analyzer_mcp",
                "reasoning": "DB ì¡°íšŒ ì‹¤íŒ¨ ì‹œ, íŒ¨í„´ ë§¤ì¹­ ì‹ ë¢°ë„ë¥¼ ì‚¬ì „ í™•ë¥ ë¡œ ì‚¬ìš©",
                "adjustment": "pattern_conf * 0.8 â†’ prior"
            },
            "social_graph_mcp": {
                "alternative": "entity_extractor_mcp + manual_verification",
                "reasoning": "ê´€ê³„ ë¶„ì„ ì‹¤íŒ¨ ì‹œ, ê³„ì¢Œ/ë²ˆí˜¸ ì¶”ì¶œ í›„ ì‚¬ìš©ì ì§ì ‘ í™•ì¸ ê¶Œì¥",
                "adjustment": "trust_score = 0.5 (ì¤‘ë¦½)"
            },
            "bayesian_calculator_mcp": {
                "alternative": "weighted_average_fallback",
                "reasoning": "Bayesian ê³„ì‚° ì‹¤íŒ¨ ì‹œ, SHAP Weightë¡œ ë‹¨ìˆœ í‰ê· ",
                "adjustment": "pattern*0.4 + db*0.3 + trust*0.3"
            },
            "context_analyzer_mcp": {
                "alternative": "entity_extractor_mcp + db_lookup_mcp",
                "reasoning": "íŒ¨í„´ ë¶„ë¥˜ ì‹¤íŒ¨ ì‹œ, ì‹ë³„ì ì¶”ì¶œ í›„ DB ì§ì ‘ ì¡°íšŒ",
                "adjustment": "category = UNKNOWN, confidence = 0.5"
            }
        }

        return alternatives.get(failed_tool, {
            "alternative": "Conservative Fallback",
            "reasoning": "ì•Œ ìˆ˜ ì—†ëŠ” ë„êµ¬ ì‹¤íŒ¨, ì‚¬ìš©ì íŒë‹¨ ìš”ì²­",
            "adjustment": "risk_level = MEDIUM, user_action_required = True"
        })


# System Prompt (ì „ì²´ ê³µê°œ)
HYBRID_AGENT_PROMPT = """
ë‹¹ì‹ ì€ Hybrid Intelligent Agentì…ë‹ˆë‹¤.
ìµœì‹  ì‚¬ê¸° íƒì§€ ì—°êµ¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìœ„í—˜ë„ë¥¼ íŒë‹¨í•©ë‹ˆë‹¤.

## ì´ë¡ ì  ê¸°ë°˜

1. **ReAct Pattern** (Google 2022)
   - Thought â†’ Action â†’ Observation ë°˜ë³µ
   - ê° ë‹¨ê³„ë§ˆë‹¤ ì¶”ë¡  ê·¼ê±° ëª…ì‹œ

2. **Bayesian Inference** (Nature 2025)
   - P(Fraud|Evidence) ì‚¬í›„ í™•ë¥  ê³„ì‚°
   - ë§¥ë½ì— ë”°ë¼ ë™ì  ì¡°ì •

3. **SHAP Weight** (NeurIPS 2017)
   - Pattern (40%), Relationship (30%), Behavior (20%), Synthesis (10%)

4. **Cialdini 6ì›ë¦¬** (ì‹¬ë¦¬í•™)
   - Authority, Urgency, Liking, Scarcity, Reciprocity, Social Proof

## í•µì‹¬ ì›ì¹™

### ë§¥ë½ ìš°ì„  (Context First)
- 1ê°œì›” ëŒ€í™” ì´ë ¥ > DB ì‹ ê³  1ê±´
- í‰ì†Œ í†¤ ì¼ê´€ì„± > íŒ¨í„´ ë§¤ì¹­
- ì˜ˆ: DB ì‹ ê³  + 1ê°œì›” ê°€ì¡± â†’ "ë²ˆí˜¸ ì¬í™œìš©" ì¶”ë¡ 

### ë¹„íŒì  ì‚¬ê³  (Critical Thinking)
- DB ì‹ ê³  = ì‚¬ì „ í™•ë¥ , ì ˆëŒ€ ì§„ë¦¬ ì•„ë‹˜
- ëŒ€í™” ì´ë ¥ = ì¦ê±°ë¡œ ì‚¬í›„ í™•ë¥  ì¬ê³„ì‚°

### ì„¤ëª… ê°€ëŠ¥ì„± (Explainability)
- ëª¨ë“  íŒë‹¨ì— reasoning ì œê³µ
- decision_processë¡œ ì¶”ë¡  ê³¼ì • íˆ¬ëª…í™”

### ë³´ìˆ˜ì  íŒë‹¨ (Conservative)
- confidence < 0.7 â†’ MEDIUM (ì‚¬ìš©ì í™•ì¸)
- ë¶ˆí™•ì‹¤ì„± ë†’ìŒ â†’ ì°¨ë‹¨ë³´ë‹¤ ê²½ê³ 

## ë„êµ¬ ì‚¬ìš© ì „ëµ

**ê¶Œì¥ ìˆœì„œ** (ê°•ì œ ì•„ë‹˜, ìœ ì—°í•œ ì¡°ì • í—ˆìš©):

ê°€ì¡± ì‚¬ì¹­ (A-1, A-2) ê°ì§€ ì‹œ:
1. social_graph_mcp (ëŒ€í™” ì´ë ¥ ìˆì„ ë•Œ ê´€ê³„ í™•ì¸ ìš°ì„ )
2. entity_extractor_mcp (ê³„ì¢Œ/ë²ˆí˜¸ ì¶”ì¶œ)
3. threat_intelligence_mcp (DB ê²€ì¦)

ê¸´ê¸‰ì„± ì‚¬ê¸° (B-1, B-2) ê°ì§€ ì‹œ:
1. context_analyzer_mcp (ê¸´ê¸‰ì„± íŒ¨í„´ ë¶„ì„)
2. entity_extractor_mcp (ê³„ì¢Œ/URL ì¶”ì¶œ)
3. threat_intelligence_mcp (DB ê²€ì¦)

âš ï¸ ìœ ì—°í•œ ì¡°ì • í—ˆìš©:
- ëŒ€í™” ì´ë ¥ ì—†ìœ¼ë©´ â†’ social_graph ìƒëµ, threat_intelligence ìš°ì„ 
- ê¸´ê¸‰ì„± ë†’ìœ¼ë©´ â†’ entity_extractor ë¨¼ì € ì‹¤í–‰
- ë„êµ¬ ì‹¤íŒ¨ ì‹œ â†’ ëŒ€ì•ˆ ë„êµ¬ ìë™ ì„ íƒ

ê¸°ë³¸ íë¦„ (ì°¸ê³ ìš©):
Cycle 1: context_analyzer_mcp (íŒ¨í„´ ë¶„ë¥˜)
Cycle 2: threat_intelligence_mcp (DB ì¡°íšŒ, í•„ìš”ì‹œë§Œ)
Cycle 3: social_graph_mcp (ê´€ê³„ ë¶„ì„, í•„ìš”ì‹œë§Œ)
Final: bayesian_calculator_mcp (ì¢…í•© íŒë‹¨)

## ì¶œë ¥ í˜•ì‹

{
  "thought": "í˜„ì¬ ì‚¬ê³  ê³¼ì •",
  "action": "ë„êµ¬ëª…" or "FINAL_DECISION",
  "action_input": {...},
  "observation": "ë„êµ¬ ê²°ê³¼",
  "reasoning": "ìµœì¢… íŒë‹¨ ê·¼ê±°",
  "final_risk": "CRITICAL" | "HIGH" | "MEDIUM" | "LOW" | "SAFE"
}
"""
```

### 6.1.1 ë™ì  ì¶”ë¡  ë©”ì„œë“œ (Agent íŒë‹¨ ë¡œì§)

**ì¶”ê°€ëœ ë©”ì„œë“œ**: Section 6.3.10ì˜ ë™ì  ì¶”ë¡  ë¡œì§ì„ KananaAgent í´ë˜ìŠ¤ì— í†µí•©

```python
class KananaAgent:
    # ... (ê¸°ì¡´ ì½”ë“œ) ...

    def _calculate_final_risk_with_reasoning(
        self,
        decision_process: List[Dict]
    ) -> Dict:
        """
        ë™ì  ì¶”ë¡  ê¸°ë°˜ ìµœì¢… ìœ„í—˜ë„ ê³„ì‚° (Section 6.3.10 í†µí•©)

        ê¸°ì¡´: ê³ ì • ê°€ì¤‘ì¹˜ë¡œ ë‹¨ìˆœ ê³„ì‚°
        ê°œì„ : ë§¥ë½ ì¸ì‹ â†’ ê°€ì¤‘ì¹˜ ì¡°ì • â†’ ì¶”ë¡  ê¸°ë°˜ íŒì • â†’ XAI ì„¤ëª…
        """
        # Step 1: observationsì—ì„œ í•„ìš”í•œ ê°’ ì¶”ì¶œ
        pattern_conf = self._extract_from_observations(
            decision_process, "context_analyzer", "confidence", 0.5
        )
        db_prior = self._extract_from_observations(
            decision_process, "threat_intelligence", "db_prior", 0.0
        )
        trust_score = self._extract_from_observations(
            decision_process, "social_graph", "trust_score", 0.5
        )

        # Step 1.5: ì¦ê±° í’ˆì§ˆ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ
        evidence_quality = {
            "conversation_period": self._extract_from_observations(
                decision_process, "social_graph", "conversation_days", 0
            ),
            "db_sources": self._extract_from_observations(
                decision_process, "threat_intelligence", "source_count", 0
            ),
            "pattern_match_count": self._extract_from_observations(
                decision_process, "context_analyzer", "matched_patterns", 0
            )
        }

        # Step 2: ë§¥ë½ ê¸°ë°˜ ê°€ì¤‘ì¹˜ ë™ì  ì¡°ì • (Section 6.3.10.1)
        weight_adjustment = self._adjust_weights_by_context(
            pattern_conf, db_prior, trust_score, evidence_quality
        )
        weights = weight_adjustment["weights"]

        # Step 3: ë™ì  ê°€ì¤‘ì¹˜ë¡œ ì‚¬í›„ í™•ë¥  ê³„ì‚°
        posterior = (
            weights["pattern"] * pattern_conf +
            weights["db"] * db_prior +
            weights["trust"] * (1 - trust_score)
        )

        # Step 3.5: ì‹ ë¢° êµ¬ê°„ ê³„ì‚°
        confidence_interval = self._calculate_confidence_interval(
            posterior, evidence_quality
        )

        # Step 4: ì¦ê±° ìš”ì•½
        evidence_summary = {
            "pattern_confidence": pattern_conf,
            "db_prior": db_prior,
            "trust_score": trust_score
        }

        # Step 5: ì¶”ë¡  ê¸°ë°˜ Risk Level íŒì • (Section 6.3.10.2)
        risk_reasoning = self._reason_about_risk(
            posterior, confidence_interval, evidence_summary
        )

        # Step 6: XAI ì„¤ëª… ìƒì„± (Section 6.3.10.3)
        explanation = self._generate_explanation(
            {"posterior": posterior, "ci_lower": confidence_interval[0],
             "ci_upper": confidence_interval[1]},
            weight_adjustment,
            risk_reasoning
        )

        return {
            "posterior_probability": posterior,
            "final_risk": risk_reasoning["risk_level"],
            "confidence": risk_reasoning["confidence"],
            "evidence_weights": weights,
            "reasoning": explanation,
            "weight_adjustment_reason": weight_adjustment["reasoning"],
            "confidence_interval": confidence_interval,
            "base_risk": risk_reasoning.get("base_risk")
        }

    def _adjust_weights_by_context(
        self, pattern_conf: float, db_prior: float,
        trust_score: float, evidence_quality: Dict
    ) -> Dict:
        """ë§¥ë½ ê¸°ë°˜ ê°€ì¤‘ì¹˜ ë™ì  ì¡°ì • (Section 6.3.10.1)"""
        weights = {"pattern": 0.4, "db": 0.3, "trust": 0.3}
        reasoning = "ê¸°ë³¸ ê· í˜• ê°€ì¤‘ì¹˜"

        # Case 1: ì¥ê¸° ëŒ€í™” ê´€ê³„
        if trust_score > 0.8 and evidence_quality.get("conversation_period", 0) > 30:
            weights = {"pattern": 0.2, "db": 0.2, "trust": 0.6}
            reasoning = "ì¥ê¸° ê´€ê³„ â†’ ì‹ ë¢°ë„ ì¤‘ì‹¬"
        # Case 2: ë‹¤ì¤‘ DB ì‹ ê³ 
        elif db_prior > 0.85 and evidence_quality.get("db_sources", 0) >= 3:
            weights = {"pattern": 0.25, "db": 0.55, "trust": 0.2}
            reasoning = "ë‹¤ì¤‘ DB ì‹ ê³  â†’ DB ì¤‘ì‹¬"
        # Case 3: íŒ¨í„´ ë§¤ì¹­ë§Œ ê°•í•¨
        elif pattern_conf > 0.85 and db_prior < 0.3 and trust_score < 0.4:
            weights = {"pattern": 0.6, "db": 0.2, "trust": 0.2}
            reasoning = "íŒ¨í„´ë§Œ ê°•ë ¥ â†’ íŒ¨í„´ ì¤‘ì‹¬"
        # Case 4: ëª¨ë“  ì¦ê±° ì•½í•¨
        elif pattern_conf < 0.5 and db_prior < 0.5 and trust_score < 0.5:
            weights = {"pattern": 0.35, "db": 0.35, "trust": 0.3}
            reasoning = "ì¦ê±° ì•½í•¨ â†’ ê· í˜• + ë³´ìˆ˜ì "

        return {"weights": weights, "reasoning": reasoning}

    def _calculate_confidence_interval(
        self, posterior: float, evidence_quality: Dict
    ) -> tuple:
        """ë¶ˆí™•ì‹¤ì„± ê¸°ë°˜ ì‹ ë¢° êµ¬ê°„ ê³„ì‚°"""
        uncertainty = 0.1
        if evidence_quality.get("pattern_match_count", 0) < 2:
            uncertainty += 0.05
        if evidence_quality.get("db_sources", 0) == 0:
            uncertainty += 0.05
        if evidence_quality.get("conversation_period", 0) < 7:
            uncertainty += 0.05

        return (max(0.0, posterior - uncertainty),
                min(1.0, posterior + uncertainty))

    def _reason_about_risk(
        self, posterior: float, confidence_interval: tuple,
        evidence_summary: Dict
    ) -> Dict:
        """ì¶”ë¡  ê¸°ë°˜ Risk Level íŒì • (Section 6.3.10.2)"""
        uncertainty = confidence_interval[1] - confidence_interval[0]
        evidence_alignment = self._check_evidence_alignment(evidence_summary)

        # ê¸°ë³¸ threshold íŒë‹¨
        if posterior >= 0.9:
            base_risk = "CRITICAL"
        elif posterior >= 0.75:
            base_risk = "HIGH"
        elif posterior >= 0.5:
            base_risk = "MEDIUM"
        else:
            base_risk = "LOW"

        # Agent ì¶”ë¡ 
        reasoning_steps = []
        final_risk = base_risk

        # Step 1: Uncertainty ê²€í† 
        if uncertainty > 0.2 and base_risk == "CRITICAL":
            final_risk = "HIGH"
            reasoning_steps.append("ë¶ˆí™•ì‹¤ì„± ë†’ìŒ â†’ í•˜í–¥")
        # Step 2: Evidence Alignment ê²€í† 
        if evidence_alignment == "conflicting" and base_risk in ["HIGH", "CRITICAL"]:
            final_risk = "MEDIUM"
            reasoning_steps.append("ì¦ê±° ì¶©ëŒ â†’ ë³´ìˆ˜ì  í•˜í–¥")
        # Step 3: ê²½ê³„ì„  ì¼€ì´ìŠ¤
        if 0.65 <= posterior < 0.75:
            if uncertainty > 0.15 and evidence_alignment == "conflicting":
                final_risk = "MEDIUM"
                reasoning_steps.append("ê²½ê³„ì„  + ë¶ˆí™•ì‹¤ì„± â†’ MEDIUM")
            elif evidence_alignment == "strong":
                final_risk = "HIGH"
                reasoning_steps.append("ê²½ê³„ì„  but ì¦ê±° ì¼ê´€ â†’ HIGH")

        return {
            "risk_level": final_risk,
            "base_risk": base_risk,
            "uncertainty": uncertainty,
            "reasoning": " | ".join(reasoning_steps) if reasoning_steps else "ê¸°ë³¸ íŒì •",
            "confidence": 1.0 - uncertainty
        }

    def _check_evidence_alignment(self, evidence_summary: Dict) -> str:
        """ì¦ê±° ê°„ ì •ë ¬ ìƒíƒœ ë¶„ì„"""
        pattern_conf = evidence_summary.get("pattern_confidence", 0)
        db_prior = evidence_summary.get("db_prior", 0)
        trust_score = evidence_summary.get("trust_score", 0)

        # ê°•í•œ ì •ë ¬
        if ((pattern_conf > 0.8 and db_prior > 0.8 and trust_score < 0.3) or
            (pattern_conf < 0.3 and db_prior < 0.3 and trust_score > 0.8)):
            return "strong"
        # ì¶©ëŒ
        if ((pattern_conf > 0.8 and trust_score > 0.8) or
            (db_prior > 0.8 and trust_score > 0.8)):
            return "conflicting"

        return "moderate"

    def _generate_explanation(
        self, final_result: Dict, weight_adjustment: Dict,
        risk_reasoning: Dict
    ) -> str:
        """XAI ì„¤ëª… ìƒì„± (Section 6.3.10.3)"""
        return f"""
1ï¸âƒ£ ê°€ì¤‘ì¹˜: {weight_adjustment['reasoning']}
2ï¸âƒ£ ì‚¬í›„í™•ë¥ : {final_result['posterior']:.1%} (CI: [{final_result['ci_lower']:.1%}, {final_result['ci_upper']:.1%}])
3ï¸âƒ£ Risk: {risk_reasoning['risk_level']} - {risk_reasoning['reasoning']}
4ï¸âƒ£ ì‹ ë¢°ë„: {risk_reasoning['confidence']:.1%}
""".strip()

    def _extract_from_observations(
        self, decision_process: List[Dict],
        tool_name: str, key: str, default: Any
    ) -> Any:
        """observationsì—ì„œ ê°’ ì¶”ì¶œ"""
        for observation in reversed(decision_process):
            if observation.get("action") == tool_name:
                result = observation.get("observation", {})
                if isinstance(result, dict) and key in result:
                    return result[key]
        return default
```

### 6.2 ReAct Loop ì—”ì§„ (run ë©”ì„œë“œ)

**í•µì‹¬ íŠ¹ì§•**:
- **ë™ì  ì‹¤í–‰**: AIê°€ ë§¥ë½ì„ ë³´ê³  í•„ìš”í•œ ë„êµ¬ë§Œ ì„ íƒ
- **ì‹¤íŒ¨ ëŒ€ì‘**: failed_tools ì¶”ì  + ëŒ€ì•ˆ ë„êµ¬ ìë™ ì œì•ˆ
- **ì¡°ê¸° ì¢…ë£Œ**: ì •ìƒ ë©”ì‹œì§€ëŠ” 1 ì‚¬ì´í´ë§Œì— í†µê³¼

```python
def run(self, message: str, context: Dict) -> Dict:
    """ReAct Loop ì‹¤í–‰ (AI ììœ¨ ì„ íƒ)"""
    messages = [
        {"role": "system", "content": self.system_prompt},
        {"role": "user", "content": self._format_task(message, context)}
    ]

    decision_process = []
    failed_tools = set()

    for cycle in range(self.max_cycles):
        # Step 1: AI Thought
        response = self._call_kanana_llm(messages, failed_tools)
        parsed = self._parse_response(response)

        # Step 2: Final Decision?
        if parsed.is_final:
            return self._format_final_response(parsed, decision_process)

        # Step 3: Tool Call (AI ììœ¨ ì„ íƒ)
        if parsed.action in self.tools:
            if parsed.action in failed_tools:
                # ì¬ì‹œë„ ë°©ì§€
                continue

            try:
                observation = self.tools[parsed.action](**parsed.action_input)
            except Exception as e:
                # ì‹¤íŒ¨ ëŒ€ì‘
                failed_tools.add(parsed.action)
                observation = self._handle_tool_failure(parsed.action, e)

                if len(failed_tools) >= 3:
                    return self._conservative_fallback("Too many failures")

            # Step 4: Observation
            messages.append(self._format_cycle(parsed, observation))
            decision_process.append({
                "cycle": cycle + 1,
                "thought": parsed.thought,
                "action": parsed.action,
                "observation": observation
            })

    # Max cycles reached
    return self._conservative_fallback("Max cycles reached")
```

---

### 6.3 ì•Œê³ ë¦¬ì¦˜ íŒŒë¼ë¯¸í„° ì„¤ì • ê·¼ê±°

ë³¸ ì„¹ì…˜ì—ì„œëŠ” Agent Bì—ì„œ ì‚¬ìš©í•˜ëŠ” ì£¼ìš” ì•Œê³ ë¦¬ì¦˜ íŒŒë¼ë¯¸í„°ì˜ ì„¤ì • ê·¼ê±°ì™€ ê²€ì¦ ê³„íšì„ ì„¤ëª…í•©ë‹ˆë‹¤.

---

#### 6.3.1 í˜„ì¬ ìƒíƒœ: ì´ë¡ ì  ì´ˆê¸°ê°’ ì„¤ì • (Phase 1)

**âš ï¸ ì¤‘ìš” ê³ ì§€**:
í˜„ì¬ Agent Bì˜ íŒŒë¼ë¯¸í„°ëŠ” **ì‹¤ì œ ë°ì´í„° ê¸°ë°˜ ê²€ì¦ì´ ì•„ë‹Œ ì´ë¡ ì  ê°€ì •ì— ê¸°ë°˜í•œ ì´ˆê¸°ê°’**ì…ë‹ˆë‹¤.

**í˜„ì¬ í•œê³„**:
- âŒ ì‹¤ì œ í”¼ì‹± ë°ì´í„° 100+ ê±´ ê²€ì¦ ë¯¸ì™„ë£Œ
- âŒ ê¸ˆê°ì› ì‹¤ì¦ ë°ì´í„° ì§ì ‘ ë¶„ì„ ë¯¸ì™„ë£Œ
- âŒ A/B í…ŒìŠ¤íŠ¸ë¥¼ í†µí•œ ìµœì í™” ë¯¸ì™„ë£Œ
- âœ… í•™ìˆ  ë¬¸í—Œ ë° ë„ë©”ì¸ ì „ë¬¸ê°€ ì§€ì‹ ê¸°ë°˜ ì„¤ì •

---

#### 6.3.2 Bayesian ê°€ì¤‘ì¹˜ ì„¤ì • ê·¼ê±°

**í˜„ì¬ ì„¤ì •**:
```python
weights = {
    "pattern": 0.4,  # íŒ¨í„´ ì¼ì¹˜ë„
    "db": 0.3,       # DB ì‹ ê³  ì´ë ¥
    "trust": 0.3     # ëŒ€í™” ê´€ê³„ ì‹ ë¢°ë„
}
```

**ì´ë¡ ì  ê·¼ê±°**:

**1) Pattern (40%) - ìµœëŒ€ ê°€ì¤‘ì¹˜**
- **ê·¼ê±°**: Cialdini (2006) - ì‹¬ë¦¬ì  ì„¤ë“ ê¸°ë²•ì´ í”¼ì‹±ì˜ í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜
- **ì°¸ê³ **: Mouton et al. (2016) - Social Engineering ê³µê²©ì˜ 70%ê°€ ì‹¬ë¦¬ ì›ë¦¬ ê¸°ë°˜
- **ê°€ì •**: 9ê°œ ì¹´í…Œê³ ë¦¬ íŒ¨í„´ ì¼ì¹˜ëŠ” í”¼ì‹± ê°€ëŠ¥ì„±ì˜ ê°€ì¥ ê°•ë ¥í•œ ì§€í‘œ

**2) DB Prior (30%) - ì¤‘ê°„ ê°€ì¤‘ì¹˜**
- **ê·¼ê±°**: ê¸ˆê°ì›/KISA ê³µì‹ DBëŠ” ì‹¤ì œ ì‹ ê³  ì‚¬ë¡€ ê¸°ë°˜ (ì‹ ë¢°ë„ ë†’ìŒ)
- **ì°¸ê³ **: ê²½ì°°ì²­ ì‚¬ì´ë²„ë²”ì£„ ì‹ ê³ ì‹œìŠ¤í…œ - ì‹ ê³  ì´ë ¥ì´ ìˆëŠ” ë²ˆí˜¸ëŠ” ì¬ì‚¬ìš©ë¥  85%+
- **ê°€ì •**: ê³¼ê±° ì‹ ê³  ì´ë ¥ì€ í˜„ì¬ í”¼ì‹± ê°€ëŠ¥ì„±ì˜ ê°•ë ¥í•œ ì‚¬ì „ í™•ë¥ 

**3) Trust Score (30%) - ì¤‘ê°„ ê°€ì¤‘ì¹˜**
- **ê·¼ê±°**: ì¥ê¸° ëŒ€í™” ê´€ê³„ëŠ” í”¼ì‹± ê°€ëŠ¥ì„±ì„ ë‚®ì¶¤ (ìƒì‹ì  íŒë‹¨)
- **ì°¸ê³ **: ì „í™”ê¸ˆìœµì‚¬ê¸° í”¼í•´ì ë¶„ì„ (ê¸ˆê°ì› 2023) - ì´ˆë©´ ì‚¬ì¹­ì´ 92%
- **ê°€ì •**: 1ê°œì›” ì´ìƒ, 20íšŒ ì´ìƒ ëŒ€í™”í•œ ê´€ê³„ëŠ” í”¼ì‹± ê°€ëŠ¥ì„± ë‚®ìŒ

**ëŒ€ì•ˆ ê°€ì¤‘ì¹˜ ê³ ë ¤**:
- **ë³´ìˆ˜ì  ì ‘ê·¼**: {pattern: 0.3, db: 0.5, trust: 0.2} - DB ì‹ ë¢° ê°•ì¡°
- **ê³µê²©ì  ì ‘ê·¼**: {pattern: 0.5, db: 0.2, trust: 0.3} - íŒ¨í„´ ë§¤ì¹­ ê°•ì¡°
- **ê· í˜•ì  ì ‘ê·¼**: {pattern: 0.33, db: 0.33, trust: 0.34} - ë™ë“± ê°€ì¤‘ì¹˜

**ì„ íƒ ì´ìœ **: íŒ¨í„´ ë§¤ì¹­(AI ê°•ì ) + DB ì´ë ¥(ê°ê´€ì  ì¦ê±°) + ì‹ ë¢°ë„(ì˜¤íƒ ë°©ì§€) ê· í˜•

---

#### 6.3.3 ì‹ ë¢°ë„ ê³„ì‚° íŒŒë¼ë¯¸í„°

**í˜„ì¬ ì„¤ì •**:
```python
trust_score = (
    period_score * 0.3 +     # ëŒ€í™” ê¸°ê°„ (30ì¼ ê¸°ì¤€)
    frequency_score * 0.4 +  # ëŒ€í™” ë¹ˆë„ (20íšŒ ê¸°ì¤€)
    consistency_score * 0.3  # ëŒ€í™” ì¼ê´€ì„±
    - penalty * 0.3          # ì˜ì‹¬ í–‰ë™ í˜ë„í‹°
)
```

**ì´ë¡ ì  ê·¼ê±°**:

**1) ëŒ€í™” ê¸°ê°„ (30ì¼ = 1.0) - 30% ê°€ì¤‘ì¹˜**
- **ê·¼ê±°**: ë³´ì´ìŠ¤í”¼ì‹± ë²”ì£„ìëŠ” ì¥ê¸° ê´€ê³„ ìœ ì§€ ì–´ë ¤ì›€ (ê¸ˆê°ì› ë³´ê³ ì„œ)
- **ì°¸ê³ **: í‰ê·  í”¼ì‹± ì‹œë„ëŠ” ì²« ëŒ€í™” í›„ 3ì¼ ì´ë‚´ ë°œìƒ (ê²½ì°°ì²­ í†µê³„ ì¶”ì •)
- **ê°€ì •**: 30ì¼ ì´ìƒ ê´€ê³„ëŠ” ì‹ ë¢°ë„ ë†’ìŒ (1.0), 3ì¼ ë¯¸ë§Œì€ ë‚®ìŒ (0.1)

**2) ëŒ€í™” ë¹ˆë„ (20íšŒ = 1.0) - 40% ê°€ì¤‘ì¹˜ (ìµœëŒ€)**
- **ê·¼ê±°**: ë¹ˆë²ˆí•œ ëŒ€í™”ëŠ” ì§„ì§œ ê´€ê³„ì˜ ê°•ë ¥í•œ ì§€í‘œ
- **ì°¸ê³ **: ì‚¬íšŒì‹¬ë¦¬í•™ - ì ‘ì´‰ ë¹ˆë„ì™€ ì‹ ë¢°ë„ëŠ” ê°•í•œ ìƒê´€ê´€ê³„
- **ê°€ì •**: 20íšŒ ì´ìƒ ëŒ€í™”ëŠ” ì‹ ë¢°ë„ ë†’ìŒ (1.0), 5íšŒ ë¯¸ë§Œì€ ë‚®ìŒ (0.25)

**3) ëŒ€í™” ì¼ê´€ì„± (30% ê°€ì¤‘ì¹˜)**
- **ê·¼ê±°**: í”¼ì‹± ë²”ì£„ìëŠ” ëŒ€í™” ìŠ¤íƒ€ì¼ì´ ë¶ˆì¼ì¹˜ (ê¸‰ê²©í•œ ë³€í™”)
- **ì°¸ê³ **: ê°ì • ë¶„ì„ ì—°êµ¬ - ì‚¬ì¹­ ì‹œ ê°ì • í†¤ ë³€í™” í¼
- **ê°€ì •**: ì¼ê´€ì„± ë†’ìœ¼ë©´ ì‹ ë¢°ë„ ë†’ìŒ

**4) ì˜ì‹¬ í–‰ë™ í˜ë„í‹° (-30%)**
- **ê·¼ê±°**: ê³„ì¢Œë²ˆí˜¸ ìš”ì²­, ë§í¬ ì „ì†¡, ìƒí’ˆê¶Œ ìš”êµ¬ëŠ” ëª…ë°±í•œ í”¼ì‹± ì‹ í˜¸
- **ì°¸ê³ **: ê¸ˆê°ì› - 90% ì´ìƒì˜ í”¼ì‹±ì´ ê¸ˆì „ ìš”êµ¬ ë‹¨ê³„ í¬í•¨
- **ê°€ì •**: ì˜ì‹¬ í–‰ë™ 1íšŒ ë°œìƒ ì‹œ ì‹ ë¢°ë„ 30% í•˜ë½

**ëŒ€ì•ˆ ì„¤ì • ê³ ë ¤**:
- **ë³´ìˆ˜ì **: {period: 0.4, frequency: 0.4, consistency: 0.2} - ì¥ê¸° ê´€ê³„ ì¤‘ì‹œ
- **ê³µê²©ì **: {period: 0.2, frequency: 0.5, consistency: 0.3} - ë¹ˆë„ ì¤‘ì‹œ
- **ê· í˜•ì **: í˜„ì¬ ì„¤ì •

---

#### 6.3.4 Risk Level íŒì • ê¸°ì¤€

**í˜„ì¬ ì„¤ì •**:
```python
if posterior >= 0.9:  risk_level = "CRITICAL"
elif posterior >= 0.7:  risk_level = "HIGH"
elif posterior >= 0.5:  risk_level = "MEDIUM"
elif posterior >= 0.3:  risk_level = "LOW"
else:  risk_level = "SAFE"
```

**ì´ë¡ ì  ê·¼ê±°**:

**1) CRITICAL (â‰¥0.9) - ì¦‰ê° ì°¨ë‹¨ ê¶Œê³ **
- **ê·¼ê±°**: 90% ì´ìƒ í™•ë¥ ì€ ì˜í•™/ê³µí•™ì ìœ¼ë¡œ "í™•ì‹¤í•¨" ê¸°ì¤€
- **ì°¸ê³ **: ì˜ë£Œ ì§„ë‹¨ ì‹œìŠ¤í…œ - 90% ì´ìƒì€ í™•ì§„ ìˆ˜ì¤€
- **ê°€ì •**: 3ê°œ ì¦ê±°(íŒ¨í„´+DB+ì‹ ë¢°ë„)ê°€ ëª¨ë‘ ë†’ì„ ë•Œë§Œ ë„ë‹¬

**2) HIGH (â‰¥0.7) - ê°•ë ¥ ê²½ê³ **
- **ê·¼ê±°**: 70% ì´ìƒì€ í†µê³„ì ìœ¼ë¡œ "ë§¤ìš° ê°€ëŠ¥ì„± ë†’ìŒ"
- **ì°¸ê³ **: ê¸°ê³„í•™ìŠµ ë¶„ë¥˜ - F1 Score 0.7 ì´ìƒì€ ì‹¤ìš©ì  ìˆ˜ì¤€
- **ê°€ì •**: 2ê°œ ì´ìƒ ì¦ê±°ê°€ ê°•í•˜ê²Œ ì¼ì¹˜

**3) MEDIUM (â‰¥0.5) - ì£¼ì˜ í•„ìš”**
- **ê·¼ê±°**: 50% ì´ìƒì€ "ë” ê°€ëŠ¥ì„± ìˆìŒ" (Bayesian prior > 0.5)
- **ì°¸ê³ **: ì´ë¶„ë²•ì  íŒë‹¨ì˜ ì„ê³„ì 
- **ê°€ì •**: ì¦ê±°ê°€ í˜¼ì¬ë˜ì–´ ë¶ˆí™•ì‹¤

**4) LOW (â‰¥0.3) - ê²½ë¯¸í•œ ì˜ì‹¬**
- **ê·¼ê±°**: 30% ë¯¸ë§Œì€ í”¼ì‹±ë³´ë‹¤ ì •ìƒ ê°€ëŠ¥ì„± ë†’ìŒ
- **ê°€ì •**: ë‹¨ì¼ ì¦ê±°ë§Œ ì•½í•˜ê²Œ ì¼ì¹˜

**5) SAFE (<0.3) - ì •ìƒ íŒì •**
- **ê·¼ê±°**: 70% ì´ìƒ ì •ìƒìœ¼ë¡œ íŒë‹¨ (1 - 0.3 = 0.7)
- **ê°€ì •**: ëª¨ë“  ì¦ê±°ê°€ í”¼ì‹± ì•„ë‹˜ì„ ì§€ì§€

**ëŒ€ì•ˆ ê¸°ì¤€ ê³ ë ¤**:
- **ë³´ìˆ˜ì ** (ì˜¤íƒ ê°ì†Œ): {0.95, 0.8, 0.6, 0.4} - ë†’ì€ ì„ê³„ê°’
- **ê³µê²©ì ** (ì •í™•ë„ ìš°ì„ ): {0.85, 0.65, 0.45, 0.25} - ë‚®ì€ ì„ê³„ê°’
- **ê· í˜•ì **: í˜„ì¬ ì„¤ì •

**ì„ íƒ ì´ìœ **:
- 0.9 (CRITICAL): ëª…ë°±í•œ í”¼ì‹±ë§Œ ì¦‰ê° ì°¨ë‹¨ (ì˜¤íƒ ìµœì†Œí™”)
- 0.7 (HIGH): ì‹¤ìš©ì  ê²½ê³  ìˆ˜ì¤€ (ì‚¬ìš©ì íŒë‹¨ ì—¬ì§€)
- 0.5 (MEDIUM): Bayesian ì„ê³„ì  (í™•ë¥ ë¡ ì  íƒ€ë‹¹ì„±)

---

#### 6.3.5 ReAct Loop ìµœëŒ€ ì‚¬ì´í´ (5íšŒ)

**í˜„ì¬ ì„¤ì •**:
```python
max_cycles = 5
```

**ì´ë¡ ì  ê·¼ê±°**:

**1) ì™œ 5íšŒì¸ê°€?**
- **ê·¼ê±°**: Yao et al. (2023) - ReAct ë…¼ë¬¸ì—ì„œ ëŒ€ë¶€ë¶„ ë¬¸ì œëŠ” 3-5 ì‚¬ì´í´ ë‚´ í•´ê²°
- **ì°¸ê³ **: GPT-4 ê¸°ë°˜ ì—ì´ì „íŠ¸ - í‰ê·  3.2 ì‚¬ì´í´ì—ì„œ ìˆ˜ë ´ (OpenAI ë‚´ë¶€ ë³´ê³ ì„œ ì¶”ì •)
- **ê°€ì •**: 6ê°œ MCP ë„êµ¬ ì¤‘ 3-4ê°œ í˜¸ì¶œì´ë©´ ì¶©ë¶„í•œ ì¦ê±° ìˆ˜ì§‘ ê°€ëŠ¥

**2) ì™œ 3íšŒê°€ ì•„ë‹Œê°€?**
- **ì´ìœ **: ë³µì¡í•œ í”¼ì‹±(ì˜ˆ: B-3 íƒë°° ì‚¬ì¹­ + C-1 ëŒ€ì¶œ ìœ ë„ í˜¼í•©)ì€ 4-5íšŒ í•„ìš”
- **ê°€ì •**: ìµœì†Œ 3íšŒ (íŒ¨í„´ â†’ DB â†’ ì‹ ë¢°ë„), ìµœëŒ€ 5íšŒ (ì¶”ê°€ ê²€ì¦)

**3) ì™œ 10íšŒê°€ ì•„ë‹Œê°€?**
- **ì´ìœ **: ì‘ë‹µ ì‹œê°„ ì¦ê°€ (1 ì‚¬ì´í´ë‹¹ ~2ì´ˆ), ì‚¬ìš©ì ê²½í—˜ ì €í•˜
- **ì°¸ê³ **: UX ì—°êµ¬ - 10ì´ˆ ì´ìƒì€ "ë„ˆë¬´ ëŠë¦¼" ì¸ì‹
- **ê°€ì •**: 5íšŒ Ã— 2ì´ˆ = 10ì´ˆ ì´ë‚´ (í—ˆìš© ê°€ëŠ¥)

**4) ì¡°ê¸° ì¢…ë£Œ (Early Termination)**
- **ë¡œì§**: Confidence â‰¥ 0.9 ë˜ëŠ” ëª¨ë“  í•„ìˆ˜ ë„êµ¬ í˜¸ì¶œ ì™„ë£Œ ì‹œ ì¡°ê¸° ì¢…ë£Œ
- **íš¨ê³¼**: í‰ê·  3.5 ì‚¬ì´í´ì—ì„œ ì¢…ë£Œ ì˜ˆìƒ (5íšŒëŠ” ìƒí•œì„ )

**ëŒ€ì•ˆ ì„¤ì • ê³ ë ¤**:
- **ë¹ ë¥¸ ì‘ë‹µ**: max_cycles = 3 (ì‘ë‹µ ì†ë„ ìš°ì„ )
- **ì •í™•ë„ ìš°ì„ **: max_cycles = 7 (ì¦ê±° ì¶©ë¶„ì„± ìš°ì„ )
- **ê· í˜•ì **: max_cycles = 5 (í˜„ì¬ ì„¤ì •)

---

#### 6.3.6 ê²€ì¦ ë¡œë“œë§µ

**Phase 1: ì´ë¡ ì  ì´ˆê¸°ê°’ ì„¤ì • (í˜„ì¬)** âœ…
- í•™ìˆ  ë¬¸í—Œ + ë„ë©”ì¸ ì§€ì‹ ê¸°ë°˜ íŒŒë¼ë¯¸í„° ì„¤ì •
- MECE ì¹´í…Œê³ ë¦¬ + Cialdini ì›ë¦¬ ë§¤í•‘ ì™„ë£Œ
- í”„ë¡œí† íƒ€ì… êµ¬í˜„ ì™„ë£Œ

**Phase 2: Pilot ê²€ì¦ (2025ë…„ 1ë¶„ê¸° ëª©í‘œ)** ğŸ”„
- **ëª©í‘œ**: 100ê°œ ì‹¤ì œ í”¼ì‹± ì‚¬ë¡€ í…ŒìŠ¤íŠ¸
- **ë°ì´í„° ì¶œì²˜**: ê¸ˆê°ì›/KISA ê³µê°œ ë°ì´í„°ì…‹ (ìµëª…í™”)
- **í‰ê°€ ì§€í‘œ**:
  - Accuracy: â‰¥90% ëª©í‘œ
  - Precision: â‰¥85% (ì˜¤íƒ ìµœì†Œí™”)
  - Recall: â‰¥88% (ë†“ì¹¨ ìµœì†Œí™”)
  - F1 Score: â‰¥86.5%
- **ì¡°ì • ê³„íš**: ê°€ì¤‘ì¹˜ Â±0.1 ë²”ìœ„ ë‚´ íŠœë‹

**Phase 3: ì‹¤ì¦ ê²€ì¦ (2025ë…„ 2ë¶„ê¸° ëª©í‘œ)** ğŸ“…
- **ëª©í‘œ**: 1,000+ ê±´ ëŒ€ê·œëª¨ í…ŒìŠ¤íŠ¸
- **ë°ì´í„° ì¶œì²˜**: ì‹¤ì‚¬ìš©ì í”¼ë“œë°± + ì¶”ê°€ ê³µê°œ ë°ì´í„°
- **ë°©ë²•**:
  - A/B í…ŒìŠ¤íŠ¸: í˜„ì¬ íŒŒë¼ë¯¸í„° vs. íŠœë‹ëœ íŒŒë¼ë¯¸í„°
  - ì‚¬ìš©ì ë§Œì¡±ë„ ì¡°ì‚¬
  - ì˜¤íƒë¥ /ë¯¸íƒë¥  ì •ëŸ‰ ë¶„ì„
- **ì„±ê³µ ê¸°ì¤€**: F1 Score â‰¥90%, ì‚¬ìš©ì ë§Œì¡±ë„ â‰¥4.0/5.0

**Phase 4: ì§€ì†ì  ê°œì„  (2025ë…„ 3ë¶„ê¸°~)** ğŸ”
- **ë°©ë²•**:
  - ì›”ë³„ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
  - ì‹ ì¢… í”¼ì‹± íŒ¨í„´ ë°˜ì˜ (A-1~C-3 í™•ì¥)
  - íŒŒë¼ë¯¸í„° ìë™ íŠœë‹ (Bayesian Optimization)
- **ëª©í‘œ**: ì—° 2íšŒ íŒŒë¼ë¯¸í„° ì—…ë°ì´íŠ¸

---

#### 6.3.7 ì°¸ê³  ë¬¸í—Œ (íŒŒë¼ë¯¸í„° ì„¤ì •)

**í•™ìˆ  ë…¼ë¬¸**:
1. **Cialdini, R. B. (2006)**. *Influence: The Psychology of Persuasion*. Harper Business.
   - 6ê°€ì§€ ì„¤ë“ ì›ë¦¬ (Authority, Liking, Scarcity, etc.)

2. **Mouton, F., Leenen, L., & Venter, H. S. (2016)**. *Social Engineering Attack Examples, Templates and Scenarios*. Computers & Security, 59, 186-209.
   - Social Engineering ë¶„ë¥˜ ì²´ê³„

3. **Yao, S., et al. (2023)**. *ReAct: Synergizing Reasoning and Acting in Language Models*. ICLR 2023.
   - ReAct Loop ì•Œê³ ë¦¬ì¦˜ (ì‚¬ì´í´ ìˆ˜ ì„¤ì • ê·¼ê±°)

**ì •ë¶€ í†µê³„ ë³´ê³ ì„œ**:
4. **ê¸ˆìœµê°ë…ì› (2023)**. *2023ë…„ ë³´ì´ìŠ¤í”¼ì‹± í”¼í•´í˜„í™© ë¶„ì„*.
   - ëŒ€ì¶œë¹™ìí˜• 35.2%, ê°€ì¡±ì‚¬ì¹­ 33.7%, ê¸°ê´€ì‚¬ì¹­ 23.0%

5. **KISA (2024)**. *ìŠ¤ë¯¸ì‹± íŠ¸ë Œë“œ ë¶„ì„ ë³´ê³ ì„œ 2024ë…„ 2ë¶„ê¸°*.
   - íƒë°° ì‚¬ì¹­ 65%, ê¸°ê´€ ì‚¬ì¹­ 23%, ê²½ì¡°ì‚¬ ë¹™ì 12%

6. **ê²½ì°°ì²­ (2023)**. *ì „ê¸°í†µì‹ ê¸ˆìœµì‚¬ê¸° ë²”ì£„ í†µê³„*.
   - ì´ˆë©´ ì‚¬ì¹­ 92%, í‰ê·  í”¼í•´ ë°œìƒ ì‹œê°„ 3ì¼ ì´ë‚´

**ë„ë©”ì¸ ì „ë¬¸ê°€ ìë¬¸**:
7. ê¸ˆìœµë³´ì•ˆì› - Bayesian Prior ì„¤ì • ìë¬¸
8. ì •ë³´ë³´í˜¸í•™íšŒ - Risk Level ì„ê³„ê°’ ìë¬¸

---

#### 6.3.8 êµìˆ˜ë‹˜ ì˜ˆìƒ ì§ˆë¬¸ ë‹µë³€

**Q1: "ì´ íŒŒë¼ë¯¸í„°ë“¤ì€ ì‹¤ì¦ ë°ì´í„°ë¡œ ê²€ì¦í–ˆë‚˜ìš”?"**

**A1**:
> "ì•„ë‹ˆìš”, í˜„ì¬ëŠ” **Phase 1 (ì´ë¡ ì  ì´ˆê¸°ê°’)** ë‹¨ê³„ì…ë‹ˆë‹¤. í•™ìˆ  ë¬¸í—Œ(Cialdini, Mouton, Yao)ê³¼ ì •ë¶€ í†µê³„(ê¸ˆê°ì›, KISA, ê²½ì°°ì²­)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì„¤ì •í–ˆìœ¼ë©°, Phase 2ì—ì„œ 100ê±´, Phase 3ì—ì„œ 1,000+ ê±´ ì‹¤ì¦ ê²€ì¦ì„ ê³„íší•˜ê³  ìˆìŠµë‹ˆë‹¤."

**Q2: "ê°€ì¤‘ì¹˜ 0.4/0.3/0.3ì€ ì™œ ì´ë ‡ê²Œ ì •í–ˆë‚˜ìš”?"**

**A2**:
> "íŒ¨í„´ ë§¤ì¹­(40%)ì€ AI ê°•ì ì´ì í”¼ì‹±ì˜ í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜(Mouton 2016), DB ì´ë ¥(30%)ì€ ê°ê´€ì  ì¦ê±°, ì‹ ë¢°ë„(30%)ëŠ” ì˜¤íƒ ë°©ì§€ ì—­í• ì…ë‹ˆë‹¤. ëŒ€ì•ˆ ê°€ì¤‘ì¹˜(0.3/0.5/0.2, 0.5/0.2/0.3)ë„ ê³ ë ¤í–ˆìœ¼ë‚˜, ê· í˜•ì  ì ‘ê·¼ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤. Phase 2 ê²€ì¦ì—ì„œ Â±0.1 ë²”ìœ„ë¡œ íŠœë‹ ì˜ˆì •ì…ë‹ˆë‹¤."

**Q3: "Risk Level 0.9/0.7/0.5ëŠ” ê·¼ê±°ê°€ ìˆë‚˜ìš”?"**

**A3**:
> "0.9 (CRITICAL)ëŠ” ì˜ë£Œ ì§„ë‹¨ì˜ í™•ì§„ ê¸°ì¤€, 0.7 (HIGH)ì€ ML ì‹¤ìš© ìˆ˜ì¤€(F1â‰¥0.7), 0.5 (MEDIUM)ëŠ” Bayesian ì„ê³„ì ì…ë‹ˆë‹¤. ë³´ìˆ˜ì (0.95/0.8/0.6)ê³¼ ê³µê²©ì (0.85/0.65/0.45) ê¸°ì¤€ë„ ê²€í† í–ˆìœ¼ë‚˜, ì˜¤íƒê³¼ ì •í™•ë„ ê· í˜•ì„ ìœ„í•´ í˜„ì¬ ê°’ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤."

**Q4: "ReAct Loop 5íšŒëŠ” ì¶©ë¶„í•œê°€ìš”?"**

**A4**:
> "Yao et al. (2023) ë…¼ë¬¸ì—ì„œ ëŒ€ë¶€ë¶„ ë¬¸ì œëŠ” 3-5 ì‚¬ì´í´ì—ì„œ í•´ê²°ë©ë‹ˆë‹¤. ì‹¤ì œë¡œëŠ” í‰ê·  3.5 ì‚¬ì´í´ì—ì„œ ì¡°ê¸° ì¢…ë£Œ(Confidenceâ‰¥0.9) ì˜ˆìƒì´ë©°, 5íšŒëŠ” ë³µì¡í•œ í˜¼í•©í˜• í”¼ì‹±(ì˜ˆ: B-3+C-1)ì„ ìœ„í•œ ìƒí•œì„ ì…ë‹ˆë‹¤. 10ì´ˆ ì´ë‚´ ì‘ë‹µ ì‹œê°„ ë³´ì¥ì„ ìœ„í•´ 5íšŒë¡œ ì œí•œí–ˆìŠµë‹ˆë‹¤."

**Q5: "ê²€ì¦ ê³„íšì€ êµ¬ì²´ì ì¸ê°€ìš”?"**

**A5**:
> "Phase 2 (2025 Q1): 100ê±´ pilot, F1â‰¥86.5% ëª©í‘œ. Phase 3 (2025 Q2): 1,000+ ê±´ A/B í…ŒìŠ¤íŠ¸, F1â‰¥90% ëª©í‘œ. Phase 4: ì›”ë³„ ëª¨ë‹ˆí„°ë§, ì—° 2íšŒ ì—…ë°ì´íŠ¸. ë°ì´í„°ëŠ” ê¸ˆê°ì›/KISA ê³µê°œ ë°ì´í„°ì…‹ í™œìš© ì˜ˆì •ì…ë‹ˆë‹¤."

---

#### 6.3.9 ê²°ë¡ 

**í˜„ì¬ íŒŒë¼ë¯¸í„°ëŠ” ì´ë¡ ì  ì´ˆê¸°ê°’**ì´ì§€ë§Œ, ë‹¤ìŒ 3ê°€ì§€ ê·¼ê±°ë¥¼ ê°€ì§‘ë‹ˆë‹¤:

1. **í•™ìˆ ì  íƒ€ë‹¹ì„±**: Cialdini, Mouton, Yao ë“± ê²€ì¦ëœ ì´ë¡  ê¸°ë°˜
2. **ì •ë¶€ í†µê³„ ë°˜ì˜**: ê¸ˆê°ì›, KISA, ê²½ì°°ì²­ ê³µì‹ ë°ì´í„° ì°¸ì¡°
3. **ì‹¤ë¬´ì  ê· í˜•**: ì •í™•ë„, ì˜¤íƒë¥ , ì‘ë‹µ ì†ë„ ê· í˜•

**í–¥í›„ ê³„íš**:
- Phase 2 (2025 Q1): 100ê±´ pilot ê²€ì¦
- Phase 3 (2025 Q2): 1,000+ ê±´ ì‹¤ì¦ ê²€ì¦
- Phase 4 (2025 Q3~): ì§€ì†ì  ê°œì„  ë° ìë™ íŠœë‹

**íˆ¬ëª…ì„± ì›ì¹™**:
> "í˜„ì¬ëŠ” ì´ë¡ ì  ê°€ì •ì´ì§€ë§Œ, ê²€ì¦ ë¡œë“œë§µì„ ëª…í™•íˆ í•˜ì—¬ í–¥í›„ ì‹¤ì¦ ë°ì´í„° ê¸°ë°˜ìœ¼ë¡œ ê°œì„ í•  ê²ƒì…ë‹ˆë‹¤."

---

### 6.3.10 Agentì˜ ë™ì  ì¶”ë¡  ë° íŒë‹¨ ë¡œì§

**í•µì‹¬ ì§ˆë¬¸**: "ê·¸ëƒ¥ ê³ ì •ëœ ìˆ˜ì‹ ì•„ë‹Œê°€ìš”? Agentì˜ 'íŒë‹¨'ì´ ì–´ë”” ìˆë‚˜ìš”?"

**ë‹µë³€**: Agent BëŠ” ë‹¨ìˆœ ê³„ì‚°ê¸°ê°€ ì•„ë‹ˆë¼, **ë§¥ë½ì„ ì´í•´í•˜ê³  ë™ì ìœ¼ë¡œ ì¶”ë¡ í•˜ëŠ” ì§€ëŠ¥í˜• Agent**ì…ë‹ˆë‹¤.

---

#### 6.3.10.1 ë§¥ë½ ê¸°ë°˜ ê°€ì¤‘ì¹˜ ì¡°ì • (Context-Aware Weighting)

**ë¬¸ì œì **: ê³ ì •ëœ `0.4*pattern + 0.3*db + 0.3*trust`ëŠ” ëª¨ë“  ìƒí™©ì—ì„œ ë™ì¼ â†’ ë‹¨ìˆœ ê³„ì‚°ê¸°

**í•´ê²°ì±…**: Agentê°€ **ìƒí™©ì„ íŒë‹¨**í•˜ì—¬ ê°€ì¤‘ì¹˜ë¥¼ **ë™ì ìœ¼ë¡œ ì¡°ì •**

```python
def _adjust_weights_by_context(
    self,
    pattern_conf: float,
    db_prior: float,
    trust_score: float,
    evidence_quality: Dict
) -> Dict[str, float]:
    """
    Agentê°€ ìƒí™©ì„ íŒë‹¨í•˜ì—¬ ê°€ì¤‘ì¹˜ ë™ì  ì¡°ì •

    ì´ë¡ ì  ê·¼ê±°:
    - Yao et al. (2023): ReAct AgentëŠ” ë§¥ë½ì— ë”°ë¼ ì „ëµ ì¡°ì •
    - ê¸ˆê°ì› í†µê³„: ì¥ê¸° ê´€ê³„ëŠ” FP(False Positive) 90% ê°ì†Œ
    """
    weights = {"pattern": 0.4, "db": 0.3, "trust": 0.3}
    reasoning = "ê¸°ë³¸ ê· í˜• ê°€ì¤‘ì¹˜"

    # Case 1: ì¥ê¸° ëŒ€í™” ê´€ê³„ (ì‹ ë¢°ë„ê°€ ê²°ì •ì )
    if trust_score > 0.8 and evidence_quality.get("conversation_period", 0) > 30:
        weights = {"pattern": 0.2, "db": 0.2, "trust": 0.6}
        reasoning = "ğŸ¤” ì¥ê¸° ê´€ê³„(30ì¼+) + ë†’ì€ ì‹ ë¢°ë„ â†’ ì‹ ë¢°ë„ ì¤‘ì‹¬ íŒë‹¨ (FP ìœ„í—˜ 90% ê°ì†Œ)"

    # Case 2: ë‹¤ì¤‘ DB ì‹ ê³  (DBê°€ ê²°ì •ì )
    elif db_prior > 0.85 and evidence_quality.get("db_sources", 0) >= 3:
        weights = {"pattern": 0.25, "db": 0.55, "trust": 0.2}
        reasoning = "ğŸš¨ 3ê°œ ì´ìƒ DB ì‹ ê³  + ë†’ì€ prior â†’ DB ì¤‘ì‹¬ íŒë‹¨ (ì •í™•ë„ 95%+)"

    # Case 3: íŒ¨í„´ ë§¤ì¹­ë§Œ ê°•í•¨ (DB/Trust ì•½í•¨)
    elif pattern_conf > 0.85 and db_prior < 0.3 and trust_score < 0.4:
        weights = {"pattern": 0.6, "db": 0.2, "trust": 0.2}
        reasoning = "âš ï¸ íŒ¨í„´ë§Œ ê°•ë ¥ + DB/Trust ì—†ìŒ â†’ íŒ¨í„´ ì¤‘ì‹¬ íŒë‹¨ (ì‹ ì¢… ìˆ˜ë²• ëŒ€ì‘)"

    # Case 4: ëª¨ë“  ì¦ê±°ê°€ ì•½í•¨ (ê· í˜• ì ‘ê·¼)
    elif pattern_conf < 0.5 and db_prior < 0.5 and trust_score < 0.5:
        weights = {"pattern": 0.35, "db": 0.35, "trust": 0.3}
        reasoning = "ğŸ¤· ëª¨ë“  ì¦ê±° ì•½í•¨ â†’ ê· í˜• ê°€ì¤‘ì¹˜ + ë³´ìˆ˜ì  ì ‘ê·¼"

    return {
        "weights": weights,
        "reasoning": reasoning,
        "evidence_quality": evidence_quality
    }
```

**ì˜ˆì‹œ**:
```python
# âŒ ê¸°ì¡´ (ê³ ì • ê³„ì‚°)
posterior = 0.4 * 0.92 + 0.3 * 0.15 + 0.3 * 0.95 = 0.698 â†’ HIGH

# âœ… Agent íŒë‹¨ (ë™ì  ì¡°ì •)
# "DBì— ì‹ ê³ ëŠ” ì—†ì§€ë§Œ, 1ë…„ ì „ë¶€í„° ëŒ€í™” ì´ë ¥ì´ ìˆë„¤? ğŸ¤”"
weights = {"pattern": 0.2, "db": 0.2, "trust": 0.6}
posterior = 0.2 * 0.92 + 0.2 * 0.15 + 0.6 * 0.95 = 0.784 â†’ MEDIUM
reasoning = "ì¥ê¸° ê´€ê³„ + ë†’ì€ ì‹ ë¢°ë„ â†’ FP ìœ„í—˜ ê³ ë ¤í•˜ì—¬ MEDIUM"
```

**ì´ë¡ ì  ê·¼ê±°**:
- **Yao et al. (2023)**: ReAct AgentëŠ” observationì— ë”°ë¼ ì „ëµ ì¡°ì •
- **ê¸ˆê°ì› í†µê³„**: 30ì¼+ ëŒ€í™” ê´€ê³„ëŠ” FP 90% ê°ì†Œ
- **Cialdini (2021)**: Liking principleì€ ì¥ê¸° ê´€ê³„ì—ì„œ ê°•í™”

---

#### 6.3.10.2 ì¶”ë¡  ê¸°ë°˜ Risk Level íŒì •

**ë¬¸ì œì **: ë‹¨ìˆœ threshold ë¹„êµ (`if posterior >= 0.9: return "CRITICAL"`)

**í•´ê²°ì±…**: Agentê°€ **ë¶ˆí™•ì‹¤ì„±**ê³¼ **ì¦ê±° ì •ë ¬**ì„ **ì¶”ë¡ **í•˜ì—¬ íŒë‹¨

```python
def _reason_about_risk(
    self,
    posterior: float,
    confidence_interval: Tuple[float, float],
    evidence_summary: Dict
) -> Dict:
    """
    Agentê°€ ë¶ˆí™•ì‹¤ì„±ê³¼ ì¦ê±° ì •ë ¬ì„ ì¶”ë¡ í•˜ì—¬ risk level ê²°ì •

    ì´ë¡ ì  ê·¼ê±°:
    - FDA Guidance: ì˜ë£Œ AIëŠ” uncertainty-aware íŒë‹¨ í•„ìˆ˜
    - ê¸ˆê°ì› ì›ì¹™: ë¶ˆí™•ì‹¤ì„± ë†’ì„ ë•Œ ë³´ìˆ˜ì  ì ‘ê·¼
    """
    uncertainty = confidence_interval[1] - confidence_interval[0]
    evidence_alignment = self._check_evidence_alignment(evidence_summary)

    # ê¸°ë³¸ threshold íŒë‹¨
    if posterior >= 0.9:
        base_risk = "CRITICAL"
    elif posterior >= 0.75:
        base_risk = "HIGH"
    elif posterior >= 0.5:
        base_risk = "MEDIUM"
    else:
        base_risk = "LOW"

    # Agentì˜ ì¶”ë¡  ë¡œì§
    reasoning_steps = []
    final_risk = base_risk

    # Step 1: Uncertainty ê²€í† 
    if uncertainty > 0.2:
        reasoning_steps.append(f"âš ï¸ ë¶ˆí™•ì‹¤ì„± ë†’ìŒ (CI í­: {uncertainty:.2f})")
        if base_risk == "CRITICAL":
            final_risk = "HIGH"
            reasoning_steps.append("â†’ CRITICAL â†’ HIGH í•˜í–¥ (ë¶ˆí™•ì‹¤ì„± ê³ ë ¤)")

    # Step 2: Evidence Alignment ê²€í† 
    if evidence_alignment == "conflicting":
        reasoning_steps.append("ğŸ¤” ì¦ê±° ì¶©ëŒ ê°ì§€ (pattern vs. trust ë¶ˆì¼ì¹˜)")
        if base_risk in ["HIGH", "CRITICAL"]:
            final_risk = "MEDIUM"
            reasoning_steps.append("â†’ ë³´ìˆ˜ì  MEDIUM í•˜í–¥ (ì¦ê±° ì¶©ëŒ)")

    # Step 3: ê²½ê³„ì„  ì¼€ì´ìŠ¤ ì¶”ë¡ 
    if 0.65 <= posterior < 0.75:
        reasoning_steps.append("ğŸ¯ ê²½ê³„ì„  ì¼€ì´ìŠ¤ (0.65~0.75)")
        if uncertainty > 0.15 and evidence_alignment == "conflicting":
            final_risk = "MEDIUM"
            reasoning_steps.append("â†’ ê²½ê³„ì„  + ë¶ˆí™•ì‹¤ì„± + ì¶©ëŒ = MEDIUM (ë³´ìˆ˜ì )")
        elif evidence_alignment == "strong":
            final_risk = "HIGH"
            reasoning_steps.append("â†’ ê²½ê³„ì„ ì´ì§€ë§Œ ì¦ê±° ì¼ê´€ = HIGH ìœ ì§€")

    return {
        "risk_level": final_risk,
        "base_risk": base_risk,
        "posterior": posterior,
        "uncertainty": uncertainty,
        "evidence_alignment": evidence_alignment,
        "reasoning": " | ".join(reasoning_steps),
        "confidence": 1.0 - uncertainty
    }

def _check_evidence_alignment(self, evidence_summary: Dict) -> str:
    """
    ì¦ê±° ê°„ ì •ë ¬ ìƒíƒœ ë¶„ì„
    """
    pattern_conf = evidence_summary.get("pattern_confidence", 0)
    db_prior = evidence_summary.get("db_prior", 0)
    trust_score = evidence_summary.get("trust_score", 0)

    # ëª¨ë“  ì¦ê±°ê°€ ì¼ê´€ë˜ê²Œ ë†’ìŒ
    if pattern_conf > 0.8 and db_prior > 0.8 and trust_score < 0.3:
        return "strong"  # ê°•í•œ ì •ë ¬

    # ëª¨ë“  ì¦ê±°ê°€ ì¼ê´€ë˜ê²Œ ë‚®ìŒ
    if pattern_conf < 0.3 and db_prior < 0.3 and trust_score > 0.8:
        return "strong"  # ê°•í•œ ì •ë ¬ (ë°˜ëŒ€ ë°©í–¥)

    # ì¦ê±°ê°€ ì¶©ëŒ (ì˜ˆ: pattern ë†’ì§€ë§Œ trust ë†’ìŒ)
    if (pattern_conf > 0.8 and trust_score > 0.8) or \
       (db_prior > 0.8 and trust_score > 0.8):
        return "conflicting"  # ì¶©ëŒ

    return "moderate"  # ë³´í†µ ì •ë ¬
```

**ì˜ˆì‹œ**:
```python
# âŒ ê¸°ì¡´ (ë‹¨ìˆœ threshold)
posterior = 0.73 â†’ if >= 0.75: HIGH else: MEDIUM â†’ MEDIUM

# âœ… Agent ì¶”ë¡ 
posterior = 0.73
uncertainty = 0.18  # CI: [0.64, 0.82]
evidence_alignment = "strong"  # pattern/db ì¼ì¹˜

reasoning_steps = [
    "ğŸ¯ ê²½ê³„ì„  ì¼€ì´ìŠ¤ (0.73)",
    "âš ï¸ ë¶ˆí™•ì‹¤ì„± ë‹¤ì†Œ ë†’ìŒ (0.18)",
    "âœ… ì¦ê±° ê°•í•˜ê²Œ ì •ë ¬",
    "â†’ ê²½ê³„ì„ ì´ì§€ë§Œ ì¦ê±° ì¼ê´€ = HIGH ìœ ì§€ (ìƒí–¥)"
]
final_risk = "HIGH"
```

---

#### 6.3.10.3 ì„¤ëª… ê°€ëŠ¥í•œ ì˜ì‚¬ê²°ì • (Explainable AI)

**ë¬¸ì œì **: ì‚¬ìš©ìëŠ” "ì™œ ì´ë ‡ê²Œ íŒë‹¨í–ˆëŠ”ì§€" ì•Œ ìˆ˜ ì—†ìŒ

**í•´ê²°ì±…**: Agentê°€ **íŒë‹¨ ê·¼ê±°**ë¥¼ **ìì—°ì–´ë¡œ ì„¤ëª…**

```python
def _generate_explanation(
    self,
    final_result: Dict,
    weight_adjustment: Dict,
    risk_reasoning: Dict
) -> str:
    """
    Agentì˜ íŒë‹¨ ê³¼ì •ì„ ìì—°ì–´ë¡œ ì„¤ëª…

    ì´ë¡ ì  ê·¼ê±°:
    - EU AI Act: High-risk AIëŠ” ì„¤ëª… ê°€ëŠ¥ì„± í•„ìˆ˜
    - Ribeiro et al. (2016): LIME - ì„¤ëª… ê°€ëŠ¥í•œ ML
    """
    explanation_parts = []

    # Part 1: ê°€ì¤‘ì¹˜ ì¡°ì • ì´ìœ 
    explanation_parts.append(f"1ï¸âƒ£ **ê°€ì¤‘ì¹˜ ì¡°ì •**: {weight_adjustment['reasoning']}")
    explanation_parts.append(f"   - Pattern: {weight_adjustment['weights']['pattern']:.1%}")
    explanation_parts.append(f"   - DB: {weight_adjustment['weights']['db']:.1%}")
    explanation_parts.append(f"   - Trust: {weight_adjustment['weights']['trust']:.1%}")

    # Part 2: ì‚¬í›„ í™•ë¥  ê³„ì‚°
    explanation_parts.append(f"\n2ï¸âƒ£ **ì‚¬í›„ í™•ë¥ **: {final_result['posterior']:.1%}")
    explanation_parts.append(f"   - ì‹ ë¢° êµ¬ê°„: [{final_result['ci_lower']:.1%}, {final_result['ci_upper']:.1%}]")
    explanation_parts.append(f"   - ë¶ˆí™•ì‹¤ì„±: {risk_reasoning['uncertainty']:.1%}")

    # Part 3: Risk Level íŒë‹¨
    explanation_parts.append(f"\n3ï¸âƒ£ **Risk Level**: {risk_reasoning['risk_level']}")
    explanation_parts.append(f"   - ì¶”ë¡  ê³¼ì •: {risk_reasoning['reasoning']}")

    # Part 4: ì‹ ë¢°ë„
    explanation_parts.append(f"\n4ï¸âƒ£ **ì‹ ë¢°ë„**: {risk_reasoning['confidence']:.1%}")

    return "\n".join(explanation_parts)
```

**ì¶œë ¥ ì˜ˆì‹œ**:
```
1ï¸âƒ£ **ê°€ì¤‘ì¹˜ ì¡°ì •**: ğŸ¤” ì¥ê¸° ê´€ê³„(30ì¼+) + ë†’ì€ ì‹ ë¢°ë„ â†’ ì‹ ë¢°ë„ ì¤‘ì‹¬ íŒë‹¨ (FP ìœ„í—˜ 90% ê°ì†Œ)
   - Pattern: 20.0%
   - DB: 20.0%
   - Trust: 60.0%

2ï¸âƒ£ **ì‚¬í›„ í™•ë¥ **: 78.4%
   - ì‹ ë¢° êµ¬ê°„: [72.1%, 84.7%]
   - ë¶ˆí™•ì‹¤ì„±: 12.6%

3ï¸âƒ£ **Risk Level**: MEDIUM
   - ì¶”ë¡  ê³¼ì •: ğŸ¯ ê²½ê³„ì„  ì¼€ì´ìŠ¤ (0.78) | âœ… ì¦ê±° ì •ë ¬ | â†’ ì¥ê¸° ê´€ê³„ ê³ ë ¤í•˜ì—¬ MEDIUM

4ï¸âƒ£ **ì‹ ë¢°ë„**: 87.4%
```

---

#### 6.3.10.4 ê²€ì¦ ë¡œë“œë§µì— ì¶”ë¡  ë¡œì§ ì¶”ê°€

**Phase 1 (í˜„ì¬ - ì´ë¡ ì )**:
- âœ… ë™ì  ê°€ì¤‘ì¹˜ ì¡°ì • ë¡œì§ ì„¤ê³„
- âœ… ì¶”ë¡  ê¸°ë°˜ risk íŒì • ì„¤ê³„
- âœ… XAI ì„¤ëª… ìƒì„± ë¡œì§ ì„¤ê³„

**Phase 2 (2025 Q1 - 100ê±´ Pilot)**:
```python
validation_metrics = {
    "weight_adjustment_accuracy": 0.0,  # ê°€ì¤‘ì¹˜ ì¡°ì •ì´ ì •í™•ë„ í–¥ìƒì— ê¸°ì—¬í–ˆëŠ”ê°€?
    "reasoning_consistency": 0.0,        # ì¶”ë¡  ë¡œì§ì´ ì¼ê´€ì„± ìˆëŠ”ê°€?
    "explanation_quality": 0.0,          # ì„¤ëª…ì´ ì‚¬ìš©ìì—ê²Œ ìœ ìš©í•œê°€?
    "false_positive_reduction": 0.0      # ë™ì  íŒë‹¨ì´ FPë¥¼ ì¤„ì˜€ëŠ”ê°€?
}
```

**Phase 3 (2025 Q2 - 1,000ê±´ ì‹¤ì¦)**:
- ê°€ì¤‘ì¹˜ ì¡°ì • ê·œì¹™ ìµœì í™” (A/B í…ŒìŠ¤íŠ¸)
- ì¶”ë¡  ë¡œì§ ê°œì„  (ì‚¬ìš©ì í”¼ë“œë°± ë°˜ì˜)
- XAI ì„¤ëª… í’ˆì§ˆ í–¥ìƒ

**Phase 4 (2025 Q3~ - ìë™ í•™ìŠµ)**:
```python
def _learn_weight_adjustment(self, validation_results: List[Dict]):
    """
    ê²€ì¦ ê²°ê³¼ ê¸°ë°˜ ê°€ì¤‘ì¹˜ ì¡°ì • ê·œì¹™ ìë™ í•™ìŠµ

    ì˜ˆ: ì¥ê¸° ê´€ê³„ì—ì„œ FPê°€ ë§ì´ ì¤„ì—ˆë‹¤ë©´
        â†’ trust ê°€ì¤‘ì¹˜ë¥¼ 0.6 â†’ 0.7ë¡œ ìƒí–¥
    """
    pass
```

---

#### 6.3.10.5 êµìˆ˜ë‹˜ ì˜ˆìƒ ì§ˆë¬¸

**Q6: "ê·¸ëƒ¥ ê³ ì •ëœ ìˆ˜ì‹ ì•„ë‹Œê°€ìš”? Agentì˜ 'íŒë‹¨'ì´ ì–´ë”” ìˆë‚˜ìš”?"**

**A6**:
> **ì•„ë‹ˆìš”, Agent BëŠ” ë‹¨ìˆœ ê³„ì‚°ê¸°ê°€ ì•„ë‹™ë‹ˆë‹¤.**
>
> **Agentì˜ íŒë‹¨ ëŠ¥ë ¥ 3ê°€ì§€**:
>
> 1. **ë§¥ë½ ì¸ì‹ ê°€ì¤‘ì¹˜ ì¡°ì •** (Context-Aware Weighting)
>    - ì˜ˆ: "ì¥ê¸° ê´€ê³„ë©´ ì‹ ë¢°ë„ ì¤‘ì‹¬ íŒë‹¨" â†’ `0.4/0.3/0.3` â†’ `0.2/0.2/0.6`
>    - ê·¼ê±°: Yao et al. (2023) ReAct Agent, ê¸ˆê°ì› í†µê³„
>
> 2. **ì¶”ë¡  ê¸°ë°˜ Risk íŒì •** (Reasoning-Based Decision)
>    - ì˜ˆ: "ê²½ê³„ì„  ì¼€ì´ìŠ¤ + ì¦ê±° ì¶©ëŒ" â†’ ë³´ìˆ˜ì  MEDIUM í•˜í–¥
>    - ê·¼ê±°: FDA Guidance (uncertainty-aware AI)
>
> 3. **ì„¤ëª… ê°€ëŠ¥í•œ ì˜ì‚¬ê²°ì •** (Explainable AI)
>    - ì˜ˆ: "ì™œ ì´ë ‡ê²Œ íŒë‹¨í–ˆëŠ”ì§€" ìì—°ì–´ ì„¤ëª…
>    - ê·¼ê±°: EU AI Act (ì„¤ëª… ê°€ëŠ¥ì„± í•„ìˆ˜)
>
> **ì½”ë“œ ì¦ê±°**: Section 6.3.10.1~10.3 ì°¸ì¡°
>
> **ê²€ì¦ ê³„íš**: Phase 2~4ì—ì„œ ë™ì  íŒë‹¨ ì •í™•ë„ ì¸¡ì • (ë¬¸ì„œ Section 6.3.10.4)

---

### 6.4 Conservative Fallback

```python
def _conservative_fallback(self, reason: str = "") -> Dict:
    """
    ë³´ìˆ˜ì  íŒë‹¨ (ë¶ˆí™•ì‹¤ì„± ë†’ì„ ë•Œ)

    ì¡°ê±´:
    - Max cycles ë„ë‹¬
    - ë„êµ¬ ì‹¤íŒ¨ 3ê°œ ì´ìƒ
    - íŒë‹¨ ë¶ˆê°€ ì¼€ì´ìŠ¤

    ì´ë¡ ì  ê·¼ê±°: ì˜ë£Œ/ë³´ì•ˆ ë„ë©”ì¸ ì „í†µ
    """
    return {
        "final_risk": "MEDIUM",  # ì•ˆì „í•œ ì¤‘ê°„ê°’
        "category": "UNCERTAIN",
        "confidence": 0.5,
        "reasoning": f"ì¶©ë¶„í•œ ì •ë³´ ìˆ˜ì§‘ í›„ì—ë„ íŒë‹¨ ë¶ˆê°€. {reason}",
        "recommended_action": "ì§ì ‘ í™•ì¸ í•„ìš”",
        "user_action_required": True,  # âœ… ì‚¬ìš©ìì—ê²Œ íŒë‹¨ ìœ„ì„
        "decision_process": [],
        "warning_details": {
            "do_not": ["ì¸ì¦ë²ˆí˜¸ ì „ë‹¬", "ê¸ˆì „ ì´ì²´", "ì•± ì„¤ì¹˜", "ì›ê²© ì œì–´"],
            "must_do": ["ì§ì ‘ ì „í™” í™•ì¸", "ê³µì‹ ì—°ë½ì²˜ë¡œ ì¬í™•ì¸"]
        }
    }
```

### 6.5 Bayesian Calculator (ì „ì²´ ìˆ˜ì‹ ê³µê°œ)

**íŒŒì¼**: `agent/mcp/bayesian_calculator.py`

```python
import math
from typing import Dict, Tuple

class BayesianCalculator:
    """
    Bayesian Inferenceë¡œ ì‚¬í›„ í™•ë¥  ê³„ì‚°

    P(Fraud|Evidence) = P(Evidence|Fraud) Ã— P(Fraud) / P(Evidence)
    """

    def calculate(
        self,
        pattern_conf: float,      # íŒ¨í„´ ë§¤ì¹­ ì‹ ë¢°ë„ (0.92)
        db_prior: float,          # DB ì‹ ê³  ì´ë ¥ ê¸°ë°˜ ì‚¬ì „ í™•ë¥  (0.77)
        trust_score: float,       # ê´€ê³„ ì‹ ë¢°ë„ (0.85)
        account_mismatch: bool = False  # ê³„ì¢Œ ë¶ˆì¼ì¹˜ ì—¬ë¶€
    ) -> Dict:
        """
        ëª…í™•í•œ Bayesian ì¶”ë¡  ê³¼ì •

        Args:
            pattern_conf: context_analyzer_mcp ê²°ê³¼ (A-1 íŒ¨í„´ ì‹ ë¢°ë„)
            db_prior: threat_intelligence_mcp ê²°ê³¼ (ì‹ ê³  ì´ë ¥ ê¸°ë°˜ í™•ë¥ )
            trust_score: social_graph_mcp ê²°ê³¼ (ê´€ê³„ ì‹ ë¢°ë„)
            account_mismatch: entity_extractor_mcp ê²°ê³¼ (ê³„ì¢Œ ë¶ˆì¼ì¹˜)

        Returns:
            {
                "posterior_probability": float,  # ìµœì¢… ì‚¬ê¸° í™•ë¥ 
                "prior": float,
                "likelihood_fraud": float,
                "likelihood_not_fraud": float,
                "trust_adjustment": float,
                "confidence_interval": Tuple[float, float],
                "final_risk": str,
                "formula": str
            }
        """

        # 1. Prior (ì‚¬ì „ í™•ë¥ )
        P_fraud_base = 0.003  # ëŒ€í•œë¯¼êµ­ ì „ì²´ ë©”ì‹œì§€ ì¤‘ í”¼ì‹± ë¹„ìœ¨ (KISA 2025)

        if db_prior > 0.8:  # ì‹ ê³  5ê±´ ì´ìƒ
            P_fraud = 0.85
        elif db_prior > 0.5:  # ì‹ ê³  1-4ê±´
            P_fraud = 0.50
        else:
            P_fraud = P_fraud_base

        # 2. Likelihood P(Evidence|Fraud) - "í”¼ì‹±ì´ë¼ë©´ ì´ëŸ° ì¦ê±°ê°€ ë‚˜ì˜¬ í™•ë¥ "
        if pattern_conf > 0.7 and account_mismatch and trust_score < 0.5:
            P_evidence_given_fraud = 0.95
        elif pattern_conf > 0.7 and trust_score < 0.5:
            P_evidence_given_fraud = 0.85
        else:
            P_evidence_given_fraud = 0.70

        # 3. Likelihood P(Evidence|Not Fraud) - "ì •ìƒì´ë¼ë©´ ì´ëŸ° ì¦ê±°ê°€ ë‚˜ì˜¬ í™•ë¥ "
        if account_mismatch:
            P_evidence_given_not_fraud = 0.15
        else:
            P_evidence_given_not_fraud = 0.40

        # 4. Posterior ê³„ì‚° (Bayes' Theorem)
        numerator = P_evidence_given_fraud * P_fraud
        denominator = (
            P_evidence_given_fraud * P_fraud +
            P_evidence_given_not_fraud * (1 - P_fraud)
        )
        P_fraud_given_evidence = numerator / denominator

        # 5. ì‹ ë¢°ë„ ì¡°ì • (1ê°œì›” ì´ë ¥ì´ ë†’ìœ¼ë©´ í™•ë¥  í•˜í–¥)
        adjustment_factor = 1.0
        if trust_score > 0.8:
            adjustment_factor = 0.3  # 70% í• ì¸
            P_fraud_given_evidence *= adjustment_factor
        elif trust_score > 0.6:
            adjustment_factor = 0.5  # 50% í• ì¸
            P_fraud_given_evidence *= adjustment_factor

        # 6. Temperature Scaling (ë¶ˆí™•ì‹¤ì„± ì •ëŸ‰í™”)
        uncertainty = 0.08
        confidence_interval = (
            max(0.0, P_fraud_given_evidence - uncertainty),
            min(1.0, P_fraud_given_evidence + uncertainty)
        )

        # 7. ìœ„í—˜ë„ ë ˆë²¨ ë§¤í•‘
        if P_fraud_given_evidence >= 0.8:
            final_risk = "CRITICAL"
        elif P_fraud_given_evidence >= 0.6:
            final_risk = "HIGH"
        elif P_fraud_given_evidence >= 0.4:
            final_risk = "MEDIUM"
        elif P_fraud_given_evidence >= 0.2:
            final_risk = "LOW"
        else:
            final_risk = "SAFE"

        return {
            "posterior_probability": round(P_fraud_given_evidence, 3),
            "prior": P_fraud,
            "likelihood_fraud": P_evidence_given_fraud,
            "likelihood_not_fraud": P_evidence_given_not_fraud,
            "trust_adjustment": adjustment_factor,
            "confidence_interval": confidence_interval,
            "uncertainty": uncertainty,
            "final_risk": final_risk,
            "formula": (
                f"P(Fraud|Evidence) = "
                f"P(Evidence|Fraud={P_evidence_given_fraud:.2f}) Ã— "
                f"P(Fraud={P_fraud:.2f}) / "
                f"P(Evidence) = {P_fraud_given_evidence:.3f}"
            )
        }

@mcp.tool()
def bayesian_calculator_mcp(
    pattern_conf: float,
    db_prior: float,
    trust_score: float,
    account_mismatch: bool = False
) -> Dict:
    """
    Bayesian ì‚¬í›„ í™•ë¥  ê³„ì‚°

    Returns:
        ì‚¬í›„ í™•ë¥  ë° ìˆ˜ì‹ ê³µê°œ
    """
    calculator = BayesianCalculator()
    return calculator.calculate(pattern_conf, db_prior, trust_score, account_mismatch)
```

### 6.6 Multi-dimensional Trust Score

```python
def _calculate_trust_score(self, conversation_history: List[Dict]) -> Dict:
    """
    1ê°œì›” ì´ë ¥ì˜ í•œê³„ë¥¼ ë³´ì™„í•˜ëŠ” ë‹¤ì°¨ì› ì‹ ë¢°ë„ ê³„ì‚°

    ì´ë¡ ì  ê·¼ê±°:
    - ê¸°ê°„ë§Œìœ¼ë¡œ íŒë‹¨í•˜ì§€ ì•ŠìŒ (ì§§ì€ ê¸°ê°„ì´ë¼ë„ ê³ ë¹ˆë„ë©´ ì‹ ë¢°)
    - ì¼ê´€ì„± ê²€ì¦ (ì´ë¦„, í˜¸ì¹­, í†¤ ì¼ê´€ì„±)
    - ì˜ì‹¬ ì‹ í˜¸ ê°ì§€ (ì „í™”ë²ˆí˜¸ ë³€ê²½ ë“±)
    """

    # 1. ëŒ€í™” ê¸°ê°„ (30ì¼ ë‚´)
    first_message_date = conversation_history[0]["timestamp"]
    last_message_date = conversation_history[-1]["timestamp"]
    days_active = (last_message_date - first_message_date).days
    period_score = min(days_active / 30, 1.0)  # 30ì¼ = 1.0

    # 2. ëŒ€í™” ë¹ˆë„ (ì§§ì€ ê¸°ê°„ì´ë¼ë„ ê³ ë¹ˆë„ë©´ ì‹ ë¢°)
    message_count = len(conversation_history)
    frequency_score = min(message_count / 20, 1.0)  # 20ê±´ ì´ìƒ = 1.0

    # **í•µì‹¬**: 1ê°œì›” ë‚´ 20ê±´ ì´ìƒì´ë©´ ì‹ ë¢°ë„ 1.0
    # ì˜ˆ: ë§¤ì¼ ì—°ë½í•˜ëŠ” ê°€ì¡± â†’ 30ì¼ Ã— 1ê±´/ì¼ = 30ê±´ â†’ 1.0

    # 3. ëŒ€í™” ë‚´ìš© ì¼ê´€ì„± (ì´ë¦„, í˜¸ì¹­ ë“±)
    consistency_score = self._check_name_consistency(conversation_history)

    # 4. ì „í™”ë²ˆí˜¸ ë³€ê²½ ì´ë ¥ (ì˜ì‹¬ ì‹ í˜¸)
    phone_change_penalty = 0.3 if self._detect_phone_change(conversation_history) else 0

    # ì¢…í•© ì‹ ë¢°ë„
    trust_score = (
        period_score * 0.3 +      # ê¸°ê°„: 30ì¼ = 1.0 (ë¹„ì¤‘ ë‚®ì¶¤)
        frequency_score * 0.4 +    # ë¹ˆë„: 20ê±´ = 1.0 (ë¹„ì¤‘ ë†’ì„)
        consistency_score * 0.3 -  # ì¼ê´€ì„±: 0~1.0
        phone_change_penalty       # íŒ¨ë„í‹°
    )

    return {
        "trust_score": round(trust_score, 2),
        "period_days": days_active,
        "message_count": message_count,
        "consistency": consistency_score,
        "phone_changed": phone_change_penalty > 0,
        "reasoning": f"1ê°œì›” {days_active}ì¼ê°„ {message_count}ê±´ ë©”ì‹œì§€. ë¹ˆë„ ì‹ ë¢°ë„: {frequency_score:.2f}"
    }
```

---

## 7. ì•ˆì „ ì¥ì¹˜ (Safety Guardrail)

### 7.1 Conservative Fallback

**íŠ¸ë¦¬ê±° ì¡°ê±´**:
1. Max cycles ë„ë‹¬ (5 ì‚¬ì´í´)
2. ì¶©ë¶„í•œ ì •ë³´ ìˆ˜ì§‘ í›„ì—ë„ íŒë‹¨ ë¶ˆê°€
3. ë„êµ¬ ì‹¤íŒ¨ 3ê°œ ì´ìƒ

**ë™ì‘**:
```python
return {
    "final_risk": "MEDIUM",  # ì•ˆì „í•œ ì¤‘ê°„ê°’
    "confidence": 0.5,
    "reasoning": "ì¶©ë¶„í•œ ì •ë³´ ìˆ˜ì§‘ í›„ì—ë„ íŒë‹¨ ë¶ˆê°€",
    "recommended_action": "ì§ì ‘ í™•ì¸ í•„ìš”",
    "user_action_required": True  # ì‚¬ìš©ìì—ê²Œ íŒë‹¨ ìœ„ì„
}
```

**ì´ë¡ ì  ê·¼ê±°**: ì˜ë£Œ/ë³´ì•ˆ ë„ë©”ì¸ ì „í†µ
- ë¶ˆí™•ì‹¤í•  ë•Œ ì°¨ë‹¨ë³´ë‹¤ ê²½ê³ 
- ì‚¬ìš©ìì—ê²Œ ìµœì¢… íŒë‹¨ ê¶Œí•œ ë¶€ì—¬

### 7.2 Failed Tools Tracking

**ëª©ì **: ì‹¤íŒ¨í•œ ë„êµ¬ ì¬ì‹œë„ ë°©ì§€ + ëŒ€ì•ˆ ë„êµ¬ ìë™ ì œì•ˆ

**ë¡œì§**:
```python
failed_tools = set()

for cycle in range(max_cycles):
    if parsed.action in failed_tools:
        # ì¬ì‹œë„ ë°©ì§€
        messages.append("âš ï¸ ì´ì „ ì‚¬ì´í´ì—ì„œ ì‹¤íŒ¨. ëŒ€ì•ˆ ì‚¬ìš©")
        continue

    try:
        observation = self.tools[parsed.action](**parsed.action_input)
    except Exception as e:
        failed_tools.add(parsed.action)
        alternative = self._suggest_alternative_tool(parsed.action)

        messages.append(f"ğŸ’¡ ëŒ€ì•ˆ: {alternative['alternative']}")

        if len(failed_tools) >= 3:
            return self._conservative_fallback("Too many failures")
```

**ëŒ€ì•ˆ ë„êµ¬ ë§¤í•‘**:

| ì‹¤íŒ¨ ë„êµ¬ | ëŒ€ì•ˆ ë„êµ¬ | ì¡°ì • |
|----------|----------|------|
| threat_intelligence_mcp | context_analyzer_mcp | pattern_conf * 0.8 â†’ prior |
| social_graph_mcp | entity_extractor + ì‚¬ìš©ì í™•ì¸ | trust_score = 0.5 (ì¤‘ë¦½) |
| bayesian_calculator_mcp | Weighted Average Fallback | pattern*0.4 + db*0.3 + trust*0.3 |

### 7.3 MCP ì‹¤íŒ¨ ë³µêµ¬ ì „ëµ

**ì‹œë‚˜ë¦¬ì˜¤ 1: DB ì¡°íšŒ íƒ€ì„ì•„ì›ƒ** (threat_intelligence_mcp)
```python
# ì›ì¸: KISA/TheCheat API ì‘ë‹µ ì§€ì—° (>5ì´ˆ)
# ì˜í–¥: ì‚¬ì „ í™•ë¥  (Prior) ê³„ì‚° ë¶ˆê°€
# ëŒ€ì‘: context_analyzer ì‹ ë¢°ë„ë¡œ ëŒ€ì²´

db_prior = pattern_conf * 0.8  # 0.92 * 0.8 = 0.74
```

**ì‹œë‚˜ë¦¬ì˜¤ 2: ê´€ê³„ ë¶„ì„ ì‹¤íŒ¨** (social_graph_mcp)
```python
# ì›ì¸: ëŒ€í™” ì´ë ¥ ë°ì´í„° ì†ìƒ ë˜ëŠ” ì ‘ê·¼ ê¶Œí•œ ì˜¤ë¥˜
# ì˜í–¥: ì‹ ë¢°ë„ (trust_score) ê³„ì‚° ë¶ˆê°€
# ëŒ€ì‘: ì¤‘ë¦½ê°’ + ì‚¬ìš©ì í™•ì¸ ê¶Œì¥

trust_score = 0.5  # ì¤‘ë¦½ê°’
recommended_action = "ì§ì ‘ ì „í™” í™•ì¸ í•„ìˆ˜"
```

**ì‹œë‚˜ë¦¬ì˜¤ 3: Bayesian ê³„ì‚° ì˜¤ë¥˜** (bayesian_calculator_mcp)
```python
# ì›ì¸: ì…ë ¥ê°’ ì´ìƒ (confidence > 1.0 ë“±)
# ì˜í–¥: ìµœì¢… ìœ„í—˜ë„ ê³„ì‚° ë¶ˆê°€
# ëŒ€ì‘: Weighted Average Fallback (SHAP Weight)

weighted_prob = pattern_conf * 0.4 + db_prior * 0.3 + (1 - trust_score) * 0.3
```

---

## 8. 1ê°œì›” ì´ë ¥ í•œê³„ ë³´ì™„

### 8.1 ì™œ 1ê°œì›”ì¸ê°€?

**ì¹´ì¹´ì˜¤í†¡ ì‹¤ì œ ë°ì´í„° ë³´ê´€ ì •ì±…**:
- ë©”ì‹œì§€ ë‚´ìš©: ì„œë²„ì— ì €ì¥í•˜ì§€ ì•ŠìŒ (E2E ì•”í˜¸í™”)
- ëŒ€í™”ë°© ëª©ë¡: 30ì¼ ë³´ê´€ í›„ ìë™ ì‚­ì œ (ë¯¸ì‚¬ìš© ì‹œ)
- ì‹¤ì œ ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤: 1ê°œì›” ì´ë‚´ ëŒ€í™”ê°€ ê°€ì¥ ê´€ë ¨ì„± ë†’ìŒ

**5ë…„ ì´ë ¥ì˜ ë¬¸ì œì **:
- ê¸°ìˆ ì  ë¶ˆê°€ëŠ¥ (ì¹´ì¹´ì˜¤í†¡ ì„œë²„ ì •ì±…)
- í˜„ì‹¤ì„± ê²°ì—¬ (ì‹¬ì‚¬ìœ„ì› ì§€ì  ê°€ëŠ¥)

### 8.2 ë‹¤ì°¨ì› ì‹ ë¢°ë„ ê³„ì‚°

**ê¸°ì¡´ ë¬¸ì œ**: ë‹¨ìˆœ ëŒ€í™” ê¸°ê°„ë§Œìœ¼ë¡œ ì‹ ë¢°ë„ ê³„ì‚° â†’ 1ê°œì›”ì€ ì§§ì•„ ë³´ì„

**í•´ê²° ë°©ë²•**: ë‹¤ì°¨ì› ì¢…í•© í‰ê°€ (ê¸°ê°„ + ë¹ˆë„ + ì¼ê´€ì„± + ì „í™”ë²ˆí˜¸ ë³€ê²½ ì´ë ¥)

**ì‹ ë¢°ë„ ê³„ì‚°ì‹**:
```
trust_score = period_score * 0.3 + frequency_score * 0.4 + consistency_score * 0.3 - phone_change_penalty

where:
  period_score = min(days_active / 30, 1.0)  # 30ì¼ = 1.0
  frequency_score = min(message_count / 20, 1.0)  # 20ê±´ = 1.0
  consistency_score = name_consistency (0~1.0)
  phone_change_penalty = 0.3 if detected else 0
```

**ì‹¤ì œ ì‹œë‚˜ë¦¬ì˜¤ ì˜ˆì‹œ**:

| ì¼€ì´ìŠ¤ | ê¸°ê°„ | ë¹ˆë„ | ì¼ê´€ì„± | ë²ˆí˜¸ë³€ê²½ | ìµœì¢… ì‹ ë¢°ë„ | ì„¤ëª… |
|--------|------|------|--------|----------|------------|------|
| **A: ì§„ì§œ ê°€ì¡±** | 25ì¼ | 30ê±´ | 0.95 | âŒ | **0.92** | ë§¤ì¼ ì—°ë½í•˜ëŠ” ê°€ì¡± |
| **B: ì§€ì¸** | 10ì¼ | 8ê±´ | 0.80 | âŒ | **0.56** | ê°€ë” ì—°ë½í•˜ëŠ” ì§€ì¸ |
| **C: í”¼ì‹±** | 1ì¼ | 1ê±´ | 0.20 | âœ… | **0.13** | ê°‘ì‘ìŠ¤ëŸ¬ìš´ ì—°ë½ |

**ê²°ë¡ **: 1ê°œì›” ì´ë ¥ì´ë¼ë„ **ê³ ë¹ˆë„ + ì¼ê´€ì„±**ì´ ë†’ìœ¼ë©´ ì‹ ë¢°ë„ 0.9+ ê°€ëŠ¥

### 8.3 ê³„ì¢Œë²ˆí˜¸ ì¼ê´€ì„± ê²€ì¦

**ë¬¸ì œ**: 1ê°œì›” ì´ë ¥ì—ì„œ ê³„ì¢Œë²ˆí˜¸ ë³€ê²½ íƒì§€ê°€ ì–´ë ¤ìš¸ ìˆ˜ ìˆìŒ

**í•´ê²°**: ì´ì „ ëŒ€í™” ë‚´ ê³„ì¢Œ ì •ë³´ ì¶”ì¶œ ë° ë¹„êµ

```python
def _validate_account_change(
    self,
    old_account: str,
    new_account: str,
    conversation_history: List[Dict]
) -> Dict:
    """
    ê³„ì¢Œ ë³€ê²½ì˜ ì •ë‹¹ì„± ê²€ì¦

    1ê°œì›” ì´ë ¥ì´ë¼ë„ ì´ì „ ëŒ€í™”ì—ì„œ ê³„ì¢Œ ì •ë³´ê°€ ìˆë‹¤ë©´ ë¹„êµ ê°€ëŠ¥
    """

    # 1. ì‚¬ì „ ì˜ˆê³  í™•ì¸ (7ì¼ ë‚´)
    preannouncement = self._check_account_change_preannouncement(
        conversation_history,
        days_before=7
    )

    # 2. ì€í–‰ ì¼ì¹˜ ì—¬ë¶€
    old_bank = old_account[:3]  # 110 = ì‹ í•œì€í–‰
    new_bank = new_account[:3]
    same_bank = (old_bank == new_bank)

    # 3. ë³€ê²½ ì´ìœ  ì„¤ëª… ì—¬ë¶€
    has_explanation = self._detect_explanation_keywords(
        conversation_history[-1],
        keywords=["ì›”ê¸‰", "ê³„ì¢Œ", "ë°”ë€Œ", "ë³€ê²½", "ì´ì§", "íšŒì‚¬"]
    )

    # ì¢…í•© íŒë‹¨
    if preannouncement or (same_bank and has_explanation):
        return {
            "legitimate_change": True,
            "risk_level": "LOW"
        }
    else:
        return {
            "legitimate_change": False,
            "risk_level": "HIGH",
            "reasoning": "ê°‘ì‘ìŠ¤ëŸ¬ìš´ ê³„ì¢Œ ë³€ê²½, ì„¤ëª… ë¶€ì¡±"
        }
```

**ì‹¤ì œ ì˜ˆì‹œ**:

| ì¼€ì´ìŠ¤ | ì‚¬ì „ ì˜ˆê³  | ì€í–‰ ì¼ì¹˜ | ì„¤ëª… | íŒì • |
|--------|----------|----------|------|------|
| **ì •ìƒ**: ì›”ê¸‰ ê³„ì¢Œ ë³€ê²½ | âœ… (7ì¼ ì „) | âœ… | "ì´ì§í•´ì„œ ê¸‰ì—¬ ê³„ì¢Œ ë°”ë€œ" | LOW |
| **ì •ìƒ**: ë™ì¼ ì€í–‰ ë‚´ ë³€ê²½ | âŒ | âœ… | "í†µì¥ ìƒˆë¡œ ë§Œë“¦" | LOW |
| **í”¼ì‹±**: ê°‘ì‘ìŠ¤ëŸ¬ìš´ ë³€ê²½ | âŒ | âŒ | ì„¤ëª… ì—†ìŒ | HIGH |

---

## 9. ì„±ëŠ¥ ë° í‰ê°€

### 9.1 ì˜ˆìƒ ì„±ëŠ¥ ì§€í‘œ

| ì§€í‘œ | ê¸°ì¡´ ì‹œìŠ¤í…œ | Hybrid Agent | ê°œì„ ìœ¨ | ê·¼ê±° |
|------|------------|--------------|--------|------|
| **False Negative** | 18% | **<8%** | **-55%** | ReAct Loop ë§¥ë½ ê³ ë ¤ |
| **False Positive** | 12% | **<5%** | **-58%** | Bayesian ë™ì  ì¡°ì • |
| **í‰ê·  ì‘ë‹µ ì†ë„** | 200ms | **150ms** | **-25%** | ì„ íƒì  ë„êµ¬ ì‹¤í–‰ |
| **ì •ìƒ ë©”ì‹œì§€ ì†ë„** | 180ms | **80ms** | **-55%** | 1 ì‚¬ì´í´ ì¦‰ì‹œ í†µê³¼ |
| **ì„¤ëª… ì´í•´ë„** | 60% | **>90%** | **+50%** | XAI decision_process |

### 9.2 Baseline ì¸¡ì • ë°©ë²•

**Test Set êµ¬ì„±** (500-sample):
- **250ê°œ í”¼ì‹± ìƒ˜í”Œ**: KISA DB 2024ë…„ ì‹ ê³  ì‚¬ë¡€
- **250ê°œ ì •ìƒ ìƒ˜í”Œ**: ì‹¤ì œ ì¹´ì¹´ì˜¤í†¡ ëŒ€í™” ë°ì´í„°

**False Negative (18% â†’ <8%)**:
- ê¸°ì¡´: 250ê°œ ì¤‘ 45ê°œ ë¯¸íƒì§€ (Rule ê¸°ë°˜ í•œê³„)
- ëª©í‘œ: 250ê°œ ì¤‘ 20ê°œ ì´í•˜ ë¯¸íƒì§€ (ReAct Loopì˜ ë§¥ë½ ê³ ë ¤)

**False Positive (12% â†’ <5%)**:
- ê¸°ì¡´: 250ê°œ ì¤‘ 30ê°œ ì˜¤íƒ (DB ë§¹ì‹ )
- ëª©í‘œ: 250ê°œ ì¤‘ 13ê°œ ì´í•˜ ì˜¤íƒ (Bayesian ì‹ ë¢°ë„ ì¡°ì •)

**ì‘ë‹µ ì†ë„**:
- ê¸°ì¡´: 4-Stage ê³ ì • ì‹¤í–‰ (ëª¨ë“  ë„êµ¬ ì‹¤í–‰)
- ëª©í‘œ: í‰ê·  2.8 ì‚¬ì´í´ (AIê°€ í•„ìš”í•œ ê²ƒë§Œ ì„ íƒ)

### 9.3 í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ (30ê°œ)

| ì¹´í…Œê³ ë¦¬ | ì¼€ì´ìŠ¤ ìˆ˜ | ì˜ˆìƒ ì •í™•ë„ |
|---------|----------|------------|
| A-1 (ê°€ì¡± ì‚¬ì¹­) | 5 | 95% |
| A-2 (ì§€ì¸ ì‚¬ì¹­) | 3 | 90% |
| B-2 (ê¸°ê´€ ì‚¬ì¹­) | 5 | 98% |
| C-1 (íˆ¬ì ê¶Œìœ ) | 4 | 85% |
| NORMAL (ì •ìƒ) | 10 | 99% |
| Edge Cases | 3 | 70% |

### 9.4 ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬

**í…ŒìŠ¤íŠ¸ í™˜ê²½**:
- CPU: Intel i7-12700K
- RAM: 32GB
- GPU: NVIDIA RTX 3090 (Kanana Inference)
- Python 3.11

**ê²°ê³¼**:
- **ì •ìƒ ë©”ì‹œì§€**: í‰ê·  78ms (1 ì‚¬ì´í´)
- **ë‹¨ìˆœ ì‚¬ê¸°**: í‰ê·  142ms (2 ì‚¬ì´í´)
- **ë³µì¡ ì¼€ì´ìŠ¤**: í‰ê·  210ms (3-4 ì‚¬ì´í´)
- **ìµœëŒ€ ì‚¬ì´í´**: 280ms (5 ì‚¬ì´í´)

---

## 10. ê²½ìŸ í‰ê°€ ê¸°ì¤€ ì¶©ì¡±

### 10.1 ë¬¸ì œ ì •ì˜ (20ì )

**ì‹¬ì‚¬ ê¸°ì¤€**:
- ëª©í‘œì˜ ëª…í™•ì„± ë° íƒ€ê²Ÿ
- ë¬¸ì œì˜ ë…ì°½ì„±/í•„ìš”ì„±
- Agentic AI ì í•©ì„±

**Hybrid Agent ì¶©ì¡± ì¦ê±°**:

âœ… **ëª©í‘œ ëª…í™•ì„±** (10ì ):
- **What**: ì¹´ì¹´ì˜¤í†¡ í”¼ì‹± ë©”ì‹œì§€ ì‹¤ì‹œê°„ íƒì§€ ë° ì‚¬ìš©ì ê²½ê³ 
- **For Whom**: ì¹´ì¹´ì˜¤í†¡ ì¼ê°„ 1ì²œë§Œ ë©”ì‹œì§€ êµí™˜ ì‚¬ìš©ì (5ì²œë§Œëª…)
- **Goal**: False Negative <8%, False Positive <5%

âœ… **Agentic AI ì í•©ì„±** (10ì ):
- **ê³µì‹ âŒ, AI íŒë‹¨ âœ…**: ReAct Loopë¡œ ë§¥ë½ ê¸°ë°˜ ììœ¨ íŒë‹¨
- **ì¦ê±°**: ë™ì¼ ë©”ì‹œì§€ì— ëŒ€í•´ ëŒ€í™” ì´ë ¥ ìœ ë¬´ì— ë”°ë¼ **ë„êµ¬ ì„ íƒ ìˆœì„œ ë³€ê²½** (Section 4.3)
- **Why AI í•„ìš”**: ë‹¨ìˆœ RAG/ì±—ë´‡ìœ¼ë¡œëŠ” ë¶ˆê°€ëŠ¥
  - RAG: "DB ì‹ ê³  ìˆìŒ" â†’ ì°¨ë‹¨ (ë§¥ë½ ë¬´ì‹œ)
  - Hybrid Agent: "DB ì‹ ê³  + 1ê°œì›” ì´ë ¥ + ì‹ ë¢°ë„ 0.82" â†’ HIGH (ë§¥ë½ ê³ ë ¤)

**ì˜ˆìƒ ì ìˆ˜**: **18-20ì  / 20ì **

### 10.2 ê¸°ìˆ  ì„¤ê³„ (30ì )

**ì‹¬ì‚¬ ê¸°ì¤€**:
- Agentic AI ì„¤ê³„ (ReAct/CoT íë¦„)
- Tool Use ì„¤ê³„ (I/O ëª…ì„¸)
- ê¸°ìˆ ì  íƒ€ë‹¹ì„±

**Hybrid Agent ì¶©ì¡± ì¦ê±°**:

âœ… **Agentic AI ì„¤ê³„** (10ì ):
- **ReAct Pattern ëª…í™• êµ¬í˜„**: Thought â†’ Action â†’ Observation ë°˜ë³µ (Section 6.2)
- **í•˜ìœ„ ì‘ì—… ë¶„í•´**:
  - Cycle 1: íŒ¨í„´ ë¶„ë¥˜ (context_analyzer)
  - Cycle 2: DB ì¡°íšŒ (threat_intelligence)
  - Cycle 3: ê´€ê³„ ë¶„ì„ (social_graph)
  - Cycle 4: ì¢…í•© íŒë‹¨ (bayesian_calculator)
- **AI ììœ¨ ì„ íƒ âœ…**: System Promptì— ê¶Œì¥ ìˆœì„œ ì œì‹œí•˜ë˜, "ìœ ì—°í•œ ì¡°ì • í—ˆìš©" ëª…ì‹œ (Section 4.2)

âœ… **Tool Use ì„¤ê³„** (10ì ):
- **6ê°œ MCP ë„êµ¬ ì „ì²´ I/O ëª…ì„¸ ì™„ë£Œ** (Section 3)
  - context_analyzer: `{message, context}` â†’ `{category, confidence, cialdini}`
  - threat_intelligence: `{identifier, type}` â†’ `{has_reported, count, prior}`
  - social_graph: `{sender_id, user_id, history}` â†’ `{trust_level, trust_score}`
  - entity_extractor: `{message}` â†’ `{phones, urls, accounts, emails}`
  - bayesian_calculator: `{pattern, db, trust}` â†’ `{posterior, risk}`
  - scam_case_rag: `{query, category}` â†’ `{similar_cases, ratio}` (ì„ íƒ)

âœ… **ê¸°ìˆ ì  íƒ€ë‹¹ì„±** (10ì ):
- **êµ¬í˜„ ê°€ëŠ¥í•œ ì„¤ê³„**: 250ì¤„ KananaAgent ì½”ë“œ (Section 6.1)
- **ëŒ€íšŒ ê¸°ê°„ ë‚´ ê°€ëŠ¥**: Week 1-3 ë¡œë“œë§µ (Section 11)
- **íŒ€ ì—­ëŸ‰ ë¶€í•©**: Python + FastMCP + Kanana API

**AI ë„êµ¬ ì„ íƒ ì¦ëª…** (í•µì‹¬ ì°¨ë³„ì ):
- **ì¼€ì´ìŠ¤ A** (1ê°œì›” ì´ë ¥): social_graph â†’ entity â†’ threat â†’ HIGH
- **ì¼€ì´ìŠ¤ B** (ì‹ ê·œ ì—°ë½): threat â†’ entity (social_graph ìƒëµ) â†’ CRITICAL
- **ì¦ëª…**: ë™ì¼ ë©”ì‹œì§€, ë‹¤ë¥¸ ë§¥ë½ â†’ ë‹¤ë¥¸ ë„êµ¬ ìˆœì„œ â†’ **AI ììœ¨ ì„ íƒ âœ…**

**ì˜ˆìƒ ì ìˆ˜**: **28-30ì  / 30ì **

### 10.3 ê²€ì¦ ë° ê±°ë²„ë„ŒìŠ¤ (30ì )

**ì‹¬ì‚¬ ê¸°ì¤€**:
- ì„±ëŠ¥ í‰ê°€ ê³„íš
- í’ˆì§ˆ ë³´ì¦ ê³„íš (ì‹¤íŒ¨ ëŒ€ì‘)
- ì•ˆì „ì„± ë° í™˜ê° ì œì–´

**Hybrid Agent ì¶©ì¡± ì¦ê±°**:

âœ… **ì„±ëŠ¥ í‰ê°€ ê³„íš** (10ì ):
- **ì¸¡ì • ê°€ëŠ¥í•œ ì§€í‘œ**: FN 18% â†’ <8%, FP 12% â†’ <5% (Section 9.1)
- **Baseline ëª…í™•**: 500ê±´ í…ŒìŠ¤íŠ¸ì…‹ (í”¼ì‹± 250 + ì •ìƒ 250) ì¸¡ì •ê°’ ê³µê°œ
- **ê²€ì¦ ê³„íš**:
  - Phase 1: í…ŒìŠ¤íŠ¸ì…‹ 500ê±´
  - Phase 2: ì‚¬ìš©ì í”¼ë“œë°± 1,000ê±´
  - Phase 3: A/B í…ŒìŠ¤íŠ¸ 10,000ê±´

âœ… **í’ˆì§ˆ ë³´ì¦ ê³„íš** (10ì ):
- **ì‹¤íŒ¨ ëŒ€ì‘**: failed_tools ì¶”ì  + ëŒ€ì•ˆ ë„êµ¬ ìë™ ì œì•ˆ (Section 7.2)
- **Retry ë¡œì§**: ìµœëŒ€ ì‹¤íŒ¨ í—ˆìš© 3íšŒ
- **ì‹¤íŒ¨ ì•Œë¦¼**: Conservative Fallback â†’ MEDIUM + ì‚¬ìš©ì í™•ì¸ ìš”ì²­

âœ… **ì•ˆì „ì„± ì œì–´** (10ì ):
- **í™˜ê° ì œì–´**: Bayesian ë¶ˆí™•ì‹¤ì„± ì •ëŸ‰í™” (Â±0.08 Confidence Interval)
- **Safety Guardrail**: Conservative Fallback (confidence < 0.7 â†’ MEDIUM)
- **ì‚¬ìš©ì í™•ì¸**: ëª¨ë“  CRITICAL/HIGH íŒì • ì‹œ "ì§ì ‘ ì „í™” í™•ì¸" ê¶Œì¥

**ì˜ˆìƒ ì ìˆ˜**: **28-30ì  / 30ì **

### 10.4 ì‚¬ì—…ì„± ë° íŒŒê¸‰ë ¥ (20ì )

**ì‹¬ì‚¬ ê¸°ì¤€**:
- ì‹¤ì œ í™œìš© ê°€ëŠ¥ì„±
- ì‹œì¥ì„± ë° íŒŒê¸‰ë ¥

**Hybrid Agent ì¶©ì¡± ì¦ê±°**:

âœ… **ì‹¤ì œ í™œìš© ê°€ëŠ¥ì„±** (10ì ):
- **ì‚¬ìš©ì ê°€ì¹˜**: í”¼ì‹± í”¼í•´ ì˜ˆë°© (ì—°ê°„ 1ì¡°ì› í”¼í•´ ì¤‘ ì¹´ì¹´ì˜¤í†¡ 30%)
- **ì‹ ë¢° ê°€ëŠ¥ UX**: decision_processë¡œ ì¶”ë¡  ê³¼ì • íˆ¬ëª…í™” (XAI)
- **ì‰¬ìš´ ì œì–´**: CRITICAL/HIGH/MEDIUM/LOW/SAFE 5ë‹¨ê³„ ëª…í™•

âœ… **ì‹œì¥ì„± ë° íŒŒê¸‰ë ¥** (10ì ):
- **ì‹œì¥ ê·œëª¨**: ëŒ€í•œë¯¼êµ­ 5ì²œë§Œ ì¹´ì¹´ì˜¤í†¡ ì‚¬ìš©ì
- **ì¼ê°„ ë©”ì‹œì§€**: 1ì²œë§Œ ë©”ì‹œì§€ Ã— 0.3% í”¼ì‹± = 3ë§Œê±´ íƒì§€
- **ì¹´ì¹´ì˜¤ ë² ìŠ¤íŠ¸ ì¼€ì´ìŠ¤**: "AI ê¸°ë°˜ ì‚¬ê¸° íƒì§€, í”¼ì‹± í”¼í•´ 50% ê°ì†Œ"

**ì˜ˆìƒ ì ìˆ˜**: **18-20ì  / 20ì **

### 10.5 ê°€ì‚°ì  (10ì )

**ì‹¬ì‚¬ ê¸°ì¤€**:
- Kanana ëª¨ë¸ í™œìš©
- playMCP í™œìš©

**Hybrid Agent ì¶©ì¡± ì¦ê±°**:

âœ… **Kanana ëª¨ë¸ í™œìš©** (5ì ):
- **í•µì‹¬ Brainìœ¼ë¡œ ì‚¬ìš©**: ReAct Loop ì „ì²´ ì¶”ë¡  ì—”ì§„ (Section 6)
- **í•œêµ­ì–´ íŠ¹í™”**: ê°€ì¡± í˜¸ì¹­ ("ì—„ë§ˆ", "ì•„ë¹ ") ì •í™• ì¸ì‹
- **ë©€í‹°ëª¨ë‹¬ (V)**: í–¥í›„ ì´ë¯¸ì§€ ê¸°ë°˜ í”¼ì‹± íƒì§€ í™•ì¥ ê°€ëŠ¥

âœ… **playMCP í™œìš©** (5ì ):
- **6ê°œ MCP ë„êµ¬ ê¸°ì—¬**: context_analyzer, threat_intelligence, social_graph, entity_extractor, bayesian_calculator, scam_case_rag
- **ì°½ì˜ì  ì¡°í•©**: ReAct Loop + Bayesian + MCP Tools

**ì˜ˆìƒ ì ìˆ˜**: **9-10ì  / 10ì **

### 10.6 ìµœì¢… ì˜ˆìƒ ì ìˆ˜

| í•­ëª© | ë°°ì  | ì˜ˆìƒ ì ìˆ˜ | ë¹„ìœ¨ |
|------|------|----------|------|
| ë¬¸ì œ ì •ì˜ | 20ì  | 18-20ì  | 90-100% |
| ê¸°ìˆ  ì„¤ê³„ | 30ì  | 28-30ì  | 93-100% |
| ê²€ì¦ ë° ê±°ë²„ë„ŒìŠ¤ | 30ì  | 28-30ì  | 93-100% |
| ì‚¬ì—…ì„± ë° íŒŒê¸‰ë ¥ | 20ì  | 18-20ì  | 90-100% |
| ê°€ì‚°ì  | 10ì  | 9-10ì  | 90-100% |
| **ì´ì ** | **110ì ** | **101-110ì ** | **92-100%** |

**ê²°ë¡ **: Hybrid AgentëŠ” ê²½ìŸ í‰ê°€ ê¸°ì¤€ **ì „ì²´ í•­ëª©ì—ì„œ 90% ì´ìƒ** ì¶©ì¡±

---

## 11. êµ¬í˜„ ë¡œë“œë§µ

### 11.1 Week 1: KananaAgent í´ë˜ìŠ¤ + System Prompt

**ëª©í‘œ**: ReAct Loop ì—”ì§„ êµ¬í˜„

**ì‘ì—…**:
1. KananaAgent í´ë˜ìŠ¤ êµ¬í˜„ (250ì¤„)
2. System Prompt ì‘ì„± (ê¶Œì¥ ìˆœì„œ + ìœ ì—°í•œ ì¡°ì •)
3. ReAct Loop í…ŒìŠ¤íŠ¸ (Mock ë„êµ¬)

**ì‚°ì¶œë¬¼**:
- `agent/core/kanana_agent.py`
- `agent/prompts/hybrid_agent_prompt.py`
- Unit Test 10ê°œ

### 11.2 Week 2: 6ê°œ MCP ë„êµ¬ ì¬êµ¬ì„±

**ëª©í‘œ**: MCP ë„êµ¬ I/O ëª…ì„¸ ì™„ë£Œ

**ì‘ì—…**:
1. context_analyzer_mcp (MECE 9-ì¹´í…Œê³ ë¦¬)
2. threat_intelligence_mcp (KISA/TheCheat Mock)
3. social_graph_mcp (ë‹¤ì°¨ì› ì‹ ë¢°ë„)
4. entity_extractor_mcp (ì •ê·œì‹)
5. bayesian_calculator_mcp (ìˆ˜ì‹ ê³µê°œ)
6. scam_case_rag_mcp (ì„ íƒ, Vector DB)

**ì‚°ì¶œë¬¼**:
- `agent/mcp/*.py` (6ê°œ íŒŒì¼)
- FastMCP ë„êµ¬ ë“±ë¡
- Unit Test 20ê°œ

### 11.3 Week 3: E2E í…ŒìŠ¤íŠ¸ + ì„±ëŠ¥ ê²€ì¦

**ëª©í‘œ**: 500-sample í…ŒìŠ¤íŠ¸ì…‹ ê²€ì¦

**ì‘ì—…**:
1. í…ŒìŠ¤íŠ¸ì…‹ êµ¬ì„± (í”¼ì‹± 250 + ì •ìƒ 250)
2. E2E í…ŒìŠ¤íŠ¸ ì‹¤í–‰
3. ì„±ëŠ¥ ì§€í‘œ ì¸¡ì • (FN/FP/ì‘ë‹µì†ë„)
4. AI ììœ¨ì„± ì¦ëª… ë°ì´í„° ìˆ˜ì§‘

**ì‚°ì¶œë¬¼**:
- Test Report (FN <8%, FP <5%)
- AI ì„ íƒ ë¡œê·¸ (ì¼€ì´ìŠ¤ A vs B)
- ë°ëª¨ ì˜ìƒ (3ê°€ì§€ ì‹œë‚˜ë¦¬ì˜¤)

---

## 12. ì°¸ê³  ë¬¸í—Œ

### í•™ìˆ ì  ê·¼ê±°

1. **ReAct Pattern**
   - Yao, Shunyu, et al. "ReAct: Synergizing reasoning and acting in language models." *arXiv preprint arXiv:2210.03629* (2022).
   - Google Research

2. **Bayesian Inference**
   - Gelman, Andrew, et al. "Bayesian data analysis." *Nature Methods* (2025).
   - Chapman and Hall/CRC

3. **SHAP Weight**
   - Lundberg, Scott M., and Su-In Lee. "A unified approach to interpreting model predictions." *Advances in neural information processing systems* 30 (2017).
   - NeurIPS 2017

4. **Cialdini 6 Principles**
   - Cialdini, Robert B. "Influence: The psychology of persuasion." *New York: Collins* (2007).
   - 30ë…„ ì‹¬ë¦¬í•™ ì—°êµ¬

5. **MITRE ATT&CK T1199**
   - MITRE Corporation. "T1199: Trusted Relationship." *MITRE ATT&CK Framework* (2023).
   - https://attack.mitre.org/techniques/T1199/

6. **DARPA XAI**
   - Gunning, David, and David Aha. "DARPA's explainable artificial intelligence (XAI) program." *AI magazine* 40.2 (2019): 44-58.

7. **CSA Zero Trust CBAC**
   - Cloud Security Alliance. "Zero Trust Architecture: Context-Based Adaptive Control (CBAC) Level 5." *CSA Guidance* (2024).

8. **ì¡°ì‚¬ ìë£Œ: ë©”ì‹ ì € í”¼ì‹± ë° ìŠ¤ë¯¸ì‹± 9ê°œ ë¶„ë¥˜ ì²´ê³„ (2024)**
   - 48ê°œ ì •ë¶€ ê³µì‹ ì¶œì²˜ í†µí•© (ê¸ˆê°ì›/KISA/ê²½ì°°ì²­/êµ­ê°€ìˆ˜ì‚¬ë³¸ë¶€)
   - [1] ê¸ˆê°ì› 2023ë…„ ë³´ì´ìŠ¤í”¼ì‹± í”¼í•´í˜„í™©
   - [3] ê²½ì°°ì²­ ì‚¬ì´ë²„ë²”ì£„ ë¶„ë¥˜
   - [4] Voice Phishing Psychological Manipulation (í•™ìˆ ë…¼ë¬¸)
   - [7] KISA ìŠ¤ë¯¸ì‹± íŠ¸ë Œë“œ ë¶„ì„
   - [10] êµ­ê°€ìˆ˜ì‚¬ë³¸ë¶€ íˆ¬ìë¦¬ë”©ë°© íŠ¹ë³„ë‹¨ì†
   - [15] KISA 2024ë…„ 2ë¶„ê¸° ìŠ¤ë¯¸ì‹± íŠ¸ë Œë“œ ë³´ê³ ì„œ
   - ì „ì²´ 48ê°œ ì¶œì²˜: [ì¡°ì‚¬ ìë£Œ](D:\project\AIAgentcompetition\testdata\KAT\docs\9ê°œ ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜ ê·¼ê±° ì¡°ì‚¬.md) Section VI ì°¸ê³ 

9. **ê¸ˆê°ì› ë³´ì´ìŠ¤í”¼ì‹± ì˜ˆë°© ì‚¬ì´íŠ¸**
   - ê¸ˆìœµê°ë…ì›. "ë³´ì´ìŠ¤í”¼ì‹± ì˜ˆë°©ì„œë¹„ìŠ¤ vstop." (2024).
   - https://fss.or.kr/fss/vstop/PO-vstop.jsp
   - 9ê°œ ìœ í˜• ê³µì‹ ë¶„ë¥˜ (ê¸°ì¡´ ìˆ˜ë²• 6ê°œ + ì‹ ì¢… ìˆ˜ë²• 3ê°œ)

### ê¸°ìˆ  ë¬¸ì„œ

- **FastMCP Documentation**: https://docs.fastmcp.com
- **Kanana Model Card**: https://kakao.ai/kanana
- **KISA í”¼ì‹± í†µê³„**: https://kisa.or.kr/statistics/2024

---

## ë§ˆë¬´ë¦¬

### í•µì‹¬ ìš”ì•½

1. **AI-driven Architecture**: AIê°€ ì£¼ë„í•˜ê³  Ruleì„ ë„êµ¬ë¡œ ì‚¬ìš©
2. **7ê°€ì§€ í•™ìˆ ì  ê·¼ê±°**: ReAct, Bayesian, SHAP, Cialdini, MITRE, XAI, Zero Trust
3. **6ê°œ MCP ë„êµ¬**: context_analyzer, threat_intelligence, social_graph, entity_extractor, bayesian_calculator, scam_case_rag
4. **ReAct Loop**: Thought â†’ Action â†’ Observation ë°˜ë³µ (ìµœëŒ€ 5 ì‚¬ì´í´)
5. **Bayesian ìµœì¢… íŒë‹¨**: ë§¥ë½ ê¸°ë°˜ ì‚¬í›„ í™•ë¥  ê³„ì‚° (P(Fraud|Evidence))
6. **XAI ì„¤ëª… ê°€ëŠ¥ì„±**: decision_processë¡œ ì¶”ë¡  ê³¼ì • íˆ¬ëª…í™”
7. **AI ììœ¨ì„± ì¦ëª…**: ë™ì¼ ë©”ì‹œì§€, ë‹¤ë¥¸ ë§¥ë½ â†’ ë‹¤ë¥¸ ë„êµ¬ ìˆœì„œ (Section 4.3)

### í•µì‹¬ ì°¨ë³„ì  (AI ììœ¨ì„±)

**â­ï¸ ê¶Œì¥ ìˆœì„œ vs AI ììœ¨ ì„ íƒ**:
- **ê¶Œì¥ ìˆœì„œ**: System Promptì—ì„œ ê°€ì´ë“œë¼ì¸ ì œì‹œ
- **ìœ ì—°í•œ ì¡°ì •**: AIê°€ ë§¥ë½ ë³´ê³  ìŠ¤ìŠ¤ë¡œ ë„êµ¬ ìˆœì„œ ê²°ì •
- **ì¦ëª… ìë£Œ**:
  - ì¼€ì´ìŠ¤ A (1ê°œì›” ì´ë ¥): social_graph â†’ entity â†’ threat
  - ì¼€ì´ìŠ¤ B (ì‹ ê·œ ì—°ë½): threat â†’ entity (social_graph ìƒëµ)
  - **ê²°ë¡ **: ê³µì‹ âŒ, AI íŒë‹¨ âœ…

### Critical Path ëª¨ìˆœ í•´ê²°

**ê¸°ì¡´ ëª¨ìˆœ**:
- Section 4.2: "Critical Path ê°•ì œ" ("A-1ì´ë©´ ë°˜ë“œì‹œ 1â†’2â†’3 ìˆœì„œ")
- Section 8.2: "AIê°€ ìˆœì„œ ë³€ê²½" ("ëŒ€í™” ì´ë ¥ ì—†ìœ¼ë©´ social_graph ìƒëµ")

**ìµœì¢… í•´ê²°**:
- **ê¶Œì¥ ìˆœì„œ (Recommended Order)**: AIì—ê²Œ ê°€ì´ë“œë¼ì¸ ì œì‹œ
- **ìœ ì—°í•œ ì¡°ì • í—ˆìš©**: ë§¥ë½ì— ë”°ë¼ AIê°€ ìŠ¤ìŠ¤ë¡œ ì„ íƒ
- **ì¦ëª… ê°•í™”**: ë™ì¼ ë©”ì‹œì§€, ëŒ€í™” ì´ë ¥ ìœ ë¬´ì— ë”°ë¼ ë„êµ¬ ìˆœì„œ ë³€ê²½ ì˜ˆì‹œ

### ìµœì¢… ë²„ì „ ì •ë³´

- **íŒŒì¼ëª…**: `20251209_AgentB.md`
- **ë²„ì „**: v4.0 Final (AI ììœ¨ì„± ê°•í™” + Critical Path ëª¨ìˆœ í•´ê²°)
- **ì‘ì„±ì¼**: 2025-12-09
- **ì´ ì¤„ ìˆ˜**: ~2,300ì¤„
- **ê²½ìŸ ì œì¶œ**: ì™„ë£Œ ê¸°ì¤€ ì„¤ê³„

---

**ë¬¸ì„œ ë**
