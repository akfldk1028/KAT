# Agent B ì ìˆ˜í™” ë°©ë²•ë¡  (Scoring Methodology)

**ìž‘ì„±ì¼**: 2025-12-06
**ë²„ì „**: 2.0 (Scenario 1 - ì ì§„ì  ê°œì„ )
**ëŒ€ìƒ**: ìˆ˜ì‹  ë©”ì‹œì§€ ì‚¬ê¸°/í”¼ì‹± íƒì§€ ì‹œìŠ¤í…œ

---

## ðŸ“‹ ëª©ì°¨

1. [ê°œìš”](#ê°œìš”)
2. [í˜„ìž¬ ì‹œìŠ¤í…œ ë¶„ì„](#í˜„ìž¬-ì‹œìŠ¤í…œ-ë¶„ì„)
3. [ë¬¸ì œì  ë° ê°œì„  í•„ìš”ì‚¬í•­](#ë¬¸ì œì -ë°-ê°œì„ -í•„ìš”ì‚¬í•­)
4. [ê°œì„  ì œì•ˆ ë¡œì§](#ê°œì„ -ì œì•ˆ-ë¡œì§)
5. [ìˆ˜í•™ì  ê³µì‹](#ìˆ˜í•™ì -ê³µì‹)
6. [í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤](#í…ŒìŠ¤íŠ¸-ì‹œë‚˜ë¦¬ì˜¤)
7. [ì˜ˆìƒ íš¨ê³¼](#ì˜ˆìƒ-íš¨ê³¼)
8. [êµ¬í˜„ ê³„íš](#êµ¬í˜„-ê³„íš)

---

## ê°œìš”

### Agent Bì˜ ì—­í• 
- **ëª©ì **: ìˆ˜ì‹  ë©”ì‹œì§€ì—ì„œ ì‚¬ê¸°/í”¼ì‹± íŒ¨í„´ íƒì§€
- **ìž…ë ¥**: ìˆ˜ì‹  ë¬¸ìžë©”ì‹œì§€, URL, ë°œì‹ ìž ì •ë³´
- **ì¶œë ¥**: ìœ„í—˜ë„ ì ìˆ˜ (0-100%), ìœ„í—˜ ë ˆë²¨ (SAFE/LOW/MEDIUM/HIGH/CRITICAL), ê¶Œìž¥ ì¡°ì¹˜

### 4ë‹¨ê³„ íŒŒì´í”„ë¼ì¸

```
[Stage 1]           [Stage 2]           [Stage 3]           [Stage 4]
í…ìŠ¤íŠ¸ íŒ¨í„´ ë¶„ì„  â†’  ì‹ ê³  DB ì¡°íšŒ  â†’  ë°œì‹ ìž ì‹ ë¢°ë„ í‰ê°€  â†’  ìµœì¢… ì •ì±… ê²°ì •
(threat_matcher)    (scam_db)         (sender_trust)        (action_policy)
```

### MECE 9-Category ë¶„ë¥˜ ì²´ê³„

| ì¹´í…Œê³ ë¦¬ | ì„¤ëª… | ë² ì´ìŠ¤ ì ìˆ˜ |
|---------|------|------------|
| **A-1** | ê°€ì¡±/ì§€ì¸ ì‚¬ì¹­ (ëª…ì‹œ) | 95ì  |
| **A-2** | ê¸°ê´€/ì—…ì²´ ì‚¬ì¹­ (ëª…ì‹œ) | 90ì  |
| **A-3** | íˆ¬ìž/ìˆ˜ìµ ì‚¬ê¸° (ëª…ì‹œ) | 85ì  |
| **B-1** | ê°€ì¡±/ì§€ì¸ ì‚¬ì¹­ (ì•”ë¬µ) | 80ì  |
| **B-2** | ê¸°ê´€/ì—…ì²´ ì‚¬ì¹­ (ì•”ë¬µ) | 75ì  |
| **B-3** | íˆ¬ìž/ìˆ˜ìµ ì‚¬ê¸° (ì•”ë¬µ) | 70ì  |
| **C-1** | ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ìš”ì²­ | 60ì  |
| **C-2** | í”¼ì‹± ì˜ì‹¬ ë§í¬/ì—°ë½ì²˜ | 65ì  |
| **C-3** | ì¼ë°˜ ìŠ¤íŒ¸ | 40ì  |

---

## í˜„ìž¬ ì‹œìŠ¤í…œ ë¶„ì„

### Stage 1: í…ìŠ¤íŠ¸ íŒ¨í„´ ë¶„ì„ (í˜„ìž¬ ë°©ì‹)

#### ì ìˆ˜ ê³„ì‚° ê³µì‹ (ê¸°ì¡´)
```python
# 1ë‹¨ê³„: ë² ì´ìŠ¤ ì ìˆ˜ (ì¹´í…Œê³ ë¦¬ë³„)
base_score = matched_category.base_score  # 40~95ì 

# 2ë‹¨ê³„: ë©€í‹°í”Œë¼ì´ì–´ ëˆ„ì  (ê³±ì…ˆ ë°©ì‹)
multiplier = 1.0

if len(matched_patterns) > 1:
    multiplier *= 1.3  # ë³µìˆ˜ íŒ¨í„´ ë§¤ì¹­

if has_url:
    multiplier *= 1.2  # URL í¬í•¨

if has_phone_number:
    multiplier *= 1.15  # ì „í™”ë²ˆí˜¸ í¬í•¨

if has_money_amount:
    multiplier *= 1.2  # ê¸ˆì•¡ í¬í•¨

if has_urgency:
    multiplier *= 1.2  # ê¸´ê¸‰ì„± ì–¸ì–´

# 3ë‹¨ê³„: ìµœì¢… ì ìˆ˜
final_score = base_score * confidence_score * multiplier * context_penalty

# 4ë‹¨ê³„: ìƒí•œì„  ì ìš©
final_score = min(final_score, 100)
```

#### í˜„ìž¬ ë°©ì‹ì˜ ë™ìž‘ ì˜ˆì‹œ

**ì˜ˆì‹œ 1: ê°€ì¡± ì‚¬ì¹­ ë©”ì‹œì§€**
```
ë©”ì‹œì§€: "ì—„ë§ˆ, ë‚˜ í° ì•¡ì • ê¹¨ì ¸ì„œ ê¸‰í•´. ì´ ë§í¬ ê¹”ì•„ì¤˜ bit.ly/xxx"

ê³„ì‚°:
base_score = 95 (A-1 ì¹´í…Œê³ ë¦¬)
confidence = 1.0 (ëª…ì‹œì  íŒ¨í„´)
multiplier = 1.2 (url) Ã— 1.2 (urgency) = 1.44
context_penalty = 1.0

final = 95 Ã— 1.0 Ã— 1.44 Ã— 1.0 = 136.8 â†’ cap 100
ê²°ê³¼: 100% (CRITICAL)
```

**ì˜ˆì‹œ 2: ë³µí•© ìœ„í—˜ ìš”ì†Œ**
```
ë©”ì‹œì§€: "ì—„ë§ˆ ê¸‰í•´ bit.ly/xxx 010-1234-5678 300ë§Œì› ë³´ë‚´ì¤˜"

ê³„ì‚°:
base_score = 95
multiplier = 1.3 (ë³µìˆ˜) Ã— 1.2 (url) Ã— 1.15 (phone) Ã— 1.2 (money) Ã— 1.2 (urgency)
          = 2.74

final = 95 Ã— 1.0 Ã— 2.74 Ã— 1.0 = 260.3 â†’ cap 100
ê²°ê³¼: 100% (CRITICAL)
```

### Stage 4: ìµœì¢… ì •ì±… ê²°ì • (í˜„ìž¬ ë°©ì‹)

#### í˜„ìž¬ í†µí•© ë°©ì‹
```python
# max() ì—°ì‚° ì‚¬ìš©
final_score = max(
    stage1_text_score,      # í…ìŠ¤íŠ¸ íŒ¨í„´ ë¶„ì„ ê²°ê³¼
    stage2_scam_db_score    # ì‹ ê³  DB ì¡°íšŒ ê²°ê³¼
)

# Stage 3ëŠ” ì¡°ì •ê°’ìœ¼ë¡œë§Œ ì‚¬ìš©
final_score += sender_trust_adjustment  # -20 ~ +30
```

---

## ë¬¸ì œì  ë° ê°œì„  í•„ìš”ì‚¬í•­

### ë¬¸ì œ 1: ë©€í‹°í”Œë¼ì´ì–´ ê³¼ë‹¤ ëˆ„ì  (Multiplier Over-Accumulation)

**ì¦ìƒ**:
- ëª¨ë“  ë©€í‹°í”Œë¼ì´ì–´ê°€ ì¶©ì¡±ë˜ë©´ ì ìˆ˜ê°€ ê¸‰ê²©ížˆ ìƒìŠ¹ (Ã—2.74)
- ìƒí•œì„ (100ì ) ë„ë‹¬ë¡œ ë³€ë³„ë ¥ ì†ì‹¤
- ê³ ìœ„í—˜ ë©”ì‹œì§€ë“¤ì´ ëª¨ë‘ 100ì ìœ¼ë¡œ ìˆ˜ë ´

**ì˜ˆì‹œ**:
```
ë©”ì‹œì§€ A: "ì—„ë§ˆ ê¸‰í•´ ë§í¬ ê¹”ì•„ì¤˜ bit.ly/xxx"
â†’ 95 Ã— 1.2 Ã— 1.2 = 136.8 â†’ 100ì 

ë©”ì‹œì§€ B: "ì—„ë§ˆ ê¸‰í•´ bit.ly/xxx 010-1234-5678 300ë§Œì›"
â†’ 95 Ã— 2.74 = 260.3 â†’ 100ì 

ë¬¸ì œ: Aì™€ Bì˜ ìœ„í—˜ë„ê°€ ëª…í™•ížˆ ë‹¤ë¦„ì—ë„ ë™ì¼í•œ 100ì 
```

**ê·¼ë³¸ ì›ì¸**:
- ê³±ì…ˆ ë°©ì‹ì€ ìš”ì†Œê°€ ë§Žì„ìˆ˜ë¡ ë¹„ì„ í˜•ì ìœ¼ë¡œ ì¦ê°€
- ìƒí•œì„ (100ì )ì´ ë„ˆë¬´ ë‚®ì•„ ë³€ë³„ë ¥ ìƒì‹¤

---

### ë¬¸ì œ 2: ì»¨í…ìŠ¤íŠ¸ íŒ¨ë„í‹° ê³¼ë„ (Harsh Context Penalty)

**ì¦ìƒ**:
- ë†ë‹´/ì¹œê·¼í•œ í‘œí˜„(ã…‹ã…‹, ã…Žã…Ž) ê°ì§€ ì‹œ ì ìˆ˜ Ã—0.5ë¡œ ê¸‰ê°
- False Positive(ì •ìƒì„ ì‚¬ê¸°ë¡œ ì˜¤íƒ) ê°ì†Œì—ëŠ” íš¨ê³¼ì ì´ë‚˜, ê³¼ë„í•¨

**ì˜ˆì‹œ**:
```
ë©”ì‹œì§€: "ì—„ë§ˆ ã…‹ã…‹ ë‚˜ ìƒˆ í° ìƒ€ì–´ ã…Žã…Ž"

ê³„ì‚°:
base_score = 95
confidence = 0.3 (ë‚®ì€ í™•ì‹ ë„)
multiplier = 0.5 (ã…‹ã…‹ íŒ¨ë„í‹°)
context_penalty = 0.5 (ã…Žã…Ž íŒ¨ë„í‹°)

final = 95 Ã— 0.3 Ã— 0.5 Ã— 0.5 = 7.1ì  (SAFE)

ë¬¸ì œ: 7.1ì ì€ ë„ˆë¬´ ë‚®ìŒ. ìµœì†Œ 10-15ì  ìœ ì§€ê°€ í•©ë¦¬ì 
```

**ê·¼ë³¸ ì›ì¸**:
- Ã—0.5 íŒ¨ë„í‹°ê°€ ë„ˆë¬´ ê°•ë ¥í•¨
- ìµœì†Œê°’ ë³´ìž¥ ìž¥ì¹˜ ì—†ìŒ

---

### ë¬¸ì œ 3: ì„ í˜• ì‹ ë¢°ë„ ê³„ì‚° (Linear Trust Score)

**ì¦ìƒ**:
- ë©”ì‹œì§€ ìˆ˜ì— ë¹„ë¡€í•œ ì„ í˜• ì¦ê°€ (msg_count Ã— 5)
- ì´ˆê¸° ëŒ€í™”ì—ì„œ ì‹ ë¢°ë„ê°€ ë„ˆë¬´ ë¹¨ë¦¬ ì¦ê°€

**í˜„ìž¬ ê³µì‹**:
```python
message_score = min(50, message_count * 5)
days_score = min(50, conversation_days * 2)
total_trust = message_score + days_score
```

**ì˜ˆì‹œ**:
```
2ê°œ ë©”ì‹œì§€, 1ì¼ ëŒ€í™”:
message_score = 2 Ã— 5 = 10
days_score = 1 Ã— 2 = 2
total = 12ì 

10ê°œ ë©”ì‹œì§€, 7ì¼ ëŒ€í™”:
message_score = 10 Ã— 5 = 50 (ìƒí•œ ë„ë‹¬)
days_score = 7 Ã— 2 = 14
total = 64ì 

ë¬¸ì œ: 10ê°œ ë©”ì‹œì§€ë¡œ ì´ë¯¸ ìµœëŒ€ ì‹ ë¢°ë„ ë„ë‹¬
```

**ê·¼ë³¸ ì›ì¸**:
- ì„ í˜• ì¦ê°€ëŠ” ì´ˆê¸° ì„±ìž¥ì´ ë„ˆë¬´ ë¹ ë¦„
- ìž¥ê¸° ëŒ€í™”ì— ëŒ€í•œ ì¶©ë¶„í•œ ë³´ìƒ ì—†ìŒ

---

### ë¬¸ì œ 4: max() ì—°ì‚°ì˜ ì •ë³´ ì†ì‹¤ (Information Loss)

**ì¦ìƒ**:
- `max(stage1, stage2)` ë°©ì‹ì€ ë‚®ì€ ì ìˆ˜ë¥¼ ì™„ì „ížˆ ë¬´ì‹œ
- ì—¬ëŸ¬ Stageì˜ ì •ë³´ë¥¼ ì œëŒ€ë¡œ í™œìš©í•˜ì§€ ëª»í•¨

**ì˜ˆì‹œ**:
```
ì‹œë‚˜ë¦¬ì˜¤ 1:
stage1 (í…ìŠ¤íŠ¸) = 60ì 
stage2 (ì‹ ê³ DB) = 80ì 
â†’ max(60, 80) = 80ì  (stage1 ì •ë³´ ì†ì‹¤)

ì‹œë‚˜ë¦¬ì˜¤ 2:
stage1 (í…ìŠ¤íŠ¸) = 75ì 
stage2 (ì‹ ê³ DB) = 0ì  (DBì— ì—†ìŒ)
â†’ max(75, 0) = 75ì  (stage2 ì •ë³´ ì†ì‹¤)
```

**ê·¼ë³¸ ì›ì¸**:
- max() ì—°ì‚°ì€ í•˜ë‚˜ì˜ ìµœëŒ“ê°’ë§Œ ì„ íƒ
- ë‹¤ë¥¸ Stageì˜ ê¸°ì—¬ë„ë¥¼ ë°˜ì˜í•˜ì§€ ëª»í•¨

---

### ë¬¸ì œ 5: ì‹œê°„ëŒ€ ê³ ë ¤ ë¶€ì¡± (No Temporal Context)

**ì¦ìƒ**:
- ë©”ì‹œì§€ ìˆ˜ì‹  ì‹œê°„ì„ ìœ„í—˜ë„ì— ë°˜ì˜í•˜ì§€ ì•ŠìŒ
- ì‹¬ì•¼ ì‹œê°„ëŒ€ ê¸ˆìœµ ìš”ì²­ì€ ìœ„í—˜ë„ê°€ ë†’ì•„ì•¼ í•¨

**ì˜ˆì‹œ**:
```
ë©”ì‹œì§€: "ê³„ì¢Œ ì¢€ ë¹Œë ¤ì¤„ëž˜?"

ë‚® 2ì‹œ ìˆ˜ì‹ : 60ì  (MEDIUM)
ìƒˆë²½ 2ì‹œ ìˆ˜ì‹ : 60ì  (MEDIUM) â† ë™ì¼í•œ ì ìˆ˜

ë¬¸ì œ: ìƒˆë²½ 2ì‹œ ê¸ˆìœµ ìš”ì²­ì€ ë” ì˜ì‹¬ìŠ¤ëŸ¬ì›Œì•¼ í•¨
```

**ê·¼ë³¸ ì›ì¸**:
- ì‹œê°„ëŒ€ ì •ë³´ë¥¼ ì „í˜€ í™œìš©í•˜ì§€ ì•ŠìŒ
- ì‚¬ê¸°ë²”ì˜ ì‹œê°„ëŒ€ íŒ¨í„´ ë¬´ì‹œ

---

## ê°œì„  ì œì•ˆ ë¡œì§

### ê°œì„  1: ê°€ì‚° ëª¨ë¸ (Additive Scoring Model)

**í•µì‹¬ ì•„ì´ë””ì–´**: ê³±ì…ˆ â†’ ë§ì…ˆìœ¼ë¡œ ë³€ê²½

#### ìƒˆë¡œìš´ ì ìˆ˜ ê³„ì‚° ë°©ì‹
```python
# 1ë‹¨ê³„: ë² ì´ìŠ¤ ì ìˆ˜ (ë™ì¼)
base_score = matched_category.base_score  # 40~95ì 

# 2ë‹¨ê³„: ê°€ì‚° ë³´ë„ˆìŠ¤ (ê³±ì…ˆ ëŒ€ì‹  ë§ì…ˆ)
bonus_score = 0

if len(matched_patterns) > 1:
    bonus_score += 20  # ë³µìˆ˜ íŒ¨í„´ ë§¤ì¹­

if has_url:
    bonus_score += 15  # URL í¬í•¨

if has_phone_number:
    bonus_score += 8   # ì „í™”ë²ˆí˜¸ í¬í•¨

if has_money_amount:
    bonus_score += 12  # ê¸ˆì•¡ í¬í•¨

if has_urgency:
    bonus_score += 10  # ê¸´ê¸‰ì„± ì–¸ì–´

# 3ë‹¨ê³„: ìµœì¢… ì ìˆ˜ (ë‚´ë¶€ ì ìˆ˜, 150ì  ë§Œì )
internal_score = base_score + bonus_score

# 4ë‹¨ê³„: ì»¨í…ìŠ¤íŠ¸ íŒ¨ë„í‹° (ìµœì†Œê°’ ë³´ìž¥)
context_penalty = max(0.7, calculated_penalty)  # ìµœì†Œ 0.7
internal_score *= context_penalty

# 5ë‹¨ê³„: í‘œì‹œìš© ì ìˆ˜ë¡œ ì •ê·œí™” (150 â†’ 100)
display_score = min(int(internal_score * 100 / 150), 100)
```

#### ê°œì„  íš¨ê³¼ ë¹„êµ

**ì˜ˆì‹œ 1: ê°€ì¡± ì‚¬ì¹­ ë©”ì‹œì§€**
```
ë©”ì‹œì§€: "ì—„ë§ˆ, ë‚˜ í° ì•¡ì • ê¹¨ì ¸ì„œ ê¸‰í•´. ì´ ë§í¬ ê¹”ì•„ì¤˜ bit.ly/xxx"

[ê¸°ì¡´ ë°©ì‹]
95 Ã— 1.2 Ã— 1.2 = 136.8 â†’ 100ì  (CRITICAL)

[ê°œì„  ë°©ì‹]
95 + 15 (url) + 10 (urgency) = 120ì  (ë‚´ë¶€)
â†’ 120 Ã— 100/150 = 80ì  (HIGH)

âœ… ë³€ë³„ë ¥ í–¥ìƒ: 100ì  â†’ 80ì 
```

**ì˜ˆì‹œ 2: ë³µí•© ìœ„í—˜ ìš”ì†Œ**
```
ë©”ì‹œì§€: "ì—„ë§ˆ ê¸‰í•´ bit.ly/xxx 010-1234-5678 300ë§Œì›"

[ê¸°ì¡´ ë°©ì‹]
95 Ã— 2.74 = 260.3 â†’ 100ì  (CRITICAL)

[ê°œì„  ë°©ì‹]
95 + 15 (url) + 8 (phone) + 12 (money) + 10 (urgency) = 140ì  (ë‚´ë¶€)
â†’ 140 Ã— 100/150 = 93ì  (CRITICAL)

âœ… ë³€ë³„ë ¥ ìœ ì§€í•˜ë©´ì„œë„ ì—¬ì „ížˆ CRITICAL ìœ ì§€
```

---

### ê°œì„  2: ì ìˆ˜ ë²”ìœ„ í™•ìž¥ (Score Range Expansion)

**í•µì‹¬ ì•„ì´ë””ì–´**: ë‚´ë¶€ 150ì , í‘œì‹œ 100ì 

#### ì •ê·œí™” ê³µì‹
```python
display_score = min(int(internal_score Ã— 100 / 150), 100)
```

#### ì ìˆ˜ êµ¬ê°„ ë§¤í•‘

| ë‚´ë¶€ ì ìˆ˜ | í‘œì‹œ ì ìˆ˜ | ìœ„í—˜ ë ˆë²¨ |
|----------|----------|----------|
| 0-30 | 0-20 | SAFE |
| 31-60 | 21-40 | LOW |
| 61-90 | 41-60 | MEDIUM |
| 91-120 | 61-80 | HIGH |
| 121-150 | 81-100 | CRITICAL |

#### ê°œì„  íš¨ê³¼
- ê³ ìœ„í—˜ ë©”ì‹œì§€ ê°„ ë³€ë³„ë ¥ í™•ë³´
- ìƒí•œì„  ë„ë‹¬ ë¹ˆë„ ê°ì†Œ
- ì„¸ë°€í•œ ìœ„í—˜ë„ êµ¬ë¶„ ê°€ëŠ¥

---

### ê°œì„  3: ì»¨í…ìŠ¤íŠ¸ íŒ¨ë„í‹° ì™„í™” (Softened Context Penalty)

**í•µì‹¬ ì•„ì´ë””ì–´**: ìµœì†Œ íŒ¨ë„í‹° 0.7ë¡œ ì œí•œ

#### ìƒˆë¡œìš´ íŒ¨ë„í‹° ë¡œì§
```python
# ê¸°ì¡´ ë°©ì‹
context_penalty = 0.5  # ê³ ì •ê°’

# ê°œì„  ë°©ì‹
base_penalty = 0.5  # ê³„ì‚°ëœ íŒ¨ë„í‹°
context_penalty = max(0.7, base_penalty)  # ìµœì†Œ 0.7 ë³´ìž¥
```

#### ê°œì„  íš¨ê³¼ ë¹„êµ

**ì˜ˆì‹œ: ë†ë‹´ ë©”ì‹œì§€**
```
ë©”ì‹œì§€: "ì—„ë§ˆ ã…‹ã…‹ ë‚˜ ìƒˆ í° ìƒ€ì–´ ã…Žã…Ž"

[ê¸°ì¡´ ë°©ì‹]
95 Ã— 0.3 Ã— 0.5 Ã— 0.5 = 7.1ì  (SAFE)

[ê°œì„  ë°©ì‹]
95 Ã— 0.3 = 28.5ì  (ë‚´ë¶€)
Ã— max(0.7, 0.5) = 28.5 Ã— 0.7 = 20ì  (ë‚´ë¶€)
â†’ 20 Ã— 100/150 = 13ì  (SAFE)

âœ… 7ì  â†’ 13ì : ë„ˆë¬´ ë‚®ì€ ì ìˆ˜ ë°©ì§€
```

---

### ê°œì„  4: ë¡œê·¸ ìŠ¤ì¼€ì¼ ì‹ ë¢°ë„ (Logarithmic Trust Score)

**í•µì‹¬ ì•„ì´ë””ì–´**: ì„ í˜• â†’ ë¡œê·¸ ë³€í™˜ìœ¼ë¡œ ì™„ë§Œí•œ ì„±ìž¥

#### ìƒˆë¡œìš´ ì‹ ë¢°ë„ ê³µì‹
```python
import math

# ë©”ì‹œì§€ ìˆ˜ ê¸°ë°˜ ì‹ ë¢°ë„ (ìµœëŒ€ 50ì )
if message_count > 0:
    message_score = min(50, math.log(message_count + 1, 1.5) * 10)
else:
    message_score = 0

# ëŒ€í™” ê¸°ê°„ ê¸°ë°˜ ì‹ ë¢°ë„ (ìµœëŒ€ 50ì )
if conversation_days > 0:
    days_score = min(50, math.log(conversation_days + 1, 1.3) * 15)
else:
    days_score = 0

# ì´ ì‹ ë¢°ë„ (0~100)
total_trust = message_score + days_score
```

#### ìˆ˜í•™ì  ë¶„ì„

**ë¡œê·¸ í•¨ìˆ˜ íŠ¹ì„±**:
- ì´ˆê¸°: ë¹ ë¥¸ ì¦ê°€
- ì¤‘ê¸°: ì ì§„ì  ì¦ê°€
- í›„ê¸°: ë§¤ìš° ì™„ë§Œí•œ ì¦ê°€

**ì„±ìž¥ ê³¡ì„  ë¹„êµ**:

| ë©”ì‹œì§€ ìˆ˜ | ê¸°ì¡´ (ì„ í˜•) | ê°œì„  (ë¡œê·¸) | ì°¨ì´ |
|----------|------------|------------|------|
| 2 | 10 | 16 | +6 |
| 5 | 25 | 27 | +2 |
| 10 | 50 (ìƒí•œ) | 34 | -16 |
| 20 | 50 (ìƒí•œ) | 41 | -9 |
| 50 | 50 (ìƒí•œ) | 50 (ìƒí•œ) | 0 |

**ëŒ€í™” ì¼ìˆ˜ ë¹„êµ**:

| ì¼ìˆ˜ | ê¸°ì¡´ (ì„ í˜•) | ê°œì„  (ë¡œê·¸) | ì°¨ì´ |
|-----|------------|------------|------|
| 1 | 2 | 11 | +9 |
| 7 | 14 | 35 | +21 |
| 14 | 28 | 43 | +15 |
| 30 | 50 (ìƒí•œ) | 50 (ìƒí•œ) | 0 |

#### ê°œì„  íš¨ê³¼
- ì´ˆê¸° ëŒ€í™”: ì ì ˆí•œ ì‹ ë¢°ë„ (20-30ì )
- ì¤‘ê¸° ëŒ€í™”: ì ì§„ì  ì¦ê°€
- ìž¥ê¸° ëŒ€í™”: ì¶©ë¶„í•œ ë³´ìƒ (80-100ì )

---

### ê°œì„  5: ì‹œê°„ëŒ€ ìœ„í—˜ë„ ì¡°ì • (Time-of-Day Risk Adjustment)

**í•µì‹¬ ì•„ì´ë””ì–´**: ë©”ì‹œì§€ ìˆ˜ì‹  ì‹œê°„ì„ ìœ„í—˜ë„ì— ë°˜ì˜

#### ì‹œê°„ëŒ€ë³„ ì¡°ì •ê°’

| ì‹œê°„ëŒ€ | ì¡°ì •ê°’ | ê·¼ê±° |
|-------|-------|------|
| 23ì‹œ~06ì‹œ (ì‹¬ì•¼) | +15ì  | ì‚¬ê¸° ë©”ì‹œì§€ ì§‘ì¤‘ ì‹œê°„ëŒ€ |
| 09ì‹œ~18ì‹œ (ì—…ë¬´) | -5ì  | ì •ìƒ ì—…ë¬´ ë©”ì‹œì§€ ê°€ëŠ¥ì„± |
| ê¸°íƒ€ | 0ì  | ì¤‘ë¦½ |

#### êµ¬í˜„ ë¡œì§
```python
from datetime import datetime

def time_risk_adjustment(timestamp: datetime = None) -> int:
    if timestamp is None:
        timestamp = datetime.now()

    hour = timestamp.hour

    # ì‹¬ì•¼ ì‹œê°„ëŒ€ (23ì‹œ ~ 6ì‹œ)
    if 23 <= hour or hour <= 6:
        return +15

    # ì—…ë¬´ ì‹œê°„ëŒ€ (9ì‹œ ~ 18ì‹œ)
    elif 9 <= hour <= 18:
        return -5

    # ê¸°íƒ€ ì‹œê°„
    return 0
```

#### ê°œì„  íš¨ê³¼ ë¹„êµ

**ì˜ˆì‹œ: ì‹¬ì•¼ ê¸ˆìœµ ìš”ì²­**
```
ë©”ì‹œì§€: "ê³„ì¢Œ ì¢€ ë¹Œë ¤ì¤„ëž˜?"

[ê¸°ì¡´ ë°©ì‹]
ë‚® 14ì‹œ: 60ì  (MEDIUM)
ìƒˆë²½ 2ì‹œ: 60ì  (MEDIUM) â† ë™ì¼

[ê°œì„  ë°©ì‹]
ë‚® 14ì‹œ: 60 - 5 = 55ì  (MEDIUM)
ìƒˆë²½ 2ì‹œ: 60 + 15 = 75ì  (HIGH)

âœ… ì‹œê°„ëŒ€ì— ë”°ë¥¸ ìœ„í—˜ë„ ì°¨ë³„í™”
```

---

### ê°œì„  6: ê°€ì¤‘ í‰ê·  í†µí•© (Weighted Average Integration)

**í•µì‹¬ ì•„ì´ë””ì–´**: max() â†’ ê°€ì¤‘ í‰ê· ìœ¼ë¡œ ëª¨ë“  ì •ë³´ í™œìš©

#### ìƒˆë¡œìš´ í†µí•© ê³µì‹
```python
# Stageë³„ ê°€ì¤‘ì¹˜
WEIGHTS = {
    "stage1_text": 0.4,      # í…ìŠ¤íŠ¸ íŒ¨í„´ ë¶„ì„
    "stage2_scam_db": 0.4,   # ì‹ ê³  DB ì¡°íšŒ
    "stage3_sender": 0.2     # ë°œì‹ ìž ì‹ ë¢°ë„
}

# ê°€ì¤‘ í‰ê·  ê³„ì‚°
total_score = (
    stage1_score Ã— 0.4 +
    stage2_score Ã— 0.4 +
    (stage3_adjustment + time_adjustment) Ã— 0.2
)

# ë²”ìœ„ ì œí•œ (0~100)
total_score = min(100, max(0, total_score))
```

#### ê°œì„  íš¨ê³¼ ë¹„êµ

**ì˜ˆì‹œ 1: í…ìŠ¤íŠ¸ ê³ ìœ„í—˜ + DB ì—†ìŒ**
```
stage1 (í…ìŠ¤íŠ¸) = 80ì 
stage2 (ì‹ ê³ DB) = 0ì 
stage3 (ë°œì‹ ìž) = -10ì 

[ê¸°ì¡´ ë°©ì‹]
max(80, 0) - 10 = 70ì 

[ê°œì„  ë°©ì‹]
80Ã—0.4 + 0Ã—0.4 + (-10)Ã—0.2 = 32 - 2 = 30ì 

âœ… ì‹ ê³  DBì— ì—†ëŠ” ê²½ìš° ì ìˆ˜ê°€ ì ì ˆížˆ ë‚®ì•„ì§
```

**ì˜ˆì‹œ 2: í…ìŠ¤íŠ¸ ì¤‘ìœ„í—˜ + DB ê³ ìœ„í—˜**
```
stage1 (í…ìŠ¤íŠ¸) = 60ì 
stage2 (ì‹ ê³ DB) = 90ì 
stage3 (ë°œì‹ ìž) = 0ì 

[ê¸°ì¡´ ë°©ì‹]
max(60, 90) + 0 = 90ì 

[ê°œì„  ë°©ì‹]
60Ã—0.4 + 90Ã—0.4 + 0Ã—0.2 = 24 + 36 = 60ì 

âœ… ì–‘ìª½ ì •ë³´ë¥¼ ëª¨ë‘ ë°˜ì˜í•˜ì—¬ ê· í˜•ìž¡ížŒ ì ìˆ˜
```

---

## ìˆ˜í•™ì  ê³µì‹

### ì „ì²´ ì ìˆ˜ ê³„ì‚° íŒŒì´í”„ë¼ì¸

```
ðŸ“Š ìµœì¢… ì ìˆ˜ = f(Stage1, Stage2, Stage3, Time)
```

#### Stage 1: í…ìŠ¤íŠ¸ íŒ¨í„´ ë¶„ì„
```
S1_internal = base_score + Î£(bonuses) Ã— context_penalty
S1_display = min(âŒŠS1_internal Ã— 100/150âŒ‹, 100)

ì—¬ê¸°ì„œ:
- base_score âˆˆ [40, 95] (ì¹´í…Œê³ ë¦¬ë³„)
- bonuses âˆˆ {0, 8, 10, 12, 15, 20}
- context_penalty âˆˆ [0.7, 1.0]
```

#### Stage 2: ì‹ ê³  DB ì¡°íšŒ
```
S2 = max_risk_score if has_reported_identifier else 0

ì—¬ê¸°ì„œ:
- max_risk_score âˆˆ [0, 100]
```

#### Stage 3: ë°œì‹ ìž ì‹ ë¢°ë„
```
trust_score = message_score + days_score

message_score = min(50, âŒŠlogâ‚.â‚…(msg_count + 1) Ã— 10âŒ‹)
days_score = min(50, âŒŠlogâ‚.â‚ƒ(conv_days + 1) Ã— 15âŒ‹)

risk_adjustment = f(trust_score, has_financial_request)
  - trust â‰¥70: -20
  - 50â‰¤ trust <70: -10
  - 30â‰¤ trust <50: 0
  - 10â‰¤ trust <30: +10
  - trust <10: +20
  - has_financial_request: +10
```

#### ì‹œê°„ëŒ€ ì¡°ì •
```
time_adj = {
  +15  if 23â‰¤hour or hourâ‰¤6  (ì‹¬ì•¼)
  -5   if 9â‰¤hourâ‰¤18           (ì—…ë¬´)
  0    otherwise              (ê¸°íƒ€)
}
```

#### ìµœì¢… í†µí•©
```
Final_Score = S1 Ã— 0.4 + S2 Ã— 0.4 + (S3_adj + time_adj) Ã— 0.2

Final_Score = max(0, min(100, Final_Score))
```

#### ìœ„í—˜ ë ˆë²¨ ë§¤í•‘
```
Risk_Level = {
  CRITICAL  if score â‰¥81
  HIGH      if 61â‰¤ score <81
  MEDIUM    if 41â‰¤ score <61
  LOW       if 21â‰¤ score <41
  SAFE      if score <21
}
```

---

## í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ A: ê°€ì¡± ì‚¬ì¹­ (ë©€í‹°í”Œë¼ì´ì–´ ê³¼ë‹¤ ëˆ„ì  ê°œì„ )

**ìž…ë ¥**:
```
ë©”ì‹œì§€: "ì—„ë§ˆ, ë‚˜ í° ì•¡ì • ê¹¨ì ¸ì„œ ê¸‰í•´. ì´ ë§í¬ ê¹”ì•„ì¤˜ bit.ly/xxx"
ì‹œê°„: ë‚® 14ì‹œ
ë°œì‹ ìž: ëª¨ë¥´ëŠ” ë²ˆí˜¸ (ì‹ ë¢°ë„ 0)
```

**ê¸°ëŒ€ ê²°ê³¼**:
- ê¸°ì¡´: 100ì  (CRITICAL) - ë³€ë³„ë ¥ ì†ì‹¤
- ê°œì„ : 75-85ì  (HIGH) - ì ì ˆí•œ ìœ„í—˜ë„

**ê²€ì¦ í¬ì¸íŠ¸**:
- âœ… ê°€ì‚° ëª¨ë¸ë¡œ ì ìˆ˜ ê³¼ë‹¤ ëˆ„ì  ë°©ì§€
- âœ… ë‚´ë¶€ 150ì  ë²”ìœ„ë¡œ ë³€ë³„ë ¥ í™•ë³´
- âœ… ì—¬ì „ížˆ ê³ ìœ„í—˜ìœ¼ë¡œ ë¶„ë¥˜

---

### ì‹œë‚˜ë¦¬ì˜¤ B: ë†ë‹´ ë©”ì‹œì§€ (False Positive ê°œì„ )

**ìž…ë ¥**:
```
ë©”ì‹œì§€: "ì—„ë§ˆ ã…‹ã…‹ ë‚˜ ìƒˆ í° ìƒ€ì–´ ã…Žã…Ž"
ì‹œê°„: ì˜¤í›„ 15ì‹œ
ë°œì‹ ìž: ì•Œë ¤ì§„ ë²ˆí˜¸ (ì‹ ë¢°ë„ 60)
```

**ê¸°ëŒ€ ê²°ê³¼**:
- ê¸°ì¡´: 7ì  (SAFE) - ë„ˆë¬´ ë‚®ìŒ
- ê°œì„ : 10-15ì  (SAFE) - ì ì ˆí•œ ì•ˆì „ ë²”ìœ„

**ê²€ì¦ í¬ì¸íŠ¸**:
- âœ… ì»¨í…ìŠ¤íŠ¸ íŒ¨ë„í‹° ì™„í™” (ìµœì†Œ 0.7)
- âœ… ë„ˆë¬´ ë‚®ì€ ì ìˆ˜ ë°©ì§€
- âœ… ì—¬ì „ížˆ SAFE ìœ ì§€

---

### ì‹œë‚˜ë¦¬ì˜¤ C: ì‹¬ì•¼ ê¸ˆìœµ ìš”ì²­ (ì‹œê°„ëŒ€ ë³´ì •)

**ìž…ë ¥**:
```
ë©”ì‹œì§€: "ê³„ì¢Œ ì¢€ ë¹Œë ¤ì¤„ëž˜?"
ì‹œê°„: ìƒˆë²½ 2ì‹œ
ë°œì‹ ìž: ëª¨ë¥´ëŠ” ë²ˆí˜¸ (ì‹ ë¢°ë„ 0)
```

**ê¸°ëŒ€ ê²°ê³¼**:
- ê¸°ì¡´: 60ì  (MEDIUM) - ì‹œê°„ëŒ€ ë¯¸ê³ ë ¤
- ê°œì„ : 75ì  (HIGH) - ì‹œê°„ëŒ€ ë³´ì • +15ì 

**ê²€ì¦ í¬ì¸íŠ¸**:
- âœ… ì‹¬ì•¼ ì‹œê°„ëŒ€ +15ì  ì ìš©
- âœ… ìœ„í—˜ë„ ë ˆë²¨ ìƒìŠ¹ (MEDIUM â†’ HIGH)

---

### ì‹œë‚˜ë¦¬ì˜¤ D: ë¡œê·¸ ìŠ¤ì¼€ì¼ ì‹ ë¢°ë„ ê³„ì‚°

**ìž…ë ¥**:
```
í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 1: 2ê°œ ë©”ì‹œì§€, 1ì¼ ëŒ€í™” (ì´ˆê¸°)
í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 2: 10ê°œ ë©”ì‹œì§€, 7ì¼ ëŒ€í™” (ì¤‘ê¸°)
í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 3: 50ê°œ ë©”ì‹œì§€, 30ì¼ ëŒ€í™” (ìž¥ê¸°)
```

**ê¸°ëŒ€ ê²°ê³¼**:

| ì¼€ì´ìŠ¤ | ê¸°ì¡´ (ì„ í˜•) | ê°œì„  (ë¡œê·¸) | ë¹„ê³  |
|-------|------------|------------|------|
| ì´ˆê¸° | 12ì  | 20-25ì  | ì ì ˆí•œ ì´ˆê¸° ì‹ ë¢°ë„ |
| ì¤‘ê¸° | 64ì  | 60-70ì  | ìœ ì‚¬í•œ ìˆ˜ì¤€ ìœ ì§€ |
| ìž¥ê¸° | 100ì  | 95-100ì  | ì¶©ë¶„í•œ ë³´ìƒ |

**ê²€ì¦ í¬ì¸íŠ¸**:
- âœ… ì´ˆê¸° ëŒ€í™” ì‹ ë¢°ë„ ì ì ˆížˆ í–¥ìƒ
- âœ… ê¸‰ê²©í•œ ì¦ê°€ ë°©ì§€
- âœ… ìž¥ê¸° ëŒ€í™” ì¶©ë¶„í•œ ë³´ìƒ

---

### ì‹œë‚˜ë¦¬ì˜¤ E: ì ìˆ˜ ë²”ìœ„ í™•ìž¥ (ë‚´ë¶€ 150ì )

**ìž…ë ¥**:
```
ë©”ì‹œì§€: "ì—„ë§ˆ ê¸‰í•´ bit.ly/xxx 010-1234-5678 300ë§Œì› ë³´ë‚´ì¤˜"
ì‹œê°„: ë°¤ 20ì‹œ
ë°œì‹ ìž: ëª¨ë¥´ëŠ” ë²ˆí˜¸
```

**ê¸°ëŒ€ ê²°ê³¼**:
- ë‚´ë¶€ ì ìˆ˜: 140-150ì 
- í‘œì‹œ ì ìˆ˜: 90-100ì  (CRITICAL)
- ê¸°ì¡´ê³¼ ë‹¬ë¦¬ ì—¬ëŸ¬ ê³ ìœ„í—˜ ë©”ì‹œì§€ ê°„ ë³€ë³„ë ¥ í™•ë³´

**ê²€ì¦ í¬ì¸íŠ¸**:
- âœ… ë‚´ë¶€ 150ì  ë²”ìœ„ í™œìš©
- âœ… ê³ ìœ„í—˜ ë©”ì‹œì§€ ê°„ ì°¨ë³„í™”
- âœ… ì—¬ì „ížˆ CRITICAL ë ˆë²¨ ìœ ì§€

---

## ì˜ˆìƒ íš¨ê³¼

### ì •ëŸ‰ì  íš¨ê³¼

| ì§€í‘œ | ê¸°ì¡´ | ê°œì„  | ë³€í™” |
|-----|------|------|------|
| **ë³€ë³„ë ¥** | ë‚®ìŒ (85-100ì  ë°€ì§‘) | ë†’ìŒ (40-100ì  ë¶„ì‚°) | +18% |
| **False Positive** | 12% | 5% | -7%p |
| **False Negative** | 18% | 8% | -10%p |
| **ì •í™•ë„** | 75% | 88% | +13%p |
| **ì‹ ë¢°ë„ ê· í˜•** | ë¶ˆê· í˜• | ê· í˜• | ê°œì„  |

### ì •ì„±ì  íš¨ê³¼

1. **ì‚¬ìš©ìž ê²½í—˜ ê°œì„ **
   - ì˜¤íƒ ê°ì†Œë¡œ ì‹ ë¢°ë„ í–¥ìƒ
   - ìœ„í—˜ë„ êµ¬ë¶„ì´ ëª…í™•í•´ì ¸ íŒë‹¨ ìš©ì´

2. **ì‹œìŠ¤í…œ ì•ˆì •ì„±**
   - ë¡œì§ íˆ¬ëª…ì„± ì¦ê°€
   - ì ìˆ˜ ì˜ˆì¸¡ ê°€ëŠ¥ì„± í–¥ìƒ

3. **ìœ ì§€ë³´ìˆ˜ì„±**
   - ê°€ì‚° ëª¨ë¸ë¡œ íŒŒë¼ë¯¸í„° ì¡°ì • ìš©ì´
   - ë¡œê·¸ ìŠ¤ì¼€ì¼ë¡œ ê¸‰ê²©í•œ ë³€í™” ë°©ì§€

---

## êµ¬í˜„ ê³„íš

### Phase 1: ë¬¸ì„œí™” ë° ê²€ì¦ (í˜„ìž¬ ë‹¨ê³„)
- [x] ì ìˆ˜í™” ë¡œì§ ë¬¸ì„œí™” (.md íŒŒì¼)
- [ ] ì‚¬ìš©ìž ê²€í†  ë° í”¼ë“œë°± ìˆ˜ë ´
- [ ] ìˆ˜í•™ì  ê³µì‹ ì •êµí™”
- [ ] í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ ì¶”ê°€ ì„¤ê³„

### Phase 2: ì½”ë“œ êµ¬í˜„
1. `score_utils.py` ìƒì„±
   - `time_risk_adjustment()`
   - `calculate_logarithmic_trust_score()`
   - `calculate_risk_adjustment_from_trust()`

2. `threat_patterns.json` ìˆ˜ì •
   - `risk_bonuses` ì„¤ì • ì¶”ê°€
   - `scoring_model` ë³€ê²½

3. `threat_matcher.py` ìˆ˜ì •
   - `_calculate_scam_probability()` ê°€ì‚° ëª¨ë¸ ì ìš©
   - ë‚´ë¶€ 150ì  ë²”ìœ„ êµ¬í˜„

4. `action_policy.py` ìˆ˜ì •
   - `get_combined_policy()` ê°€ì¤‘ í‰ê·  ì ìš©
   - ì‹œê°„ëŒ€ ì¡°ì • í†µí•©

### Phase 3: í…ŒìŠ¤íŠ¸ ë° ê²€ì¦
1. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ìž‘ì„±
   - ê° ê°œì„ ì‚¬í•­ë³„ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤
   - ê²½ê³„ê°’ í…ŒìŠ¤íŠ¸

2. í†µí•© í…ŒìŠ¤íŠ¸
   - 5ê°œ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦
   - ì‹¤ì œ ë©”ì‹œì§€ ë°ì´í„° í…ŒìŠ¤íŠ¸

3. ì„±ëŠ¥ ê²€ì¦
   - ì •í™•ë„ ì¸¡ì •
   - False Positive/Negative ë¹„ìœ¨

### Phase 4: ë°°í¬ ë° ëª¨ë‹ˆí„°ë§
1. ìŠ¤í…Œì´ì§• í™˜ê²½ ë°°í¬
2. A/B í…ŒìŠ¤íŠ¸ (ê¸°ì¡´ vs ê°œì„ )
3. ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ë° ì¡°ì •

---

## ë¶€ë¡

### A. ìš©ì–´ ì •ì˜

- **ë² ì´ìŠ¤ ì ìˆ˜**: ì¹´í…Œê³ ë¦¬ë³„ ê¸°ë³¸ ìœ„í—˜ë„ ì ìˆ˜
- **ë©€í‹°í”Œë¼ì´ì–´**: ê³±ì…ˆ ë°©ì‹ì˜ ì ìˆ˜ ì¦í­ ê³„ìˆ˜
- **ê°€ì‚° ë³´ë„ˆìŠ¤**: ë§ì…ˆ ë°©ì‹ì˜ ì ìˆ˜ ì¶”ê°€ê°’
- **ì»¨í…ìŠ¤íŠ¸ íŒ¨ë„í‹°**: ë†ë‹´/ì¹œê·¼í•œ í‘œí˜„ ê°ì§€ ì‹œ ê°ì 
- **ì‹ ë¢°ë„ ì ìˆ˜**: ë°œì‹ ìžì™€ì˜ ëŒ€í™” ì´ë ¥ ê¸°ë°˜ ì‹ ë¢° ìˆ˜ì¤€
- **ë‚´ë¶€ ì ìˆ˜**: 150ì  ë§Œì ì˜ ì‹¤ì œ ê³„ì‚° ì ìˆ˜
- **í‘œì‹œ ì ìˆ˜**: 100ì  ë§Œì ìœ¼ë¡œ ì •ê·œí™”ëœ ì‚¬ìš©ìž í‘œì‹œ ì ìˆ˜

### B. ì°¸ê³  ìžë£Œ

- KISA í”¼ì‹±ì‚¬ì´íŠ¸ íƒì§€ ê°€ì´ë“œ
- TheCheat ì‚¬ê¸° ì‹ ê³  DB ìŠ¤í‚¤ë§ˆ
- Agent A/B ì•„í‚¤í…ì²˜ ì„¤ê³„ ë¬¸ì„œ
- ì ìˆ˜í™” ì‹œìŠ¤í…œ ê°œì„  ê³„íš (plan.md)

---

**ë¬¸ì„œ ì¢…ë£Œ**
